(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("Goals"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome","Goals",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["MultiChannelConversionAttribution"]=t(require("CoreHome"),require("Goals"),require("vue"),require("CorePluginsAdmin")):e["MultiChannelConversionAttribution"]=t(e["CoreHome"],e["Goals"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n,o){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/MultiChannelConversionAttribution/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"76d2":function(e,n){e.exports=t},"8bbf":function(e,t){e.exports=n},a5a2:function(e,t){e.exports=o},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"ManageMultiattribution",(function(){return b})),n.d(t,"ReportAttribution",(function(){return x})),"undefined"!==typeof window){var o=window.document.currentScript,i=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(n.p=i[1])}var a=n("8bbf"),l={class:"manageMultiAttribution"},r={name:"isEnabled"};function d(e,t,n,o,i,d){var s=Object(a["resolveComponent"])("Field");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",l,[Object(a["createElementVNode"])("div",r,[Object(a["createVNode"])(s,{uicontrol:"checkbox",name:"isEnabled",title:e.translate("MultiChannelConversionAttribution_Enabled"),modelValue:e.isEnabled,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.isEnabled=t}),introduction:e.translate("MultiChannelConversionAttribution_MultiChannelConversionAttribution"),"inline-help":e.translate("MultiChannelConversionAttribution_Introduction")},null,8,["title","modelValue","introduction","inline-help"])])])}var s=n("19dc"),u=n("76d2"),c=n("a5a2"),m=Object(a["defineComponent"])({props:{},components:{Field:c["Field"]},data:function(){return{isLoading:!1,isEnabled:null}},created:function(){var e=this,t=u["ManageGoalsStore"].idGoal.value;"number"===typeof t&&this.initGoalForm("Goals.updateGoal",t),this.isLoading=!1,this.reset(),s["Matomo"].on("Goals.cancelForm",(function(){return e.resetForm()})),s["Matomo"].on("Goals.beforeInitGoalForm",this.initGoalForm.bind(this)),s["Matomo"].on("Goals.beforeAddGoal",this.onSetAttribution.bind(this)),s["Matomo"].on("Goals.beforeUpdateGoal",this.onSetAttribution.bind(this))},methods:{reset:function(){this.isEnabled=!0},resetForm:function(){this.reset(),this.isLoading=!1},getGoalAttribution:s["AjaxHelper"].oneAtATime("MultiChannelConversionAttribution.getGoalAttribution"),initGoalForm:function(e,t){var n=this;this.resetForm(),t&&"Goals.addGoal"!==e&&(this.isLoading=!0,this.getGoalAttribution({idGoal:t}).then((function(e){n.isEnabled=!!e.isEnabled&&"0"!==e.isEnabled})).finally((function(){n.isLoading=!1})))},onSetAttribution:function(e){var t=e.options;null!==this.isEnabled&&(t.postParams=Object.assign(Object.assign({},t.postParams),{},{multiAttributionEnabled:this.isEnabled?1:0}))}}});m.render=d;var b=m,p={class:"MultiChannelConversionAttributionWidget"},h={key:0},f={key:1,class:"alert alert-info"},C={key:2,class:"row goalAndDaysPrior"},g={class:"col s12 m3"},v={name:"idgoal"},j={class:"col s12 m6"},O={name:"campaignDimensionCombination"},M={key:3,class:"row modelSelection"},y={class:"col s12 m3"},A={name:"model1"},E={class:"col s12 m3"},G={name:"model2"},V={class:"col s12 m3"},N={name:"model3"},D={class:"attributionReport",ref:"attributionReport"};function k(e,t,n,o,i,l){var r=Object(a["resolveComponent"])("EnrichedHeadline"),d=Object(a["resolveComponent"])("Field");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",p,[Object(a["createElementVNode"])("div",null,[e.isWidgetized?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("h2",h,[Object(a["createVNode"])(r,{"inline-help":e.reportHelp},{default:Object(a["withCtx"])((function(){return[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("MultiChannelConversionAttribution_MultiChannelConversionAttribution")),1)]})),_:1},8,["inline-help"])])),0===e.goals.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",f,Object(a["toDisplayString"])(e.translate(e.noGoalEnabledMessageKey)),1)):Object(a["createCommentVNode"])("",!0),e.goals.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",C,[Object(a["createElementVNode"])("div",g,[Object(a["createElementVNode"])("div",v,[Object(a["createVNode"])(d,{uicontrol:"select",name:"idgoal",disabled:e.goals.length<=1,"model-value":e.idGoal,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.idGoal=t,e.onReportChange()}),"full-width":!0,title:e.translate("General_Goal"),options:e.goals},null,8,["disabled","model-value","title","options"])])]),Object(a["createElementVNode"])("div",j,[Object(a["createElementVNode"])("div",O,[Object(a["createVNode"])(d,{uicontrol:"select",name:"campaignDimensionCombination","model-value":e.campaignDimensionCombination,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.campaignDimensionCombination=t,e.onReportChange()}),"full-width":!0,title:e.translate("MultiChannelConversionAttribution_CampaignDimensionCombinationTitleNew")+e.$sanitize(e.getEditURL),options:e.campaignDimensionCombinationOptions},null,8,["model-value","title","options"])])])])):Object(a["createCommentVNode"])("",!0),e.goals.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",M,[Object(a["createElementVNode"])("div",y,[Object(a["createElementVNode"])("div",A,[Object(a["createVNode"])(d,{uicontrol:"select",name:"model1","model-value":e.model1,"onUpdate:modelValue":t[2]||(t[2]=function(t){e.model1=t,e.onReportChange(),e.modelChanged()}),"full-width":!0,title:e.translate("MultiChannelConversionAttribution_AttributionModelX",1),options:e.attributionModels},null,8,["model-value","title","options"])])]),Object(a["createElementVNode"])("div",E,[Object(a["createElementVNode"])("div",G,[Object(a["createVNode"])(d,{uicontrol:"select",name:"model2","model-value":e.model2,"onUpdate:modelValue":t[3]||(t[3]=function(t){e.model2=t,e.onReportChange(),e.modelChanged()}),"full-width":!0,title:e.translate("MultiChannelConversionAttribution_AttributionModelX",2),options:e.attributionModelsCancelable},null,8,["model-value","title","options"])])]),Object(a["createElementVNode"])("div",V,[Object(a["createElementVNode"])("div",N,[Object(a["createVNode"])(d,{uicontrol:"select",name:"model3","model-value":e.model3,"onUpdate:modelValue":t[4]||(t[4]=function(t){e.model3=t,e.onReportChange(),e.modelChanged()}),"full-width":!0,title:e.translate("MultiChannelConversionAttribution_AttributionModelX",3),options:e.attributionModelsCancelable},null,8,["model-value","title","options"])])])])):Object(a["createCommentVNode"])("",!0)]),Object(a["createElementVNode"])("div",D,null,512)])}var w=window,S=w.$,q=Object(a["defineComponent"])({props:{isWidgetized:Boolean,settingsUrl:String,reportHtml:{type:String,required:!0},reportHelp:{type:String,required:!0},noGoalEnabledMessageKey:{type:String,required:!0},goals:{type:Array,required:!0},campaignDimensionCombinationOptions:{type:Array,required:!0},attributionModels:{type:Array,required:!0},attributionModelsCancelable:{type:Array,required:!0},firstGoal:[String,Number],defaultCampaignDimensionCombination:{type:String,required:!0},selectedModels:{type:Array,required:!0}},components:{EnrichedHeadline:s["EnrichedHeadline"],Field:c["Field"]},data:function(){return{idGoal:this.firstGoal,campaignDimensionCombination:this.defaultCampaignDimensionCombination,model1:this.selectedModels[0],model2:this.selectedModels[1],model3:this.selectedModels[2]}},mounted:function(){S(this.$refs.attributionReport).html(this.reportHtml);var e=S(this.$refs.attributionReport).find(".dataTable:first");if(e.length){var t=e.data("report");window.require("piwik/UI/DataTable").initNewDataTables(t);var n=e.data("uiControlObject");n.dataTableLoaded(this.reportHtml,n.workingDivId),this.modelChanged(),this.updateHash()}},methods:{onReportChange:function(){var e=S(this.$refs.attributionReport).find(".dataTable:first").data("uiControlObject");null!==e&&void 0!==e&&e.param&&(this.updateHash(),e.param.idGoal=this.idGoal,e.param.idCampaignDimensionCombination=this.campaignDimensionCombination,e.param.attributionModels="".concat(this.model1,",").concat(this.model2,",").concat(this.model3),e.reloadAjaxDataTable())},modelChanged:function(){var e=document.getElementById("inconsistentDataAlert");e&&("lastNonDirect"===this.model1||"lastNonDirect"===this.model2||"lastNonDirect"===this.model3?e.classList.remove("hide"):e.classList.add("hide"))},updateHash:function(){var e=Object.assign({},s["MatomoUrl"].hashParsed.value);delete e.idGoal,delete e.idCampaignDimensionCombination,delete e.attributionModel1,delete e.attributionModel2,delete e.attributionModel3,e.idGoal=this.idGoal,e.idCampaignDimensionCombination=this.campaignDimensionCombination,e.attributionModel1=this.model1,e.attributionModel2=this.model2,e.attributionModel3=this.model3,s["MatomoUrl"].updateHash(e)}},computed:{getEditURL:function(){return this.settingsUrl?Object(s["translate"])("MultiChannelConversionAttribution_CampaignCombinationEdit",'<a href="'.concat(this.settingsUrl,'" rel="noreferrer noopener" target="_blank" id="multi-channel-conversion-attribution-settings-edit-link">'),"</a>"):""}}});q.render=k;var x=q;
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */}})}));
//# sourceMappingURL=MultiChannelConversionAttribution.umd.min.js.map