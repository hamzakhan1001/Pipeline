(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["FormAnalytics"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["FormAnalytics"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/FormAnalytics/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"FormEdit",(function(){return Se})),n.d(t,"FormsList",(function(){return ft})),n.d(t,"FormsManage",(function(){return jt})),n.d(t,"FormFields",(function(){return Mt})),n.d(t,"FormPageLink",(function(){return Ht})),n.d(t,"FormSummary",(function(){return pn})),"undefined"!==typeof window){var o=window.document.currentScript,r=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(n.p=r[1])}var a=n("8bbf"),i={class:"loadingPiwik"},l=Object(a["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),c={class:"loadingPiwik"},s=Object(a["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),m={name:"name"},u={name:"description"},d={class:"form-group row",style:{"margin-bottom":"0"}},f={class:"col s12"},p={class:"form-group row",style:{"margin-bottom":"0"}},b={class:"col s12"},h=["innerHTML"],v=["title"],O={class:"form-group row"},j={class:"col s12 m4 matchAttribute"},g={name:"matchAttribute"},y={class:"col s12 m4 matchPattern"},F={name:"matchType"},V={class:"col s12 m4"},N={name:"matchValue"},E=["title"],_=["title","onClick"],S={name:"matchPageOnly"},k={class:"form-group row",style:{"margin-bottom":"0"}},A={class:"col s12"},C={class:"form-group row",style:{"margin-bottom":"0"}},w={class:"col s12"},R=["title"],D={class:"form-group row"},B={class:"col s12 m4 matchAttribute"},M={name:"matchAttribute"},x={class:"col s12 m4 matchPattern"},T={name:"matchType"},P={class:"col s12 m4"},H={name:"matchValue"},U=["title"],L=["title","onClick"],I={class:"form-group row",style:{"margin-bottom":"0"}},q={class:"col s12"},G={name:"conversionRuleOption"},z={key:0,class:"form-group row"},K={id:"javascript-tracking",class:"col s6"},J=["innerHTML"],W=["innerHTML"],X=["innerHTML"],Y={class:"form-group row",style:{"margin-bottom":"0"}},Q={class:"col s12"},Z=["title"],ee={class:"form-group row"},te={class:"col s12 m4 matchAttribute"},ne={name:"matchAttribute"},oe={class:"col s12 m4 matchPattern"},re={name:"matchType"},ae={class:"col s12 m4"},ie={name:"matchValue"},le=["title"],ce=["title","onClick"],se={class:"entityCancel"};function me(e,t,n,o,r,$){var me=Object(a["resolveComponent"])("Field"),ue=Object(a["resolveComponent"])("SaveButton"),de=Object(a["resolveComponent"])("ContentBlock"),fe=Object(a["resolveDirective"])("select-on-focus");return Object(a["openBlock"])(),Object(a["createBlock"])(de,{class:"editForm","content-title":e.contentTitle},{default:Object(a["withCtx"])((function(){return[Object(a["withDirectives"])(Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("span",i,[l,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[a["vShow"],e.isLoading]]),Object(a["withDirectives"])(Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("span",c,[s,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("FormAnalytics_UpdatingData")),1)])],512),[[a["vShow"],e.isUpdating]]),Object(a["createElementVNode"])("form",{onSubmit:t[9]||(t[9]=function(t){return e.edit?e.updateForm():e.createForm()})},[Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("div",m,[Object(a["createVNode"])(me,{uicontrol:"text",name:"name","model-value":e.form.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.form.name=t,e.setValueHasChanged()}),title:e.translate("General_Name"),maxlength:50,placeholder:e.translate("FormAnalytics_FieldNamePlaceholder"),"inline-help":e.translate("FormAnalytics_FormNameHelp")},null,8,["model-value","title","placeholder","inline-help"])]),Object(a["createElementVNode"])("div",u,[Object(a["createVNode"])(me,{uicontrol:"textarea",name:"description","model-value":e.form.description,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.form.description=t,e.setValueHasChanged()}),title:"".concat(e.translate("General_Description")," (optional)"),maxlength:1e3,rows:3,placeholder:e.translate("FormAnalytics_FieldDescriptionPlaceholder"),"inline-help":e.translate("FormAnalytics_FormDescriptionHelp")},null,8,["model-value","title","placeholder","inline-help"])]),Object(a["createElementVNode"])("div",d,[Object(a["createElementVNode"])("div",f,[Object(a["createElementVNode"])("h3",null,"1) "+Object(a["toDisplayString"])(e.translate("FormAnalytics_FormSetupFormRules")),1)])]),Object(a["withDirectives"])(Object(a["createElementVNode"])("div",p,[Object(a["createElementVNode"])("div",b,[Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.formSetupRulesHelp)},null,8,h),Object(a["createElementVNode"])("span",{style:{"margin-left":"3.5px"},class:"icon-help",title:e.translate("FormAnalytics_ComparisonsCaseInsensitive")},null,8,v)])])],512),[[a["vShow"],!e.matchPageOnly]]),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.form.match_form_rules,(function(n,o){return Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:Object(a["normalizeClass"])("matchFormRules ".concat(o," valign-wrapper")),key:o},[Object(a["createElementVNode"])("div",O,[Object(a["createElementVNode"])("div",j,[Object(a["createElementVNode"])("div",g,[Object(a["createVNode"])(me,{uicontrol:"select",name:"matchAttribute","model-value":n.attribute,"onUpdate:modelValue":function(t){n.attribute=t,e.setValueHasChanged(),e.matchFormRuleChanged()},"full-width":!0,options:e.formRulesAttributes},null,8,["model-value","onUpdate:modelValue","options"])])]),Object(a["createElementVNode"])("div",y,[Object(a["createElementVNode"])("div",F,[Object(a["createVNode"])(me,{uicontrol:"select",name:"matchType","model-value":n.pattern,"onUpdate:modelValue":function(t){n.pattern=t,e.setValueHasChanged(),e.matchFormRuleChanged()},"full-width":!0,options:e.formRulesPatterns[n.attribute]},null,8,["model-value","onUpdate:modelValue","options"])])]),Object(a["createElementVNode"])("div",V,[Object(a["createElementVNode"])("div",N,[Object(a["createVNode"])(me,{uicontrol:"text",name:"matchValue",placeholder:"eg '".concat(e.formRulesExamples[n.attribute],"'"),"model-value":n.value,"onUpdate:modelValue":function(t){n.value=t,e.setValueHasChanged(),e.matchFormRuleChanged()},"full-width":!0,maxlength:1e3},null,8,["placeholder","model-value","onUpdate:modelValue"])])])]),Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("span",{class:"icon-plus",title:e.translate("General_Add"),onClick:t[2]||(t[2]=function(t){return e.addMatchFormRule()})},null,8,E),Object(a["withDirectives"])(Object(a["createElementVNode"])("span",{class:"icon-minus",title:e.translate("General_Remove"),onClick:function(t){return e.removeMatchFormRule(o)}},null,8,_),[[a["vShow"],e.form.match_form_rules.length>1]])])],2)),[[a["vShow"],!e.matchPageOnly]])})),128)),Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("div",S,[Object(a["createVNode"])(me,{uicontrol:"checkbox",name:"matchPageOnly","model-value":e.matchPageOnly,"onUpdate:modelValue":t[3]||(t[3]=function(t){e.matchPageOnly=t,e.setValueHasChanged()}),title:e.translate("FormAnalytics_SettingAllowCreationByPageOnly"),"inline-help":e.translate("FormAnalytics_SettingAllowCreationByPageOnlyDescription")},null,8,["model-value","title","inline-help"])])]),Object(a["createElementVNode"])("div",k,[Object(a["createElementVNode"])("div",A,[Object(a["createElementVNode"])("h3",null,"2) "+Object(a["toDisplayString"])(e.translate("FormAnalytics_FormSetupPageRules"))+":",1)])]),Object(a["createElementVNode"])("div",C,[Object(a["createElementVNode"])("div",w,[Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("FormAnalytics_FormSetupPageRulesHelp"))+" ",1),Object(a["createElementVNode"])("span",{class:"icon-help",title:e.setupPageRulesHelpTooltip},null,8,R)])])]),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.form.match_page_rules,(function(n,o){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:Object(a["normalizeClass"])("matchPageRules ".concat(o," valign-wrapper")),key:o},[Object(a["createElementVNode"])("div",D,[Object(a["createElementVNode"])("div",B,[Object(a["createElementVNode"])("div",M,[Object(a["createVNode"])(me,{uicontrol:"select",name:"matchAttribute","model-value":n.attribute,"onUpdate:modelValue":function(t){n.attribute=t,e.setValueHasChanged()},"full-width":!0,options:e.pageRulesAttributes},null,8,["model-value","onUpdate:modelValue","options"])])]),Object(a["createElementVNode"])("div",x,[Object(a["createElementVNode"])("div",T,[Object(a["createVNode"])(me,{uicontrol:"select",name:"matchType","model-value":n.pattern,"onUpdate:modelValue":function(t){n.pattern=t,e.setValueHasChanged()},"full-width":!0,options:e.pageRulesPatterns[n.attribute]},null,8,["model-value","onUpdate:modelValue","options"])])]),Object(a["createElementVNode"])("div",P,[Object(a["createElementVNode"])("div",H,[Object(a["createVNode"])(me,{uicontrol:"text",name:"matchValue",placeholder:"eg '".concat(e.pageRulesExamples[n.attribute],"'"),"model-value":n.value,"onUpdate:modelValue":function(t){n.value=t,e.setValueHasChanged()},"full-width":!0,maxlength:1e3},null,8,["placeholder","model-value","onUpdate:modelValue"])])])]),Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("span",{class:"icon-plus",title:e.translate("General_Add"),onClick:t[4]||(t[4]=function(t){return e.addMatchPageRule()})},null,8,U),Object(a["withDirectives"])(Object(a["createElementVNode"])("span",{class:"icon-minus",title:e.translate("General_Remove"),onClick:function(t){return e.removeMatchPageRule(o)}},null,8,L),[[a["vShow"],e.form.match_page_rules.length>1]])])],2)})),128)),Object(a["createElementVNode"])("div",I,[Object(a["createElementVNode"])("div",q,[Object(a["createElementVNode"])("h3",null,"3) "+Object(a["toDisplayString"])(e.translate("FormAnalytics_FormSetupConversionRulesTitle"))+":",1)])]),Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("div",G,[Object(a["createVNode"])(me,{uicontrol:"radio",name:"conversionRuleOption","model-value":e.conversionRuleOption,"onUpdate:modelValue":t[5]||(t[5]=function(t){e.conversionRuleOption=t,e.setValueHasChanged(),e.conversionRuleOptionChanged()}),title:e.translate("FormAnalytics_FormSetupTitle"),"inline-help":e.$sanitize(e.getInlineHelpByConversionOption),options:e.conversionRuleOptions},null,8,["model-value","title","inline-help","options"])])]),"manually"===e.conversionRuleOption?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",z,[Object(a["createElementVNode"])("div",K,[Object(a["createElementVNode"])("p",{innerHTML:e.$sanitize(e.translate("FormAnalytics_FormSetupConversionRulesManualConversionJsOrTagManagerDescription"))},null,8,J),Object(a["withDirectives"])(Object(a["createElementVNode"])("pre",{class:"codeblock",innerHTML:e.$sanitize(e.jsCode)},null,8,W),[[fe,{}]]),Object(a["createElementVNode"])("p",{innerHTML:e.$sanitize(e.getJsOrTagManagerHelpCode)},null,8,X)])])):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("div",Y,[Object(a["withDirectives"])(Object(a["createElementVNode"])("div",Q,[Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("FormAnalytics_FormSetupPageRulesHelpNew"))+" ",1),Object(a["createElementVNode"])("span",{class:"icon-help",title:e.setupPageRulesHelpTooltip},null,8,Z)])],512),[[a["vShow"],"page_visit"===e.conversionRuleOption]])]),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.form.conversion_rules,(function(n,o){return Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:Object(a["normalizeClass"])("conversionRules ".concat(o," valign-wrapper")),key:o},[Object(a["createElementVNode"])("div",ee,[Object(a["createElementVNode"])("div",te,[Object(a["createElementVNode"])("div",ne,[Object(a["createVNode"])(me,{uicontrol:"select",name:"matchAttribute","model-value":n.attribute,"onUpdate:modelValue":function(t){n.attribute=t,e.setValueHasChanged()},"full-width":!0,options:e.pageRulesAttributes},null,8,["model-value","onUpdate:modelValue","options"])])]),Object(a["createElementVNode"])("div",oe,[Object(a["createElementVNode"])("div",re,[Object(a["createVNode"])(me,{uicontrol:"select",name:"matchType","model-value":n.pattern,"onUpdate:modelValue":function(t){n.pattern=t,e.setValueHasChanged()},"full-width":!0,options:e.pageRulesPatterns[n.attribute]},null,8,["model-value","onUpdate:modelValue","options"])])]),Object(a["createElementVNode"])("div",ae,[Object(a["createElementVNode"])("div",ie,[Object(a["createVNode"])(me,{uicontrol:"text",name:"matchValue",placeholder:"eg '".concat(e.pageRulesExamples[n.attribute],"'"),"model-value":n.value,"onUpdate:modelValue":function(t){n.value=t,e.setValueHasChanged()},"full-width":!0,maxlength:1e3},null,8,["placeholder","model-value","onUpdate:modelValue"])])])]),Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("span",{class:"icon-plus",title:e.translate("General_Add"),onClick:t[6]||(t[6]=function(t){return e.addConversionRule()})},null,8,le),Object(a["withDirectives"])(Object(a["createElementVNode"])("span",{class:"icon-minus",title:e.translate("General_Remove"),onClick:function(t){return e.removeConversionRule(o)}},null,8,ce),[[a["vShow"],e.form.conversion_rules.length>1]])])],2)),[[a["vShow"],"page_visit"===e.conversionRuleOption]])})),128)),Object(a["createVNode"])(ue,{class:"createButton",onConfirm:t[7]||(t[7]=function(t){return e.edit?e.updateForm():e.createForm()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.createButtonText},null,8,["disabled","saving","value"]),Object(a["createElementVNode"])("div",se,[Object(a["createElementVNode"])("a",{onClick:t[8]||(t[8]=function(t){return e.cancel()})},Object(a["toDisplayString"])(e.translate("General_Cancel")),1)])])],32)]})),_:1},8,["content-title"])}var ue=n("19dc"),de=n("a5a2");function fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function be(e,t,n){return t&&pe(e.prototype,t),n&&pe(e,n),e}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */var ve=function(){function e(){var t=this;fe(this,e),he(this,"privateState",Object(a["reactive"])({forms:[],isLoading:!1,isUpdating:!1,filterStatus:"running"})),he(this,"state",Object(a["computed"])((function(){return Object(a["readonly"])(t.privateState)}))),he(this,"fetchPromise",{})}return be(e,[{key:"reload",value:function(){return this.privateState.forms=[],this.fetchPromise={},this.fetchForms()}},{key:"filterRules",value:function(e){return e.filter((function(e){return!(null===e||void 0===e||!e.value)}))}},{key:"getAvailableFormRules",value:function(){return ue["AjaxHelper"].fetch({method:"FormAnalytics.getAvailableFormRules",filter_limit:"-1"})}},{key:"getAvailablePageRules",value:function(){return ue["AjaxHelper"].fetch({method:"FormAnalytics.getAvailablePageRules",filter_limit:"-1"})}},{key:"getAvailableConversionRuleOptions",value:function(){return ue["AjaxHelper"].fetch({method:"FormAnalytics.getAvailableConversionRuleOptions",filter_limit:"-1"})}},{key:"fetchAvailableStatuses",value:function(){return ue["AjaxHelper"].fetch({method:"FormAnalytics.getAvailableStatuses"})}},{key:"fetchForms",value:function(){var e=this,t="FormAnalytics.getFormsByStatuses".concat(this.privateState.filterStatus);return this.fetchPromise[t]||(this.fetchPromise[t]=ue["AjaxHelper"].fetch({method:"FormAnalytics.getFormsByStatuses",filter_limit:"-1",statuses:this.privateState.filterStatus})),this.privateState.isLoading=!0,this.privateState.forms=[],this.fetchPromise[t].then((function(t){return e.privateState.forms=t,e.privateState.isLoading=!1,e.state.value.forms})).finally((function(){e.privateState.isLoading=!1}))}},{key:"findForm",value:function(e){var t=this,n=this.state.value.forms.find((function(t){return t.idsiteform===e}));return n?Promise.resolve(n):(this.privateState.isLoading=!0,ue["AjaxHelper"].fetch({idForm:e,method:"FormAnalytics.getForm"}).then((function(e){return Object(a["readonly"])(e)})).finally((function(){t.privateState.isLoading=!1})))}},{key:"deleteForm",value:function(e){var t=this;return this.privateState.isUpdating=!0,this.privateState.forms=[],ue["AjaxHelper"].fetch({idForm:e,method:"FormAnalytics.deleteForm"},{withTokenInUrl:!0}).then((function(){return{type:"success"}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){t.privateState.isUpdating=!1}))}},{key:"archiveForm",value:function(e){var t=this;return this.privateState.isUpdating=!0,this.privateState.forms=[],ue["AjaxHelper"].fetch({idForm:e,method:"FormAnalytics.archiveForm"},{withTokenInUrl:!0}).then((function(){return{type:"success"}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){t.privateState.isUpdating=!1}))}},{key:"createOrUpdateForm",value:function(e,t,n){var o=this;return this.privateState.isUpdating=!0,ue["AjaxHelper"].post({method:n,idForm:e.idsiteform,name:e.name.trim(),description:e.description.trim(),conversionRuleOption:e.conversion_rule_option},{matchFormRules:this.filterRules(t?[]:e.match_form_rules),matchPageRules:this.filterRules(e.match_page_rules),conversionRules:this.filterRules(e.conversion_rules)},{withTokenInUrl:!0}).then((function(e){return{type:"success",response:e}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){o.privateState.isUpdating=!1}))}},{key:"setFilterStatus",value:function(e){this.privateState.filterStatus=e}}]),e}(),Oe=new ve;function je(e){return Ve(e)||Fe(e)||ye(e)||ge()}function ge(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ye(e,t){if(e){if("string"===typeof e)return Ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ne(e,t):void 0}}function Fe(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ve(e){if(Array.isArray(e))return Ne(e)}function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var Ee="formsmanagement",_e=Object(a["defineComponent"])({props:{idForm:Number},components:{ContentBlock:ue["ContentBlock"],Field:de["Field"],SaveButton:de["SaveButton"]},directives:{SelectOnFocus:ue["SelectOnFocus"]},data:function(){return{isDirty:!1,formRules:[],pageRules:[],matchPageOnly:!1,conversionRuleOptions:[],conversionRuleOption:"",form:{},jsCode:"_paq.push(['FormAnalytics::trackFormConversion', '{formName}', '{formId}']);",learMoreAppended:!1}},created:function(){var e=this;Oe.getAvailableFormRules().then((function(t){e.formRules=t})),Oe.getAvailablePageRules().then((function(t){e.pageRules=t})),Oe.getAvailableConversionRuleOptions().then((function(t){e.conversionRuleOptions=t})),this.init()},watch:{idForm:function(e){null!==e&&this.init()}},methods:{removeAnyFormNotification:function(){ue["NotificationsStore"].remove(Ee),ue["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=ue["NotificationsStore"].show({message:e,context:t,id:Ee,type:"transient"});setTimeout((function(){ue["NotificationsStore"].scrollToNotification(n)}),100)},showErrorFieldNotProvidedNotification:function(e){var t=Object(ue["translate"])("FormAnalytics_ErrorXNotProvided",[e]);this.showNotification(t,"error")},init:function(){var e=this,t=this.idForm;this.form={},ue["Matomo"].helper.lazyScrollToContent(),setTimeout((function(){if(!e.learMoreAppended){e.learMoreAppended=!0;var t="https://matomo.org/faq/form-analytics/faq_23774/",n=Object(ue["translate"])("FormAnalytics_FormSetupConversionRulesFaqHelpLink",' <a target="blank" rel="noreferrer" href="'.concat(t,'">'),"</a>");$(".fieldRadioTitle").append(n)}}),200),this.edit&&t?Oe.findForm(t).then((function(t){var n;t&&(e.form=Object(ue["clone"])(t),e.matchPageOnly=!(null!==(n=e.form.match_form_rules)&&void 0!==n&&n.length),e.conversionRuleOption=e.form.conversion_rule_option,e.addInitialMatchFormRule(),e.addInitialMatchPageRule(),e.addInitialConversionRule(),e.isDirty=!1)})):this.create&&(this.form={idSite:ue["Matomo"].idSite,name:"",description:"",status:"running"},this.matchPageOnly=!1,this.conversionRuleOption="page_visit",this.addInitialMatchFormRule(),this.addInitialMatchPageRule(),this.addInitialConversionRule(),this.isDirty=!1)},addInitialMatchFormRule:function(){var e,t;null!==(e=this.form)&&void 0!==e&&null!==(t=e.match_form_rules)&&void 0!==t&&t.length?this.matchFormRuleChanged():this.addMatchFormRule()},addMatchFormRule:function(){this.form&&(this.form.match_form_rules=[].concat(je(this.form.match_form_rules||[]),[{attribute:"form_name",pattern:"equals",value:""}]),this.isDirty=!0)},addInitialMatchPageRule:function(){var e,t;null!==(e=this.form)&&void 0!==e&&null!==(t=e.match_page_rules)&&void 0!==t&&t.length||this.addMatchPageRule()},addMatchPageRule:function(){this.form&&(this.form.match_page_rules=[].concat(je(this.form.match_page_rules||[]),[{attribute:"page_url",pattern:"equals",value:""}]),this.isDirty=!0)},addInitialConversionRule:function(){var e,t;null!==(e=this.form)&&void 0!==e&&null!==(t=e.conversion_rules)&&void 0!==t&&t.length||this.addConversionRule()},addConversionRule:function(){this.form&&(this.form.conversion_rules=[].concat(je(this.form.conversion_rules||[]),[{attribute:"page_url",pattern:"equals",value:""}]),this.isDirty=!0)},removeConversionRule:function(e){this.form&&e>-1&&(this.form.conversion_rules=je(this.form.conversion_rules),this.form.conversion_rules.splice(e,1),this.isDirty=!0)},removeMatchFormRule:function(e){this.form&&e>-1&&(this.form.match_form_rules=je(this.form.match_form_rules),this.form.match_form_rules.splice(e,1),this.isDirty=!0)},removeMatchPageRule:function(e){this.form&&e>-1&&(this.form.match_page_rules=je(this.form.match_page_rules),this.form.match_page_rules.splice(e,1),this.isDirty=!0)},cancel:function(){var e=Object.assign({},ue["MatomoUrl"].hashParsed.value);delete e.idForm,ue["MatomoUrl"].updateHash(e)},createForm:function(){var e=this,t="FormAnalytics.addForm";this.removeAnyFormNotification(),this.checkRequiredFieldsAreSet()&&(this.form.conversion_rule_option=this.conversionRuleOption,Oe.createOrUpdateForm(this.form,this.matchPageOnly,t).then((function(t){if(t&&"error"!==t.type&&t.response){e.isDirty=!1;var n=t.response.value;Oe.reload().then((function(){ue["Matomo"].helper.isReportingPage()&&ue["Matomo"].postEvent("updateReportingMenu"),ue["MatomoUrl"].updateHash(Object.assign(Object.assign({},ue["MatomoUrl"].hashParsed.value),{},{idForm:n})),setTimeout((function(){e.showNotification(Object(ue["translate"])("FormAnalytics_FormCreated"),t.type)}),200)}))}})))},setValueHasChanged:function(){this.isDirty=!0},conversionRuleOptionChanged:function(){"page_visit"!==this.conversionRuleOption&&(this.form.conversion_rules=[{attribute:"page_url",pattern:"equals",value:""}])},matchFormRuleChanged:function(){if(this.form.match_form_rules.length){for(var e="",t="",n=0;n<this.form.match_form_rules.length;n+=1){var o=this.form.match_form_rules[n];"form_name"!==o.attribute||"equals_exactly"!==o.pattern&&"equals"!==o.pattern||!o.value?"form_id"!==o.attribute||"equals_exactly"!==o.pattern&&"equals"!==o.pattern||!o.value||(t=this.htmlEntities(o.value)):e=this.htmlEntities(o.value)}this.jsCode=e&&t?"_paq.push(['FormAnalytics::trackFormConversion', '".concat(e,"', '").concat(t,"']);"):e&&!t?"_paq.push(['FormAnalytics::trackFormConversion', '".concat(e,"']);"):!e&&t?"_paq.push(['FormAnalytics::trackFormConversion', '{formName}', '".concat(t,"']);"):"_paq.push(['FormAnalytics::trackFormConversion', '{formName}', '{formId}']);"}},updateForm:function(){var e=this;if(this.removeAnyFormNotification(),this.checkRequiredFieldsAreSet()){var t="FormAnalytics.updateForm";this.form.conversion_rule_option=this.conversionRuleOption,Oe.createOrUpdateForm(this.form,this.matchPageOnly,t).then((function(t){"error"!==t.type&&(e.isDirty=!1,e.form={},Oe.reload().then((function(){e.init()})),e.showNotification(Object(ue["translate"])("FormAnalytics_FormUpdated"),t.type))}))}},checkRequiredFieldsAreSet:function(){var e;if(!this.form.name){var t=Object(ue["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(t),!1}if("page_visit"===this.conversionRuleOption&&!this.matchPageOnly&&!Oe.filterRules((null===(e=this.form)||void 0===e?void 0:e.match_form_rules)||[]).length){var n=Object(ue["translate"])("FormAnalytics_ErrorFormRuleRequired");return this.showNotification(n,"error"),!1}return!0},htmlEntities:function(e){return ue["Matomo"].helper.htmlEntities(e)}},computed:{formRulesAttributes:function(){return this.formRules.map((function(e){return{key:e.key,value:e.name}}))},formRulesPatterns:function(){var e={};return this.formRules.forEach((function(t){e[t.key]=t.patterns.map((function(e){return{key:e.key,value:e.name}}))})),e},formRulesExamples:function(){var e={};return this.formRules.forEach((function(t){e[t.key]=t.example})),e},pageRulesAttributes:function(){return this.pageRules.map((function(e){return{key:e.key,value:e.name}}))},pageRulesPatterns:function(){var e={};return this.pageRules.forEach((function(t){e[t.key]=t.patterns.map((function(e){return{key:e.key,value:e.name}}))})),e},pageRulesExamples:function(){var e={};return this.pageRules.forEach((function(t){e[t.key]=t.example})),e},create:function(){return!this.idForm},edit:function(){return!this.create},editTitle:function(){return this.create?"FormAnalytics_CreateNewForm":"FormAnalytics_EditForm"},contentTitle:function(){return Object(ue["translate"])(this.editTitle,this.form.name?'"'.concat(this.form.name,'"'):"")},isLoading:function(){return Oe.state.value.isLoading},isUpdating:function(){return Oe.state.value.isUpdating},formSetupRulesHelp:function(){var e="https://matomo.org/faq/form-analytics/faq_23727/";return Object(ue["translate"])("FormAnalytics_FormSetupFormRulesHelp",'<a target="blank" rel="noreferrer" href="'.concat(e,'">'),"</a>")},setupConversionHelpRules2:function(){var e="https://developer.matomo.org/guides/form-analytics/reference";return Object(ue["translate"])("FormAnalytics_FormSetupConversionRulesHelp2",'<a target="blank" rel="noreferrer" href="'.concat(e,'">'),"</a>")},setupConversionsHelpTooltip:function(){var e=Object(ue["translate"])("FormAnalytics_ComparisonsCaseInsensitive"),t=Object(ue["translate"])("FormAnalytics_ComparisonsIgnoredValues");return"".concat(e," ").concat(t)},createButtonText:function(){return this.edit?Object(ue["translate"])("CoreUpdater_UpdateTitle"):Object(ue["translate"])("FormAnalytics_CreateNewForm")},setupPageRulesHelpTooltip:function(){var e=Object(ue["translate"])("FormAnalytics_ComparisonsCaseInsensitive"),t=Object(ue["translate"])("FormAnalytics_ComparisonsIgnoredValues");return"".concat(e," ").concat(t)},getInlineHelpByConversionOption:function(){var e=Object(ue["translate"])("FormAnalytics_FormSetupConversionRulesFormSubmitHelp","<b>","</b><br>"),t=Object(ue["translate"])("FormAnalytics_FormSetupConversionRulesPageVisitHelp","<br><br><b>","</b><br>"),n=Object(ue["translate"])("FormAnalytics_FormSetupConversionRulesJsOrTagManagerHelp","<br><br><b>","</b><br>");return"".concat(e).concat(t).concat(n)},getJsCode:function(){return"_paq.push(['FormAnalytics::trackFormConversion', '{formName}', '{formId}']);"},getJsOrTagManagerHelpCode:function(){var e="https://developer.matomo.org/guides/form-analytics/reference#trackformconversionnodeorformname-formid";return Object(ue["translate"])("FormAnalytics_FormSetupJsOrTagManagerHelp",'<a target="blank" rel="noreferrer" href="'.concat(e,'">'),"</a>")}}});_e.render=me;var Se=_e,ke=Object(a["createElementVNode"])("br",null,null,-1),Ae=Object(a["createElementVNode"])("br",null,null,-1),Ce={class:"formStatusFilter",name:"filterStatus",id:"filterStatus"},we={class:"formSearchFilter",name:"formSearch",style:{"margin-left":"3.5px"}},Re={class:"index"},De={class:"name"},Be={class:"description"},Me={class:"description"},xe={class:"action"},Te={colspan:"7"},Pe={class:"loadingPiwik"},He=Object(a["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Ue={colspan:"7"},Le=["id"],Ie={class:"index"},qe={class:"name"},Ge=["title"],$e={class:"conversionRulesConfigured"},ze={class:"action"},Ke=["title","onClick"],Je=["title","href"],We=["title","onClick"],Xe=["title","onClick"],Ye={class:"tableActionBar"},Qe=Object(a["createElementVNode"])("span",{class:"icon-add"},null,-1),Ze={class:"ui-confirm",ref:"confirmArchiveForm"},et=["value"],tt=["value"],nt={class:"ui-confirm",ref:"confirmDeleteForm"},ot=["value"],rt=["value"];function at(e,t,n,o,r,i){var l=Object(a["resolveComponent"])("Field"),c=Object(a["resolveComponent"])("ContentBlock"),s=Object(a["resolveDirective"])("content-table");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[Object(a["createVNode"])(c,{"content-title":e.translate("FormAnalytics_ManageForms"),feature:e.translate("FormAnalytics_ManageForms")},{default:Object(a["withCtx"])((function(){return[Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("FormAnalytics_ManageFormsIntroduction"))+" ",1),ke,Ae,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.autoCreationMessage),1)]),Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("div",Ce,[Object(a["createVNode"])(l,{uicontrol:"select",name:"filterStatus","model-value":e.filterStatus,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.setFilterStatus(t),e.onFilterStatusChange()}),title:e.translate("FormAnalytics_Filter"),"full-width":!0,options:e.statusOptions},null,8,["model-value","title","options"])]),Object(a["createElementVNode"])("div",we,[Object(a["withDirectives"])(Object(a["createVNode"])(l,{uicontrol:"text",name:"formSearch",title:e.translate("General_Search"),modelValue:e.searchFilter,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.searchFilter=t}),"full-width":!0},null,8,["title","modelValue"]),[[a["vShow"],e.forms.length>0]])])]),Object(a["withDirectives"])(Object(a["createElementVNode"])("table",null,[Object(a["createElementVNode"])("thead",null,[Object(a["createElementVNode"])("tr",null,[Object(a["createElementVNode"])("th",Re,Object(a["toDisplayString"])(e.translate("General_Id")),1),Object(a["createElementVNode"])("th",De,Object(a["toDisplayString"])(e.translate("General_Name")),1),Object(a["createElementVNode"])("th",Be,Object(a["toDisplayString"])(e.translate("General_Description")),1),Object(a["createElementVNode"])("th",Me,Object(a["toDisplayString"])(e.translate("FormAnalytics_ConversionCriteria")),1),Object(a["createElementVNode"])("th",xe,Object(a["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(a["createElementVNode"])("tbody",null,[Object(a["withDirectives"])(Object(a["createElementVNode"])("tr",null,[Object(a["createElementVNode"])("td",Te,[Object(a["createElementVNode"])("span",Pe,[He,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[a["vShow"],e.isLoading||e.isUpdating]]),Object(a["withDirectives"])(Object(a["createElementVNode"])("tr",null,[Object(a["createElementVNode"])("td",Ue,Object(a["toDisplayString"])(e.translate("FormAnalytics_NoFormsFound")),1)],512),[[a["vShow"],!e.isLoading&&0===e.forms.length]]),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.sortedForms,(function(t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",{id:"form".concat(t.idsiteform),class:"forms",key:t.idsiteform},[Object(a["createElementVNode"])("td",Ie,Object(a["toDisplayString"])(t.idsiteform),1),Object(a["createElementVNode"])("td",qe,Object(a["toDisplayString"])(t.name),1),Object(a["createElementVNode"])("td",{class:"description",title:t.description},Object(a["toDisplayString"])(e.truncateText(t.description.trim(),60)),9,Ge),Object(a["createElementVNode"])("td",$e,[Object(a["createElementVNode"])("span",{class:Object(a["normalizeClass"])({"icon-ok":t.conversion_rules.length>=1||t.conversion_rule_option&&"page_visit"!==t.conversion_rule_option})},null,2)]),Object(a["createElementVNode"])("td",ze,[Object(a["createElementVNode"])("a",{class:"table-action icon-edit",title:e.translate("FormAnalytics_EditForm"),onClick:function(n){return e.editForm(t.idsiteform)}},null,8,Ke),Object(a["withDirectives"])(Object(a["createElementVNode"])("a",{target:"_blank",class:"table-action icon-show",title:e.translate("FormAnalytics_ViewReportInfo"),href:e.getViewFormLink(t)},null,8,Je),[[a["vShow"],"running"===t.status]]),Object(a["withDirectives"])(Object(a["createElementVNode"])("a",{class:"table-action icon-archive",title:e.translate("FormAnalytics_ArchiveReportInfo"),onClick:function(n){return e.archiveForm(t)}},null,8,We),[[a["vShow"],"running"===t.status]]),Object(a["createElementVNode"])("a",{class:"table-action icon-delete",title:e.translate("FormAnalytics_DeleteFormInfo"),onClick:function(n){return e.deleteForm(t)}},null,8,Xe)])],8,Le)})),128))])],512),[[s]]),Object(a["createElementVNode"])("div",Ye,[Object(a["createElementVNode"])("a",{class:"createNewForm",onClick:t[2]||(t[2]=function(t){return e.createForm()})},[Qe,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("FormAnalytics_CreateNewForm")),1)])])]})),_:1},8,["content-title","feature"]),Object(a["createElementVNode"])("div",Ze,[Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.translate("FormAnalytics_ArchiveReportConfirm")),1),Object(a["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,et),Object(a["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,tt)],512),Object(a["createElementVNode"])("div",nt,[Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.translate("FormAnalytics_DeleteFormConfirm")),1),Object(a["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,ot),Object(a["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,rt)],512)])}function it(e){return mt(e)||st(e)||ct(e)||lt()}function lt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ct(e,t){if(e){if("string"===typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}function st(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function mt(e){if(Array.isArray(e))return ut(e)}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var dt=Object(a["defineComponent"])({props:{},components:{ContentBlock:ue["ContentBlock"],Field:de["Field"]},directives:{ContentTable:ue["ContentTable"]},data:function(){return{autoCreationMessage:"",statuses:[],searchFilter:""}},created:function(){var e=this;ue["AjaxHelper"].fetch({method:"FormAnalytics.getAutoCreationSettings"}).then((function(t){null!==t&&void 0!==t&&t.message&&(e.autoCreationMessage=t.message)})),Oe.fetchAvailableStatuses().then((function(t){e.statuses=t})),this.onFilterStatusChange()},methods:{setFilterStatus:function(e){Oe.setFilterStatus(e)},createForm:function(){this.editForm(0)},editForm:function(e){ue["MatomoUrl"].updateHash(Object.assign(Object.assign({},ue["MatomoUrl"].hashParsed.value),{},{idForm:e}))},deleteForm:function(e){ue["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteForm,{yes:function(){Oe.deleteForm(e.idsiteform).then((function(){Oe.reload(),ue["Matomo"].postEvent("updateReportingMenu")}))}})},archiveForm:function(e){ue["Matomo"].helper.modalConfirm(this.$refs.confirmArchiveForm,{yes:function(){Oe.archiveForm(e.idsiteform).then((function(){Oe.reload(),ue["Matomo"].postEvent("updateReportingMenu")}))}})},onFilterStatusChange:function(){Oe.fetchForms()},truncateText:function(e,t){return e.length>t?"".concat(e.substr(0,t-3),"..."):e},getViewFormLink:function(e){return"?".concat(ue["MatomoUrl"].stringify({module:"CoreHome",action:"index",idSite:e.idsite,period:"day",date:"yesterday"}),"#?").concat(ue["MatomoUrl"].stringify({category:"FormAnalytics_Forms",idSite:e.idsite,period:"day",date:"yesterday",subcategory:e.idsiteform}))}},computed:{filterStatus:function(){return Oe.state.value.filterStatus},statusOptions:function(){return this.statuses.filter((function(e){return"deleted"!==e.value})).map((function(e){return{key:e.value,value:e.name}}))},forms:function(){return Oe.state.value.forms},isLoading:function(){return Oe.state.value.isLoading},isUpdating:function(){return Oe.state.value.isUpdating},sortedForms:function(){var e=this,t=it(this.forms).filter((function(t){return Object.keys(t).some((function(n){var o=t;return"string"===typeof o[n]&&-1!==o[n].toLowerCase().indexOf(e.searchFilter.toLowerCase())}))}));return t.sort((function(e,t){var n=parseInt("".concat(e.idsiteform),10),o=parseInt("".concat(t.idsiteform),10);return n-o})),t}}});dt.render=at;var ft=dt,pt={class:"manageForms"},bt={key:0},ht={key:1};function vt(e,t,n,o,r,i){var l=Object(a["resolveComponent"])("FormsList"),c=Object(a["resolveComponent"])("FormsEdit");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",pt,[e.editMode?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",bt,[Object(a["createVNode"])(l)])),e.editMode?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",ht,[Object(a["createVNode"])(c,{"id-form":e.idForm},null,8,["id-form"])])):Object(a["createCommentVNode"])("",!0)])}var Ot=Object(a["defineComponent"])({props:{},components:{FormsList:ft,FormsEdit:Se},data:function(){return{editMode:!1,idForm:null}},watch:{editMode:function(){$(".ui-tooltip").remove()}},created:function(){var e=this;Object(a["watch"])((function(){return ue["MatomoUrl"].hashParsed.value.idForm}),(function(t){e.initState(t)})),this.initState(ue["MatomoUrl"].hashParsed.value.idForm)},methods:{removeAnyFormNotification:function(){ue["NotificationsStore"].remove("formsmanagement")},initState:function(e){if(e){if("0"===e){var t={isAllowed:!0};if(ue["Matomo"].postEvent("FormAnalytics.initAddForm",t),t&&!t.isAllowed)return this.editMode=!1,void(this.idForm=null)}this.editMode=!0,this.idForm=parseInt(e,10)}else this.editMode=!1,this.idForm=null;this.removeAnyFormNotification()}}});Ot.render=vt;var jt=Ot,gt={class:"knownFormFields"},yt={key:0},Ft=["title"],Vt={key:0},Nt={colspan:"3"},Et={key:1},_t={colspan:"3"};function St(e,t,n,o,r,i){var l=Object(a["resolveComponent"])("Field"),c=Object(a["resolveComponent"])("SaveButton"),s=Object(a["resolveDirective"])("content-table");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",gt,[Object(a["withDirectives"])(Object(a["createElementVNode"])("table",null,[Object(a["createElementVNode"])("thead",null,[Object(a["createElementVNode"])("tr",null,[Object(a["createElementVNode"])("th",null,Object(a["toDisplayString"])(e.translate("FormAnalytics_FieldName")),1),Object(a["createElementVNode"])("th",null,Object(a["toDisplayString"])(e.translate("FormAnalytics_FieldType")),1),Object(a["createElementVNode"])("th",null,Object(a["toDisplayString"])(e.translate("FormAnalytics_DisplayName")),1)])]),Object(a["createElementVNode"])("tbody",null,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.limitedFields,(function(t,n){return Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",{key:n},[Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.name),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.type),1),Object(a["createElementVNode"])("td",{class:Object(a["normalizeClass"])({fieldDisplayNameInput:e.canEditForm})},[e.canEditForm?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",yt,[Object(a["createVNode"])(l,{uicontrol:"text",modelValue:e.names[t.name],"onUpdate:modelValue":function(n){return e.names[t.name]=n},maxlength:50,"full-width":!0},null,8,["modelValue","onUpdate:modelValue"])])):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:1,title:e.translate("FormAnalytics_DisplayNameRequiresAdminAccess")},Object(a["toDisplayString"])(t.displayName||"-"),9,Ft))],2)])})),128)),e.form.fields.length>200?(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",Vt,[Object(a["createElementVNode"])("td",Nt,Object(a["toDisplayString"])(e.translate("FormAnalytics_FormFieldEditLimited",200)),1)])):Object(a["createCommentVNode"])("",!0),e.canEditForm?(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",Et,[Object(a["createElementVNode"])("td",_t,[Object(a["createVNode"])(c,{onConfirm:t[0]||(t[0]=function(t){return e.renameFields(e.form.idsiteform)}),saving:e.isLoading},null,8,["saving"])])])):Object(a["createCommentVNode"])("",!0)])],512),[[s]])])}function kt(e,t){return Dt(e)||Rt(e,t)||Ct(e,t)||At()}function At(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ct(e,t){if(e){if("string"===typeof e)return wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wt(e,t):void 0}}function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Rt(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(o=n.next()).done);i=!0)if(a.push(o.value),t&&a.length===t)break}catch(c){l=!0,r=c}finally{try{i||null==n["return"]||n["return"]()}finally{if(l)throw r}}return a}}function Dt(e){if(Array.isArray(e))return e}var Bt=Object(a["defineComponent"])({props:{form:{type:Object,required:!0},canEditForm:Boolean},components:{Field:de["Field"],SaveButton:de["SaveButton"]},directives:{ContentTable:ue["ContentTable"]},data:function(){return{isLoading:!1,names:{}}},created:function(){var e=this;this.limitedFields.forEach((function(t){e.names[t.name]=t.displayName}))},methods:{renameFields:function(e){var t=this;this.isLoading=!0,ue["AjaxHelper"].post({module:"API",method:"FormAnalytics.updateFormFieldDisplayName"},{fields:Object.entries(this.names).map((function(e){var t=kt(e,2),n=t[0],o=t[1];return{name:n,displayName:o}})),idForm:e}).then((function(){ue["Matomo"].helper.redirect()})).catch((function(){t.isLoading=!1}))}},computed:{limitedFields:function(){return this.form.fields.slice(0,200)}}});Bt.render=St;var Mt=Bt,xt=window,Tt=xt.$,Pt={mounted:function(e,t){if(ue["Matomo"].helper.isReportingPage()){var n=Tt(e);if("a"!==e.tagName.toLowerCase()){var o=Tt(e).text();Tt(e).html("<a></a>"),n=Tt(e).find("a"),n.text(o)}n.bind("click",(function(e){e.preventDefault(),ue["MatomoUrl"].updateHash(Object.assign(Object.assign({},ue["MatomoUrl"].hashParsed.value),{},{category:"FormAnalytics_Forms",subcategory:t.value.idForm}))}))}}},Ht=Pt;
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */ue["Matomo"].on("Matomo.processDynamicHtml",(function(e){e.find("[piwik-form-page-link]").each((function(e,t){if(!Tt(t).attr("piwik-form-page-link-handled")){var n=Tt(t).attr("piwik-form-page-link");n&&Pt.mounted(t,{instance:null,value:{idForm:n},oldValue:null,modifiers:{},dir:{}}),Tt(t).attr("piwik-form-page-link-handled","1")}}))}));var Ut={class:"formSummary"},Lt={key:0},It=Object(a["createElementVNode"])("br",null,null,-1),qt={key:1},Gt={key:2},$t={key:3},zt={key:4},Kt={key:5},Jt={key:6},Wt={key:7},Xt={key:8},Yt=Object(a["createElementVNode"])("span",{class:"icon-warning",style:{"margin-right":"3.5px"}},null,-1),Qt=["innerHTML"],Zt=Object(a["createElementVNode"])("br",null,null,-1),en=["href"],tn=Object(a["createElementVNode"])("span",{class:"icon-edit"},null,-1),nn=Object(a["createElementVNode"])("br",null,null,-1),on={key:2},rn=Object(a["createElementVNode"])("span",{class:"icon-visitor-profile"},null,-1),an=Object(a["createElementVNode"])("span",{class:"icon-visitor-profile"},null,-1),ln=Object(a["createElementVNode"])("span",{class:"icon-visitor-profile"},null,-1),cn=Object(a["createElementVNode"])("br",null,null,-1),sn=Object(a["createElementVNode"])("a",{name:"editformfields"},null,-1);function mn(e,t,n,o,r,i){var l,c,s,m,u,d,f=Object(a["resolveComponent"])("FormFields"),p=Object(a["resolveDirective"])("content-intro");return Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.translate("FormAnalytics_FormX",'"'.concat(e.form.name,'"'))),1),Object(a["createElementVNode"])("div",Ut,[Object(a["createElementVNode"])("p",null,[e.form.description?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",Lt,[Object(a["createElementVNode"])("strong",null,Object(a["toDisplayString"])(e.translate("General_Description"))+":",1),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.form.description)+" ",1),It])):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("strong",null,Object(a["toDisplayString"])(e.translate("FormAnalytics_DataIsCollectedWhen"))+":",1),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(this.matchRulesList(e.form.match_form_rules))+" ",1),null!==(l=e.form.match_form_rules)&&void 0!==l&&l.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("br",qt)):Object(a["createCommentVNode"])("",!0),null!==(c=e.form.match_form_rules)&&void 0!==c&&c.length&&null!==(s=e.form.match_page_rules)&&void 0!==s&&s.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",Gt,Object(a["toDisplayString"])(e.translate("FormAnalytics_AndWhen")),1)):Object(a["createCommentVNode"])("",!0),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(this.matchRulesList(e.form.match_page_rules))+" ",1),null!==(m=e.form.match_page_rules)&&void 0!==m&&m.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("br",$t)):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("strong",null,Object(a["toDisplayString"])(e.translate("FormAnalytics_FormIsConvertedWhen"))+": ",1),"form_submit"===e.form.conversion_rule_option?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",zt,Object(a["toDisplayString"])(e.translate("FormAnalytics_TheFormIsSubmitted")),1)):"manually"===e.form.conversion_rule_option?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",Kt,Object(a["toDisplayString"])(e.translate("FormAnalytics_FormSetupConversionRulesConditionJsOrTagManager")),1)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",Jt,Object(a["toDisplayString"])(this.matchRulesList(e.form.conversion_rules)),1)),null!==(u=e.form.conversion_rules)&&void 0!==u&&u.length||"form_submit"===e.form.conversion_rule_option||"manually"===e.form.conversion_rule_option?(Object(a["openBlock"])(),Object(a["createElementBlock"])("br",Wt)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",Xt,[Yt,Object(a["createElementVNode"])("span",{innerHTML:e.noConversionRulesWarningText},null,8,Qt),Zt]))]),Object(a["createElementVNode"])("p",null,[e.canEditForm?(Object(a["openBlock"])(),Object(a["createElementBlock"])("a",{key:0,href:this.formEditLink},[tn,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("FormAnalytics_EditForm")),1)],8,en)):Object(a["createCommentVNode"])("",!0),null!==(d=e.form.fields)&&void 0!==d&&d.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("a",{key:1,href:"",style:Object(a["normalizeStyle"])("margin-left: ".concat(e.canEditForm?"8.5":"0","px;")),onClick:t[0]||(t[0]=Object(a["withModifiers"])((function(t){return e.toggleKnownFormFields()}),["prevent"])),class:"toggleKnownFormFields"},[Object(a["createElementVNode"])("span",{class:Object(a["normalizeClass"])("".concat(e.canEditForm?"icon-edit":"icon-show"))},null,2),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.canEditForm?e.translate("FormAnalytics_EditFormFields"):e.translate("FormAnalytics_ViewFormFields")),1)],4)):Object(a["createCommentVNode"])("",!0),nn,e.isVisitorLogEnabled?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",on,[Object(a["createElementVNode"])("a",{href:"",class:"segmentVisitorsByStarters",onClick:t[1]||(t[1]=Object(a["withModifiers"])((function(t){return e.showSegmentedVisitorLog("form_num_starts>0")}),["prevent"]))},[rn,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("FormAnalytics_ShowVisitorLogStarters")),1)]),Object(a["createElementVNode"])("a",{href:"",style:{"margin-left":"8.5px"},class:"segmentVisitorsBySubmitters",onClick:t[2]||(t[2]=Object(a["withModifiers"])((function(t){return e.showSegmentedVisitorLog("form_num_submissions>0")}),["prevent"]))},[an,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("FormAnalytics_ShowVisitorLogSubmitters")),1)]),Object(a["createElementVNode"])("a",{href:"",style:{"margin-left":"8.5px"},class:"segmentVisitorsByConverters",onClick:t[3]||(t[3]=Object(a["withModifiers"])((function(t){return e.showSegmentedVisitorLog("form_converted==1")}),["prevent"]))},[ln,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("FormAnalytics_ShowVisitorLogConverters")),1)]),cn])):Object(a["createCommentVNode"])("",!0)]),sn,Object(a["withDirectives"])(Object(a["createVNode"])(f,{form:e.form,"can-edit-form":e.canEditForm},null,8,["form","can-edit-form"]),[[a["vShow"],e.isKnownFieldsVisible]])])],512)),[[p]])}var un=window,dn=un.SegmentedVisitorLog,fn=Object(a["defineComponent"])({props:{form:{type:Object,required:!0},canEditForm:Boolean,isVisitorLogEnabled:Boolean,attributeTranslations:{type:Object,required:!0},patternTranslations:{type:Object,required:!0},segment:String},directives:{ContentIntro:ue["ContentIntro"]},components:{FormFields:Mt},data:function(){return{isKnownFieldsVisible:!1}},methods:{matchRule:function(e){var t=this.attributeTranslations[e.attribute]||e.attribute,n=this.patternTranslations[e.pattern]||e.pattern;return"".concat(t,"\n").concat(n,"\n").concat(e.value)},matchRulesList:function(e){var t=this;if(null===e||void 0===e||!e.length)return"";var n=e.map((function(e){return t.matchRule(e)}));return n.join(" ".concat(Object(ue["translate"])("General_Or")," "))},toggleKnownFormFields:function(){this.isKnownFieldsVisible=!this.isKnownFieldsVisible,console.log(this.isKnownFieldsVisible)},showSegmentedVisitorLog:function(e){var t=this.segment?";".concat(this.segment):"";dn.show("FormAnalytics.get","form_name==".concat(this.form.idsiteform,";").concat(e).concat(t),{})}},computed:{formEditLink:function(){return"?".concat(ue["MatomoUrl"].stringify(Object.assign(Object.assign({},ue["MatomoUrl"].urlParsed.value),{},{module:"CoreHome",action:"index"})),"#?idForm=").concat(this.form.idsiteform,"&category=FormAnalytics_Forms&subcategory=FormAnalytics_ManageForms")},noConversionRulesWarningText:function(){return this.canEditForm?Object(ue["translate"])("FormAnalytics_NoConversionRulesDefinesAdmin",'<a href="'.concat(this.formEditLink,'">'),"</a>"):Object(ue["translate"])("FormAnalytics_NoConversionRulesDefinesView")}}});fn.render=mn;var pn=fn;
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */}})}));
//# sourceMappingURL=FormAnalytics.umd.min.js.map