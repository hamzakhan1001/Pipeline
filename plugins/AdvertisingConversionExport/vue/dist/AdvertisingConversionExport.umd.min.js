(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin"),require("SegmentEditor")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin","SegmentEditor"],t):"object"===typeof exports?exports["AdvertisingConversionExport"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin"),require("SegmentEditor")):e["AdvertisingConversionExport"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"],e["SegmentEditor"])})("undefined"!==typeof self?self:this,(function(e,t,o,n){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="plugins/AdvertisingConversionExport/vue/dist/",o(o.s="fae3")}({"19dc":function(t,o){t.exports=e},"8bbf":function(e,o){e.exports=t},a5a2:function(e,t){e.exports=o},f06f:function(e,t){e.exports=n},fae3:function(e,t,o){"use strict";if(o.r(t),o.d(t,"ConversionExportEdit",(function(){return Ge})),o.d(t,"ConversionExportList",(function(){return Nt})),o.d(t,"ConversionExportManage",(function(){return _t})),"undefined"!==typeof window){var n=window.document.currentScript,r=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(o.p=r[1])}var i=o("8bbf"),a={class:"loadingPiwik"},l=Object(i["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),s={class:"loadingPiwik"},c=Object(i["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),d={name:"name"},p={name:"type"},u={name:"description"},v={class:"row accesstokenhead"},m={class:"col s12"},b={name:"access_token"},x={class:"form-group row",style:{"margin-bottom":"0"}},E={class:"col s12"},f={name:"directAttribution"},h={name:"daysToLookBack"},g={name:"clickIdAttribution"},O={name:"externalAttributedConversion"},j={name:"attributionModel"},y={name:"attributedCredit"},C={class:"form-group row",style:{"margin-bottom":"0"}},N={class:"col s12"},A={class:"form-group row",style:{"margin-bottom":"0"}},V={class:"col s12"},k=["innerHTML"],S={name:"daysToExport"},w={class:"form-group row",style:{"margin-bottom":"0"}},_={class:"col s12"},D=["innerHTML"],T={class:"form-group row",style:{"margin-bottom":"0"}},M={class:"col s12"},G={class:"form-group row",style:{"margin-bottom":"0"}},L={class:"col s12"},B=["innerHTML"],U={class:"loadingPiwik"},H=Object(i["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),I={key:1},P={class:"form-group row"},q={class:"col s12 m4"},R=["name"],F={class:"col s12 m4"},$=["name"],W={class:"col s12 m4"},z={class:"row",style:{"margin-bottom":"0"}},Y=["name"],X=["name"],J=["title"],K=["title","onClick"],Q={class:"entityCancel"},Z={class:"ui-confirm",id:"confirmRegenerateAccessToken",ref:"confirmRegenerateAccessToken"},ee=["value"],te=["value"];function oe(e,t,o,n,r,oe){var ne=Object(i["resolveComponent"])("Field"),re=Object(i["resolveComponent"])("SegmentGenerator"),ie=Object(i["resolveComponent"])("Alert"),ae=Object(i["resolveComponent"])("SaveButton"),le=Object(i["resolveComponent"])("ContentBlock");return Object(i["openBlock"])(),Object(i["createBlock"])(le,{class:"editConversionExport","content-title":e.contentTitle},{default:Object(i["withCtx"])((function(){return[Object(i["withDirectives"])(Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",a,[l,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[i["vShow"],e.isLoading]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",s,[c,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_UpdatingData")),1)])],512),[[i["vShow"],e.isUpdating]]),Object(i["createElementVNode"])("form",{onSubmit:t[16]||(t[16]=function(t){return e.edit?e.updateExport():e.createExport()})},[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("div",d,[Object(i["createVNode"])(ne,{uicontrol:"text",name:"name","model-value":e.conversionExport.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.conversionExport.name=t,e.setValueHasChanged()}),title:e.translate("General_Name"),maxlength:50,tabindex:21,placeholder:e.translate("AdvertisingConversionExport_FieldNamePlaceholder"),"inline-help":e.translate("AdvertisingConversionExport_ExportNameHelp")},null,8,["model-value","title","placeholder","inline-help"])]),Object(i["createElementVNode"])("div",p,[Object(i["createVNode"])(ne,{uicontrol:"radio",name:"type","model-value":e.conversionExport.type,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.conversionExport.type=t,e.setValueHasChanged(),e.showNote()}),title:e.translate("AdvertisingConversionExport_ExportType"),tabindex:22,options:e.exportTypeOptions,"inline-help":e.conversionExportHelp},null,8,["model-value","title","options","inline-help"])]),Object(i["createElementVNode"])("div",u,[Object(i["createVNode"])(ne,{uicontrol:"textarea",name:"description","model-value":e.conversionExport.description,"onUpdate:modelValue":t[2]||(t[2]=function(t){e.conversionExport.description=t,e.setValueHasChanged()}),title:"".concat(e.translate("General_Description")," ").concat(e.translate("Goals_Optional")),maxlength:1e3,rows:3,tabindex:26,placeholder:e.translate("AdvertisingConversionExport_ExportDescriptionPlaceHolder"),"inline-help":e.translate("AdvertisingConversionExport_ExportDescriptionHelp")},null,8,["model-value","title","placeholder","inline-help"])]),Object(i["createElementVNode"])("div",v,[Object(i["createElementVNode"])("label",m,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_AccessToken"))+" ",1),Object(i["withDirectives"])(Object(i["createElementVNode"])("a",{onClick:t[3]||(t[3]=function(t){return e.regenerateAccessToken()})},"("+Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_Regenerate"))+")",513),[[i["vShow"],e.conversionExport.idexport]])])]),Object(i["createElementVNode"])("div",b,[Object(i["createVNode"])(ne,{uicontrol:"text",name:"access_token",title:"",modelValue:e.conversionExport.access_token,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.conversionExport.access_token=t}),maxlength:100,disabled:!0,placeholder:e.translate("AdvertisingConversionExport_FieldAccessTokenPlaceholder"),"inline-help":e.accessTokenInlineHelp},null,8,["modelValue","placeholder","inline-help"])]),Object(i["createElementVNode"])("div",x,[Object(i["createElementVNode"])("div",E,[Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_AttributionSettings")),1)])]),Object(i["createElementVNode"])("div",f,[Object(i["createVNode"])(ne,{uicontrol:"checkbox",name:"directAttribution","model-value":e.conversionExport.parameters.onlyDirectAttribution,"onUpdate:modelValue":t[5]||(t[5]=function(t){e.conversionExport.parameters.onlyDirectAttribution=t,e.setValueHasChanged()}),title:e.translate("AdvertisingConversionExport_DirectAttributionOnly"),tabindex:23,"inline-help":e.directAttributionHelp},null,8,["model-value","title","inline-help"])]),Object(i["createElementVNode"])("div",h,[Object(i["withDirectives"])(Object(i["createVNode"])(ne,{uicontrol:"number",name:"daysToLookBack","model-value":e.conversionExport.parameters.daysToLookBack,"onUpdate:modelValue":t[6]||(t[6]=function(t){e.conversionExport.parameters.daysToLookBack=t,e.setValueHasChanged()}),title:e.translate("AdvertisingConversionExport_DaysToLookBack"),min:1,max:365,"default-value":30,tabindex:24,"inline-help":e.translate("AdvertisingConversionExport_DaysToLookBackDescription")},null,8,["model-value","title","inline-help"]),[[i["vShow"],!e.conversionExport.parameters.onlyDirectAttribution||"0"===e.conversionExport.parameters.onlyDirectAttribution]])]),Object(i["createElementVNode"])("div",g,[Object(i["withDirectives"])(Object(i["createVNode"])(ne,{uicontrol:"radio",name:"clickIdAttribution","model-value":e.conversionExport.parameters.clickIdAttribution,"onUpdate:modelValue":t[7]||(t[7]=function(t){e.conversionExport.parameters.clickIdAttribution=t,e.setValueHasChanged()}),title:e.translate("AdvertisingConversionExport_ClickIdAttribution"),tabindex:25,options:e.clickIdAttributionOptions,"inline-help":e.translate("AdvertisingConversionExport_ClickIdAttributionDescription")},null,8,["model-value","title","options","inline-help"]),[[i["vShow"],!e.conversionExport.parameters.onlyDirectAttribution||"0"===e.conversionExport.parameters.onlyDirectAttribution]])]),Object(i["createElementVNode"])("div",O,[Object(i["withDirectives"])(Object(i["createVNode"])(ne,{uicontrol:"checkbox",name:"externalAttributedConversion","model-value":e.conversionExport.parameters.externalAttributedConversion,"onUpdate:modelValue":t[8]||(t[8]=function(t){e.conversionExport.parameters.externalAttributedConversion=t,e.setValueHasChanged()}),title:"External attributed conversion",tabindex:26,"inline-help":e.translate("AdvertisingConversionExport_ExternalAttributedConversionHelp")},null,8,["model-value","inline-help"]),[[i["vShow"],"GoogleAds"===e.conversionExport.type]])]),Object(i["createElementVNode"])("div",j,[Object(i["withDirectives"])(Object(i["createVNode"])(ne,{uicontrol:"select",name:"attributionModel","model-value":e.conversionExport.parameters.attributionModel,"onUpdate:modelValue":t[9]||(t[9]=function(t){e.conversionExport.parameters.attributionModel=t,e.setValueHasChanged()}),title:"Attribution Model",options:e.attributionModelOptions,tabindex:27,"inline-help":e.translate("AdvertisingConversionExport_AttributionModelHelp")},null,8,["model-value","options","inline-help"]),[[i["vShow"],"GoogleAds"===e.conversionExport.type&&e.conversionExport.parameters.externalAttributedConversion&&"0"!==e.conversionExport.parameters.externalAttributedConversion]])]),Object(i["createElementVNode"])("div",y,[Object(i["withDirectives"])(Object(i["createVNode"])(ne,{uicontrol:"number",name:"attributedCredit","model-value":e.conversionExport.parameters.attributedCredit,"onUpdate:modelValue":t[10]||(t[10]=function(t){e.conversionExport.parameters.attributedCredit=t,e.setValueHasChanged()}),title:"Attributed Credit",tabindex:28,min:0,max:1,"inline-help":e.translate("AdvertisingConversionExport_AttributedCreditHelp")},null,8,["model-value","inline-help"]),[[i["vShow"],"GoogleAds"===e.conversionExport.type&&e.conversionExport.parameters.externalAttributedConversion&&"0"!==e.conversionExport.parameters.externalAttributedConversion]])]),Object(i["createElementVNode"])("div",C,[Object(i["createElementVNode"])("div",N,[Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_VisitorsToExport")),1)])]),Object(i["createElementVNode"])("div",A,[Object(i["createElementVNode"])("div",V,[Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("AdvertisingConversionExport_VisitorsToExportHelp"))},null,8,k)])])]),Object(i["createElementVNode"])("div",S,[Object(i["createVNode"])(ne,{uicontrol:"number",name:"daysToExport","model-value":e.conversionExport.parameters.daysToExport,"onUpdate:modelValue":t[11]||(t[11]=function(t){e.conversionExport.parameters.daysToExport=t,e.setValueHasChanged()}),title:e.translate("AdvertisingConversionExport_DaysToExport"),min:1,max:100,"default-value":7,tabindex:35,"inline-help":e.translate("AdvertisingConversionExport_DaysToExportHelp")},null,8,["model-value","title","inline-help"])]),Object(i["createElementVNode"])("div",w,[Object(i["createElementVNode"])("div",_,[Object(i["createElementVNode"])("label",{innerHTML:e.$sanitize(e.translate("AdvertisingConversionExport_AdditionalSegment"))},null,8,D),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(re,{tabindex:"36","model-value":e.conversionExport.parameters.segment,"onUpdate:modelValue":t[12]||(t[12]=function(t){e.conversionExport.parameters.segment=t,e.setValueHasChanged()}),"visit-segments-only":!0},null,8,["model-value"])])])]),Object(i["createElementVNode"])("div",T,[Object(i["createElementVNode"])("div",M,[Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_ConversionsToExport")),1)])]),Object(i["createElementVNode"])("div",G,[Object(i["createElementVNode"])("div",L,[Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("AdvertisingConversionExport_ConversionsToExportHelp"))},null,8,B)])])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",U,[H,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[i["vShow"],e.isLoadingGoals]]),e.goals.length||e.isLoadingGoals?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(ie,{key:0,severity:"warning"},{default:Object(i["withCtx"])((function(){return[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_NoGoalsConfigured")),1)]})),_:1})),e.goals.length&&!e.isLoadingGoals?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",I,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.conversionExport.parameters.goals,(function(o,n){var r,a;return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:Object(i["normalizeClass"])("exportGoals ".concat(n," valign-wrapper")),key:n},[Object(i["createElementVNode"])("div",P,[Object(i["createElementVNode"])("div",q,[Object(i["createElementVNode"])("div",{name:"exportGoalId".concat(n)},[Object(i["createVNode"])(ne,{uicontrol:"select","model-value":o.idgoal,"onUpdate:modelValue":function(t){o.idgoal=t,e.setValueHasChanged()},title:e.translate("General_Goal"),name:"exportGoalId".concat(n),"full-width":!0,options:e.goals,tabindex:37+4*n},null,8,["model-value","onUpdate:modelValue","title","name","options","tabindex"])],8,R)]),Object(i["createElementVNode"])("div",F,[Object(i["createElementVNode"])("div",{name:"exportGoalName".concat(n)},[Object(i["createVNode"])(ne,{uicontrol:"text","model-value":o.name,"onUpdate:modelValue":function(t){o.name=t,e.setValueHasChanged()},title:e.translate("AdvertisingConversionExport_GoalAlias"),name:"exportGoalName".concat(n),"full-width":!0,maxlength:50,tabindex:38+4*n},null,8,["model-value","onUpdate:modelValue","title","name","tabindex"])],8,$)]),Object(i["createElementVNode"])("div",W,[Object(i["createElementVNode"])("div",z,[Object(i["createElementVNode"])("div",{name:"exportGoalRevenue".concat(n),class:Object(i["normalizeClass"])("col s12 ".concat("custom"===o.revenue?"m6":"m12"))},[Object(i["createVNode"])(ne,{uicontrol:"select","model-value":o.revenue,"onUpdate:modelValue":function(t){o.revenue=t,e.setValueHasChanged()},title:e.translate("General_ColumnRevenue"),name:"exportGoalRevenue".concat(n),class:Object(i["normalizeClass"])({custom:"custom"===o.revenue}),"full-width":!0,options:e.revenueOptions,tabindex:39+4*n},null,8,["model-value","onUpdate:modelValue","title","name","class","options","tabindex"])],10,Y),Object(i["createElementVNode"])("div",{name:"exportGoalRevenueCustom".concat(n),class:"col s12 m6"},["custom"===o.revenue?(Object(i["openBlock"])(),Object(i["createBlock"])(ne,{key:0,uicontrol:"number","model-value":o.revenueValue,"onUpdate:modelValue":function(t){o.revenueValue=t,e.setValueHasChanged()},title:e.translate("General_Value"),name:"exportGoalRevenueCustom".concat(n),"full-width":!0,tabindex:40+4*n},null,8,["model-value","onUpdate:modelValue","title","name","tabindex"])):Object(i["createCommentVNode"])("",!0)],8,X)])])]),Object(i["createElementVNode"])("div",null,[Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{class:"icon-plus",title:e.translate("General_Add"),onClick:t[13]||(t[13]=function(t){return e.addExportGoal()})},null,8,J),[[i["vShow"],(null===(r=e.conversionExport.parameters)||void 0===r?void 0:r.goals.length)<e.goals.length]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{class:"icon-minus",title:e.translate("General_Remove"),onClick:function(t){return e.removeExportGoal(n)}},null,8,K),[[i["vShow"],(null===(a=e.conversionExport.parameters)||void 0===a?void 0:a.goals.length)>1]])])],2)})),128))])):Object(i["createCommentVNode"])("",!0),e.showNoteMessage?(Object(i["openBlock"])(),Object(i["createBlock"])(ie,{key:2,severity:"info"},{default:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("strong",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_ExportNote"))+": ",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.noteMessage),1)]})),_:1})):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(ae,{class:"createButton",tabindex:"100",onConfirm:t[14]||(t[14]=function(t){return e.edit?e.updateExport():e.createExport()}),disabled:e.isUpdating||!e.isDirty||!e.goals.length,saving:e.isUpdating,value:e.createButtonText},null,8,["disabled","saving","value"]),Object(i["createElementVNode"])("div",Q,[Object(i["createElementVNode"])("a",{onClick:t[15]||(t[15]=function(t){return e.cancel()})},Object(i["toDisplayString"])(e.translate("General_Cancel")),1)])])],32),Object(i["createElementVNode"])("div",Z,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_RegenerateAccessTokenConfirm")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,ee),Object(i["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,te)],512)]})),_:1},8,["content-title"])}var ne=o("19dc"),re=o("a5a2"),ie=o("f06f");function ae(e,t){return ce(e)||se(e,t)||ue(e,t)||le()}function le(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function se(e,t){var o=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done);a=!0)if(i.push(n.value),t&&i.length===t)break}catch(s){l=!0,r=s}finally{try{a||null==o["return"]||o["return"]()}finally{if(l)throw r}}return i}}function ce(e){if(Array.isArray(e))return e}function de(e){return me(e)||ve(e)||ue(e)||pe()}function pe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ue(e,t){if(e){if("string"===typeof e)return be(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?be(e,t):void 0}}function ve(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function me(e){if(Array.isArray(e))return be(e)}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ee(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fe(e,t,o){return t&&Ee(e.prototype,t),o&&Ee(e,o),e}function he(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */var ge=function(){function e(){var t=this;xe(this,e),he(this,"privateState",Object(i["reactive"])({exports:[],sites:[],goals:[],isLoading:!1,isLoadingGoals:!1,isUpdating:!1})),he(this,"state",Object(i["computed"])((function(){return Object(i["readonly"])(t.privateState)}))),he(this,"exports",Object(i["computed"])((function(){return t.state.value.exports}))),he(this,"isEcommerceSite",Object(i["computed"])((function(){var e=t.state.value.sites.find((function(e){return parseInt(e.idsite,10)===parseInt(ne["Matomo"].idSite,10)})),o=null===e||void 0===e?void 0:e.ecommerce;return 1===o||"1"===o}))),he(this,"goals",Object(i["computed"])((function(){var e=[];return t.isEcommerceSite.value&&e.push({key:"0",value:Object(ne["translate"])("General_EcommerceOrders")}),Object(i["readonly"])([].concat(e,de(t.state.value.goals)))}))),he(this,"fetchPromise",null),he(this,"fetchSitePromise",null)}return fe(e,[{key:"reload",value:function(){return this.privateState.exports=[],this.fetchPromise=null,this.fetchExports()}},{key:"fetchExports",value:function(){var e=this;return this.fetchPromise||(this.fetchPromise=ne["AjaxHelper"].fetch({method:"AdvertisingConversionExport.getConversionExports",idSite:ne["Matomo"].idSite,filter_limit:"-1"})),this.privateState.isLoading=!0,this.privateState.exports=[],Promise.all([this.fetchPromise,this.fetchSites(),this.fetchGoals()]).then((function(t){var o=ae(t,1),n=o[0];return e.privateState.exports=n,e.exports.value})).finally((function(){e.privateState.isLoading=!1}))}},{key:"fetchGoals",value:function(){var e=this;return this.state.value.goals.length?Promise.resolve(this.state.value.goals):(this.privateState.isLoadingGoals=!0,ne["AjaxHelper"].fetch({module:"API",method:"Goals.getGoals",idSite:ne["Matomo"].idSite,filter_limit:"-1"}).then((function(t){return e.privateState.goals=Object.values(t).map((function(e){return{key:"".concat(e.idgoal),value:e.name}})),e.goals.value})).finally((function(){e.privateState.isLoadingGoals=!1})))}},{key:"fetchSites",value:function(){var e=this;return this.state.value.sites.length?Promise.resolve(this.state.value.sites):(this.fetchSitePromise||(this.fetchSitePromise=ne["AjaxHelper"].fetch({module:"API",method:"SitesManager.getSitesWithAtLeastViewAccess",filter_limit:"-1"})),this.fetchSitePromise.then((function(t){return e.privateState.sites=t||[],e.state.value.sites})))}},{key:"findExport",value:function(e){var t=this,o=this.state.value.exports.find((function(t){return parseInt("".concat(t.idexport),10)===e}));return o?Promise.resolve(o):(this.privateState.isLoading=!0,Promise.all([ne["AjaxHelper"].fetch({idExport:e,method:"AdvertisingConversionExport.getConversionExport"}),this.fetchSites()]).then((function(e){var t=ae(e,1),o=t[0];return Object(i["readonly"])(o)})).finally((function(){t.privateState.isLoading=!1})))}},{key:"deleteExport",value:function(e){var t=this;return this.privateState.isUpdating=!0,this.privateState.exports=[],ne["AjaxHelper"].fetch({idExport:e,method:"AdvertisingConversionExport.deleteConversionExport"},{withTokenInUrl:!0}).then((function(){return{type:"success"}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){t.privateState.isUpdating=!1}))}},{key:"regenerateAccessToken",value:function(e){var t=this;return this.privateState.isUpdating=!0,this.privateState.exports=[],ne["AjaxHelper"].fetch({idExport:e,method:"AdvertisingConversionExport.regenerateAccessToken"},{withTokenInUrl:!0}).finally((function(){t.privateState.isUpdating=!1}))}},{key:"createOrUpdateExport",value:function(e,t){var o,n,r,i,a,l=this;this.privateState.isUpdating=!0;var s=[!0,"true",1,"1"].includes(null!==(o=null===(n=e.parameters)||void 0===n?void 0:n.onlyDirectAttribution)&&void 0!==o&&o)?1:0,c=[!0,"true",1,"1"].includes(null!==(r=null===(i=e.parameters)||void 0===i?void 0:i.externalAttributedConversion)&&void 0!==r&&r)?1:0;return ne["AjaxHelper"].post({},{idExport:e.idexport,name:e.name.trim(),type:e.type,description:e.description.trim(),method:t,parameters:Object.assign(Object.assign({},e.parameters||{}),{},{onlyDirectAttribution:s,externalAttributedConversion:c,goals:((null===(a=e.parameters)||void 0===a?void 0:a.goals)||[]).filter((function(e){return""!==e.idgoal&&e.idgoal>=0}))})},{withTokenInUrl:!0}).then((function(e){return{type:"success",response:e}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){l.privateState.isUpdating=!1}))}}]),e}(),Oe=new ge;function je(e){return Ae(e)||Ne(e)||Ce(e)||ye()}function ye(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ce(e,t){if(e){if("string"===typeof e)return Ve(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Ve(e,t):void 0}}function Ne(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ae(e){if(Array.isArray(e))return Ve(e)}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var ke=0,Se="dataDriven",we=1,_e="conversionexportmanagement",De={goal:Object(ne["translate"])("AdvertisingConversionExport_UseGoalRevenue"),custom:Object(ne["translate"])("AdvertisingConversionExport_UseCustomRevenue"),null:Object(ne["translate"])("AdvertisingConversionExport_UseEmptyRevenue")},Te={first:Object(ne["translate"])("AdvertisingConversionExport_FirstClickId"),last:Object(ne["translate"])("AdvertisingConversionExport_LastClickId"),all:Object(ne["translate"])("AdvertisingConversionExport_AllClickIds")},Me=Object(i["defineComponent"])({props:{idExport:Number,exportTypes:{type:Object,required:!0},alreadyCreatedExportTypes:{type:Object,required:!0},clickIdProviders:{type:Object,required:!0},attributionModels:{type:Object,required:!0}},components:{ContentBlock:ne["ContentBlock"],Field:re["Field"],SegmentGenerator:ie["SegmentGenerator"],Alert:ne["Alert"],SaveButton:re["SaveButton"]},data:function(){return{isDirty:!1,conversionExport:{},showNoteMessage:!1,noteMessage:"test"}},created:function(){Oe.fetchExports(),this.init()},watch:{idExport:function(e){null!==e&&this.init()}},methods:{removeAnyNotification:function(){ne["NotificationsStore"].remove(_e),ne["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){this.removeAnyNotification();var o=ne["NotificationsStore"].show({message:e,context:t,id:_e,type:"transient"});setTimeout((function(){ne["NotificationsStore"].scrollToNotification(o)}),100)},showErrorFieldNotProvidedNotification:function(e){var t=Object(ne["translate"])("AdvertisingConversionExport_ErrorXNotProvided",[e]);this.showNotification(t,"error")},init:function(){var e=this,t=this.idExport;this.conversionExport={parameters:{}},ne["Matomo"].helper.lazyScrollToContent(),this.edit&&t?Oe.findExport(t).then((function(t){if("".concat(null===t||void 0===t?void 0:t.idsite)!=="".concat(ne["Matomo"].idSite))return setTimeout((function(){e.showNotification(Object(ne["translate"])("AdvertisingConversionExport_UnableToLoadExport"),"error")}),200),void e.cancel();if(e.conversionExport=Object(ne["clone"])(t),e.conversionExport.parameters){var o,n,r,i=e.conversionExport.parameters;i.externalAttributedConversion=null!==(o=i.externalAttributedConversion)&&void 0!==o?o:ke,i.attributionModel=null!==(n=i.attributionModel)&&void 0!==n?n:Se,i.attributedCredit=null!==(r=i.attributedCredit)&&void 0!==r?r:we}Oe.fetchGoals().then((function(){e.isDirty=!1,e.addInitialExportGoal()}))})):this.create&&(this.conversionExport={idsite:ne["Matomo"].idSite,name:"",type:Object.keys(this.exportTypeOptions)[0],description:"",access_token:"",parameters:{goals:[],daysToExport:7,segment:"",onlyDirectAttribution:1,daysToLookBack:30,clickIdAttribution:"last",externalAttributedConversion:ke,attributionModel:Se,attributedCredit:we}},this.isDirty=!1,Oe.fetchGoals().then((function(){e.addInitialExportGoal()})),this.showNote())},cancel:function(){var e=Object.assign({},ne["MatomoUrl"].hashParsed.value);delete e.idExport,ne["MatomoUrl"].updateHash(e)},addInitialExportGoal:function(){var e,t;this.conversionExport&&(null!==(e=this.conversionExport.parameters)&&void 0!==e&&null!==(t=e.goals)&&void 0!==t&&t.length||this.addExportGoal())},addExportGoal:function(){var e;this.conversionExport&&(this.conversionExport.parameters||(this.conversionExport.parameters={}),null!==(e=this.conversionExport.parameters.goals)&&void 0!==e&&e.length||(this.conversionExport.parameters.goals=[]),this.conversionExport.parameters.goals=[].concat(je(this.conversionExport.parameters.goals),[{idgoal:"",name:"",revenue:"goal"}]),this.isDirty=!0)},removeExportGoal:function(e){var t,o,n;null!==(t=this.conversionExport)&&void 0!==t&&null!==(o=t.parameters)&&void 0!==o&&null!==(n=o.goals)&&void 0!==n&&n.length&&e>-1&&(this.conversionExport.parameters.goals.splice(e,1),this.isDirty=!0)},regenerateAccessToken:function(){var e=this,t=this.idExport;t&&ne["Matomo"].helper.modalConfirm(this.$refs.confirmRegenerateAccessToken,{yes:function(){Oe.regenerateAccessToken(t).then((function(t){e.conversionExport.access_token=t.value}))}})},createExport:function(){var e=this,t="AdvertisingConversionExport.addConversionExport";this.removeAnyNotification(),this.checkRequiredFieldsAreSet()&&Oe.createOrUpdateExport(this.conversionExport,t).then((function(t){e.isDirty=!1;var o=t.response.value;Oe.reload().then((function(){ne["Matomo"].helper.isReportingPage()&&ne["Matomo"].postEvent("updateReportingMenu"),ne["MatomoUrl"].updateHash(Object.assign(Object.assign({},ne["MatomoUrl"].hashParsed.value),{},{idExport:o})),setTimeout((function(){e.showNotification(Object(ne["translate"])("AdvertisingConversionExport_ExportCreated"),t.type)}),200)}))}))},setValueHasChanged:function(){var e,t,o;if(this.isDirty=!0,null!==(e=this.conversionExport)&&void 0!==e&&null!==(t=e.parameters)&&void 0!==t&&null!==(o=t.goals)&&void 0!==o&&o.length){var n=[];this.conversionExport.parameters.goals.forEach((function(e){n.indexOf(e.idgoal)>=0&&(e.idgoal=null),(e.idgoal||0===e.idgoal)&&n.push(e.idgoal)}))}},showNote:function(){var e,t,o;this.showNoteMessage=!1,this.noteMessage="",null===(e=this.conversionExport)||void 0===e||!e.type||null!==(t=this.alreadyCreatedExportTypes)&&void 0!==t&&t[this.conversionExport.type]||null===(o=this.clickIdProviders)||void 0===o||!o[this.conversionExport.type]||(this.showNoteMessage=!0,this.noteMessage=Object(ne["translate"])("AdvertisingConversionExport_ExportNoteMessage",this.clickIdProviders[this.conversionExport.type].clickId,this.clickIdProviders[this.conversionExport.type].name))},updateExport:function(){var e=this;if(this.removeAnyNotification(),this.checkRequiredFieldsAreSet()){var t="AdvertisingConversionExport.updateConversionExport";Oe.createOrUpdateExport(this.conversionExport,t).then((function(t){"error"!==t.type&&(e.isDirty=!1,e.conversionExport={parameters:{}},Oe.reload().then((function(){e.init()})),e.showNotification(Object(ne["translate"])("AdvertisingConversionExport_ExportUpdated"),t.type))}))}},checkRequiredFieldsAreSet:function(){var e,t;if(!this.conversionExport.name){var o=Object(ne["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(o),!1}if(null===(e=this.conversionExport.parameters)||void 0===e||null===(t=e.goals)||void 0===t||!t.length){var n=Object(ne["translate"])("AdvertisingConversionExport_PleaseConfigureGoals");return this.showNotification(n,"error"),!1}var r=this.conversionExport.parameters.goals.some((function(e){return""!==e.idgoal&&e.idgoal>=0}));if(!r){var i=Object(ne["translate"])("AdvertisingConversionExport_PleaseConfigureGoals");return this.showNotification(i,"error"),!1}if(!this.conversionExport.parameters.daysToExport||"NaN"===this.conversionExport.parameters.daysToExport||this.conversionExport.parameters.daysToExport<1){var a=Object(ne["translate"])("AdvertisingConversionExport_PleaseConfigureDaysToExport");return this.showNotification(a,"error"),!1}return!0}},computed:{revenueOptions:function(){return De},clickIdAttributionOptions:function(){return Te},exportTypeOptions:function(){var e={};return Object.values(this.exportTypes).forEach((function(t){e[t.id]=t.name})),e},exportTypeDescription:function(){return Object.values(this.exportTypes).map((function(e){return"<br/><br/><strong>".concat(e.name,"</strong><br />").concat(e.description)})).join("")},attributionModelOptions:function(){var e={};return Object.values(this.attributionModels).forEach((function(t){e[t.id]=t.translatedName})),e},create:function(){return!this.idExport},edit:function(){return!this.create},editTitle:function(){return this.create?"AdvertisingConversionExport_CreateNewExport":"AdvertisingConversionExport_EditExport"},contentTitle:function(){return Object(ne["translate"])(this.editTitle,this.conversionExport.name?'"'.concat(this.conversionExport.name,'"'):"")},isLoading:function(){return Oe.state.value.isLoading},isUpdating:function(){return Oe.state.value.isUpdating},isLoadingGoals:function(){return Oe.state.value.isLoadingGoals},goals:function(){return Oe.goals.value},conversionExportHelp:function(){var e=Object(ne["translate"])("AdvertisingConversionExport_ExportTypeHelp");return"".concat(e).concat(this.exportTypeDescription)},accessTokenInlineHelp:function(){var e=Object(ne["translate"])("AdvertisingConversionExport_AccessTokenHelp"),t=Object(ne["translate"])("AdvertisingConversionExport_DoNotShare");return"".concat(e,"<br />").concat(t)},directAttributionHelp:function(){var e=Object(ne["translate"])("AdvertisingConversionExport_DirectAttributionOnlyDescription"),t=Object(ne["translate"])("AdvertisingConversionExport_DirectAttributionOnlyNote");return"".concat(e,"<br /><br />").concat(t)},createButtonText:function(){return this.edit?Object(ne["translate"])("CoreUpdater_UpdateTitle"):Object(ne["translate"])("AdvertisingConversionExport_CreateNewExport")}}});Me.render=oe;var Ge=Me,Le={class:"index"},Be={class:"name"},Ue={class:"type"},He={key:0,class:"description"},Ie={class:"goals"},Pe=["title"],qe={class:"action"},Re={colspan:"6"},Fe={class:"loadingPiwik"},$e=Object(i["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),We={colspan:"6"},ze=["id"],Ye={class:"index"},Xe={class:"name"},Je={class:"type"},Ke=["title"],Qe=["title"],Ze={class:"goals"},et=["innerHTML"],tt=Object(i["createElementVNode"])("br",null,null,-1),ot={key:2,class:"requested"},nt={key:3,class:"requested"},rt={class:"action"},it=["title","onClick"],at=["title","onClick"],lt=["title","onClick"],st=["title","onClick"],ct={class:"tableActionBar"},dt=Object(i["createElementVNode"])("span",{class:"icon-add"},null,-1),pt={class:"ui-confirm",id:"confirmDeleteExport",ref:"confirmDeleteExport"},ut=["value"],vt=["value"],mt={class:"ui-confirm",id:"showExportLink",ref:"showExportLink"},bt=["value"],xt=["value"];function Et(e,t,o,n,r,a){var l=Object(i["resolveComponent"])("ContentBlock"),s=Object(i["resolveDirective"])("content-table");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createVNode"])(l,{"content-title":e.translate("AdvertisingConversionExport_ManageExports"),feature:e.translate("AdvertisingConversionExport_ManageExports")},{default:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_ManageExportsIntroduction")),1),Object(i["withDirectives"])(Object(i["createElementVNode"])("table",null,[Object(i["createElementVNode"])("thead",null,[Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("th",Le,Object(i["toDisplayString"])(e.translate("General_Id")),1),Object(i["createElementVNode"])("th",Be,Object(i["toDisplayString"])(e.translate("General_Name")),1),Object(i["createElementVNode"])("th",Ue,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_ExportType")),1),e.atLeastOneExportWithDescription?(Object(i["openBlock"])(),Object(i["createElementBlock"])("th",He,Object(i["toDisplayString"])(e.translate("General_Description")),1)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("th",Ie,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_IncludedConversions")),1),Object(i["createElementVNode"])("th",{class:"requested",title:e.translate("AdvertisingConversionExport_LastRequestedInfo")},Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_LastRequested")),9,Pe),Object(i["createElementVNode"])("th",qe,Object(i["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(i["createElementVNode"])("tbody",null,[Object(i["withDirectives"])(Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("td",Re,[Object(i["createElementVNode"])("span",Fe,[$e,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[i["vShow"],e.isLoading||e.isUpdating]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("td",We,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_NoExportsFound")),1)],512),[[i["vShow"],!e.isLoading&&0===e.exports.length]]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.sortedExports,(function(t){var o;return Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",{id:"export".concat(t.idexport),class:"exports",key:t.idexport},[Object(i["createElementVNode"])("td",Ye,Object(i["toDisplayString"])(t.idexport),1),Object(i["createElementVNode"])("td",Xe,Object(i["toDisplayString"])(t.name),1),Object(i["createElementVNode"])("td",Je,Object(i["toDisplayString"])(e.exportTypes[t.type].name),1),e.atLeastOneExportWithDescription&&t.description.trim().length>63?(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",{key:0,class:"description",title:t.description},Object(i["toDisplayString"])(t.description.trim().substring(0,60))+"...",9,Ke)):Object(i["createCommentVNode"])("",!0),e.atLeastOneExportWithDescription&&t.description.trim().length<=63?(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",{key:1,class:"description",title:t.description},Object(i["toDisplayString"])(t.description.trim()),9,Qe)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("td",Ze,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])((null===(o=t.parameters)||void 0===o?void 0:o.goals)||[],(function(t){var o;return Object(i["openBlock"])(),Object(i["createElementBlock"])("span",{key:t.idgoal},[Object(i["createTextVNode"])(Object(i["toDisplayString"])((null===(o=e.goals.find((function(e){return e.key==="".concat(t.idgoal)})))||void 0===o?void 0:o.value)||e.translate("General_Unknown"))+" ",1),Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.getDisplayGoalName(t))},null,8,et),tt])})),128))]),t.ts_requested?(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",ot,Object(i["toDisplayString"])(t.ts_requested_pretty),1)):Object(i["createCommentVNode"])("",!0),t.ts_requested?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",nt,Object(i["toDisplayString"])(e.translate("General_Never")),1)),Object(i["createElementVNode"])("td",rt,[Object(i["createElementVNode"])("a",{class:"table-action icon-download",title:e.translate("AdvertisingConversionExport_DownloadExport"),onClick:function(o){return e.openExport(t.access_token)}},null,8,it),Object(i["createElementVNode"])("a",{class:"table-action icon-export",title:e.translate("AdvertisingConversionExport_ShowDownloadLink"),onClick:function(o){return e.showLink(t.access_token)}},null,8,at),Object(i["createElementVNode"])("a",{class:"table-action icon-edit",title:e.translate("AdvertisingConversionExport_EditExport"),onClick:function(o){return e.editExport(t.idexport)}},null,8,lt),Object(i["createElementVNode"])("a",{class:"table-action icon-delete",title:e.translate("AdvertisingConversionExport_DeleteExport"),onClick:function(o){return e.deleteExport(t)}},null,8,st)])],8,ze)})),128))])],512),[[s]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",ct,[Object(i["createElementVNode"])("a",{class:"createNewExport",onClick:t[0]||(t[0]=function(t){return e.createExport()})},[dt,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_CreateNewExport")),1)])],512),[[i["vShow"],e.hasWriteAccess]])]})),_:1},8,["content-title","feature"]),Object(i["createElementVNode"])("div",pt,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_DeleteExportConfirm")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,ut),Object(i["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,vt)],512),Object(i["createElementVNode"])("div",mt,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_DownloadLink")),1),Object(i["createElementVNode"])("textarea",{readonly:"",id:"exportLink",onclick:"this.select()",value:e.exportLink},null,8,bt),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_DoNotShare"))+" ",1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Close")},null,8,xt)],512)])}function ft(e){return jt(e)||Ot(e)||gt(e)||ht()}function ht(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function gt(e,t){if(e){if("string"===typeof e)return yt(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?yt(e,t):void 0}}function Ot(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function jt(e){if(Array.isArray(e))return yt(e)}function yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var Ct=Object(i["defineComponent"])({props:{exportTypes:{type:Object,required:!0},alreadyCreatedExportTypes:{type:Object,required:!0},clickIdProviders:{type:Object,required:!0},hasWriteAccess:Boolean},components:{ContentBlock:ne["ContentBlock"]},directives:{ContentTable:ne["ContentTable"]},data:function(){return{exportLink:""}},created:function(){Oe.fetchExports()},methods:{getDisplayGoalName:function(e){return e.name?"(&#x279C;&nbsp;".concat(ne["Matomo"].helper.htmlEntities(e.name),")"):""},getDownloadLink:function(e){var t=ne["MatomoUrl"].stringify({module:"AdvertisingConversionExport",action:"generateConversionExport",accessToken:e});return"".concat(window.location.origin).concat(window.location.pathname,"?").concat(t)},createExport:function(){this.editExport(0)},editExport:function(e){ne["MatomoUrl"].updateHash(Object.assign(Object.assign({},ne["MatomoUrl"].hashParsed.value),{},{idExport:e}))},openExport:function(e){window.open(this.getDownloadLink(e))},showLink:function(e){this.exportLink=this.getDownloadLink(e),ne["Matomo"].helper.modalConfirm(this.$refs.showExportLink)},deleteExport:function(e){ne["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteExport,{yes:function(){Oe.deleteExport(parseInt(e.idexport,10)).then((function(){Oe.reload()}))}})}},computed:{atLeastOneExportWithDescription:function(){return Oe.exports.value.filter((function(e){return!!e.description})).length},isLoading:function(){return Oe.state.value.isLoading},isUpdating:function(){return Oe.state.value.isUpdating},exports:function(){return Oe.exports.value},sortedExports:function(){var e=ft(this.exports);return e.sort((function(e,t){return parseInt("".concat(e.idexport),10)-parseInt("".concat(t.idexport),10)})),e},goals:function(){return Oe.goals.value||[]}}});Ct.render=Et;var Nt=Ct,At={class:"manageConversionExport"},Vt={key:0},kt={key:1};function St(e,t,o,n,r,a){var l=Object(i["resolveComponent"])("ConversionExportList"),s=Object(i["resolveComponent"])("ConversionExportEdit");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",At,[e.editMode?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Vt,[Object(i["createVNode"])(l,{"export-types":e.exportTypes,"already-created-export-types":e.alreadyCreatedExportTypes,"click-id-providers":e.clickIdProviders,"attribution-models":e.attributionModels,"has-write-access":e.hasWriteAccess},null,8,["export-types","already-created-export-types","click-id-providers","attribution-models","has-write-access"])])),e.editMode?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",kt,[Object(i["createVNode"])(s,{"id-export":e.idExport,"export-types":e.exportTypes,"already-created-export-types":e.alreadyCreatedExportTypes,"click-id-providers":e.clickIdProviders,"attribution-models":e.attributionModels},null,8,["id-export","export-types","already-created-export-types","click-id-providers","attribution-models"])])):Object(i["createCommentVNode"])("",!0)])}var wt=Object(i["defineComponent"])({props:{exportTypes:{type:Object,required:!0},alreadyCreatedExportTypes:{type:Object,required:!0},clickIdProviders:{type:Object,required:!0},attributionModels:{type:Object,required:!0},hasWriteAccess:Boolean},components:{ConversionExportEdit:Ge,ConversionExportList:Nt},data:function(){return{editMode:!1,idExport:null}},created:function(){var e=this;Object(i["watch"])((function(){return ne["MatomoUrl"].hashParsed.value.idExport}),(function(t){e.initState(t)})),this.initState(ne["MatomoUrl"].hashParsed.value.idExport)},methods:{removeAnyNotification:function(){ne["NotificationsStore"].remove("conversionexportmanagement")},initState:function(e){if(e){if("0"===e){var t={isAllowed:!0};if(ne["Matomo"].postEvent("AdvertisingConversionExport.initAddExport",t),t&&!t.isAllowed)return this.editMode=!1,void(this.idExport=null)}this.editMode=!0,this.idExport=parseInt(e,10)}else this.editMode=!1,this.idExport=null;this.removeAnyNotification()}}});wt.render=St;var _t=wt;
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */}})}));
//# sourceMappingURL=AdvertisingConversionExport.umd.min.js.map