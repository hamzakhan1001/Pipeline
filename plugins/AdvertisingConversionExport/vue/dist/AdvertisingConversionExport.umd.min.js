(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin"),require("SegmentEditor")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin","SegmentEditor"],t):"object"===typeof exports?exports["AdvertisingConversionExport"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin"),require("SegmentEditor")):e["AdvertisingConversionExport"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"],e["SegmentEditor"])})("undefined"!==typeof self?self:this,(function(e,t,o,n){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="plugins/AdvertisingConversionExport/vue/dist/",o(o.s="fae3")}({"19dc":function(t,o){t.exports=e},"8bbf":function(e,o){e.exports=t},a5a2:function(e,t){e.exports=o},f06f:function(e,t){e.exports=n},fae3:function(e,t,o){"use strict";if(o.r(t),o.d(t,"ConversionExportEdit",(function(){return $e})),o.d(t,"ConversionExportList",(function(){return _t})),o.d(t,"ConversionExportManage",(function(){return Bt})),"undefined"!==typeof window){var n=window.document.currentScript,r=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(o.p=r[1])}var i=o("8bbf"),a={class:"loadingPiwik"},s=Object(i["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),l={class:"loadingPiwik"},c=Object(i["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),d={name:"name"},p={class:"row accesstokenhead"},u={class:"col s12"},v={key:0,class:"export-url-div form-group row matomo-form-field",id:"exportUrlDiv"},m={class:"col s12 m6"},b={class:"col s12 m6"},x={class:"form-help"},E=["innerHTML"],f={key:1,class:"export-url-div form-group row matomo-form-field",id:"exportUrlDiv"},h={class:"col s12 m6"},g=["textContent"],O={class:"col s12 m6"},j={class:"form-help"},y=["innerHTML"],C={name:"type"},N={name:"description"},A={class:"form-group row",style:{"margin-bottom":"0"}},V={class:"col s12"},k={name:"directAttribution"},S={name:"daysToLookBack"},w={name:"clickIdAttribution"},_={name:"externalAttributedConversion"},T={name:"attributionModel"},D={name:"attributedCredit"},M={class:"form-group row",style:{"margin-bottom":"0"}},U={class:"col s12"},G={class:"form-group row",style:{"margin-bottom":"0"}},B={class:"col s12"},L=["innerHTML"],H={name:"daysToExport"},I={class:"form-group row",style:{"margin-bottom":"0"}},P={class:"col s12"},q=["innerHTML"],R={class:"form-group row",style:{"margin-bottom":"0"}},F={class:"col s12"},$={class:"form-group row",style:{"margin-bottom":"0"}},W={class:"col s12"},z=["innerHTML"],Y={class:"loadingPiwik"},X=Object(i["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),K={key:3},J={class:"form-group row"},Q={class:"col s12 m4"},Z=["name"],ee={class:"col s12 m4"},te=["name"],oe={class:"col s12 m4"},ne={class:"row",style:{"margin-bottom":"0"}},re=["name"],ie=["name"],ae=["title"],se=["title","onClick"],le={class:"entityCancel"},ce={class:"ui-confirm",id:"confirmRegenerateAccessToken",ref:"confirmRegenerateAccessToken"},de=["value"],pe=["value"];function ue(e,t,o,n,r,ue){var ve=Object(i["resolveComponent"])("Field"),me=Object(i["resolveComponent"])("SegmentGenerator"),be=Object(i["resolveComponent"])("Alert"),xe=Object(i["resolveComponent"])("SaveButton"),Ee=Object(i["resolveComponent"])("ContentBlock"),fe=Object(i["resolveDirective"])("copy-to-clipboard");return Object(i["openBlock"])(),Object(i["createBlock"])(Ee,{class:"editConversionExport","content-title":e.contentTitle},{default:Object(i["withCtx"])((function(){return[Object(i["withDirectives"])(Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",a,[s,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[i["vShow"],e.isLoading]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",l,[c,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_UpdatingData")),1)])],512),[[i["vShow"],e.isUpdating]]),Object(i["createElementVNode"])("form",{onSubmit:t[15]||(t[15]=function(t){return e.edit?e.updateExport():e.createExport()})},[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("div",d,[Object(i["createVNode"])(ve,{uicontrol:"text",name:"name","model-value":e.conversionExport.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.conversionExport.name=t,e.setValueHasChanged()}),title:e.translate("General_Name"),maxlength:50,tabindex:21,placeholder:e.translate("AdvertisingConversionExport_FieldNamePlaceholder"),"inline-help":e.translate("AdvertisingConversionExport_ExportNameHelp")},null,8,["model-value","title","placeholder","inline-help"])]),Object(i["createElementVNode"])("div",p,[Object(i["createElementVNode"])("label",u,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_ExportURL"))+" ",1),Object(i["withDirectives"])(Object(i["createElementVNode"])("a",{onClick:t[1]||(t[1]=function(t){return e.regenerateAccessToken()})},"("+Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_Regenerate"))+")",513),[[i["vShow"],e.conversionExport.idexport]])])]),e.conversionExport.access_token?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",v,[Object(i["createElementVNode"])("div",m,[Object(i["createElementVNode"])("div",null,[Object(i["withDirectives"])(Object(i["createElementVNode"])("pre",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.showDownloadLink()),1)],512),[[fe,{}]])])]),Object(i["createElementVNode"])("div",b,[Object(i["createElementVNode"])("div",x,[Object(i["createElementVNode"])("span",{class:"inline-help",innerHTML:e.$sanitize(e.accessTokenInlineHelp)},null,8,E)])])])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",f,[Object(i["createElementVNode"])("div",h,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("pre",{textContent:Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_FieldExportURLPlaceholder"))},null,8,g)])]),Object(i["createElementVNode"])("div",O,[Object(i["createElementVNode"])("div",j,[Object(i["createElementVNode"])("span",{class:"inline-help",innerHTML:e.$sanitize(e.accessTokenInlineHelp)},null,8,y)])])])),Object(i["createElementVNode"])("div",C,[Object(i["createVNode"])(ve,{uicontrol:"radio",name:"type","model-value":e.conversionExport.type,"onUpdate:modelValue":t[2]||(t[2]=function(t){e.conversionExport.type=t,e.setValueHasChanged(),e.showNote()}),title:e.translate("AdvertisingConversionExport_ExportType"),tabindex:22,options:e.exportTypeOptions,"inline-help":e.conversionExportHelp},null,8,["model-value","title","options","inline-help"])]),Object(i["createElementVNode"])("div",N,[Object(i["createVNode"])(ve,{uicontrol:"textarea",name:"description","model-value":e.conversionExport.description,"onUpdate:modelValue":t[3]||(t[3]=function(t){e.conversionExport.description=t,e.setValueHasChanged()}),title:"".concat(e.translate("General_Description")," ").concat(e.translate("Goals_Optional")),maxlength:1e3,rows:3,tabindex:26,placeholder:e.translate("AdvertisingConversionExport_ExportDescriptionPlaceHolder"),"inline-help":e.translate("AdvertisingConversionExport_ExportDescriptionHelp")},null,8,["model-value","title","placeholder","inline-help"])]),Object(i["createElementVNode"])("div",A,[Object(i["createElementVNode"])("div",V,[Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_AttributionSettings")),1)])]),Object(i["createElementVNode"])("div",k,[Object(i["createVNode"])(ve,{uicontrol:"checkbox",name:"directAttribution","model-value":e.conversionExport.parameters.onlyDirectAttribution,"onUpdate:modelValue":t[4]||(t[4]=function(t){e.conversionExport.parameters.onlyDirectAttribution=t,e.setValueHasChanged()}),title:e.translate("AdvertisingConversionExport_DirectAttributionOnly"),tabindex:23,"inline-help":e.directAttributionHelp},null,8,["model-value","title","inline-help"])]),Object(i["createElementVNode"])("div",S,[Object(i["withDirectives"])(Object(i["createVNode"])(ve,{uicontrol:"number",name:"daysToLookBack","model-value":e.conversionExport.parameters.daysToLookBack,"onUpdate:modelValue":t[5]||(t[5]=function(t){e.conversionExport.parameters.daysToLookBack=t,e.setValueHasChanged()}),title:e.translate("AdvertisingConversionExport_DaysToLookBack"),min:1,max:365,"default-value":30,tabindex:24,"inline-help":e.translate("AdvertisingConversionExport_DaysToLookBackDescription")},null,8,["model-value","title","inline-help"]),[[i["vShow"],!e.conversionExport.parameters.onlyDirectAttribution||"0"===e.conversionExport.parameters.onlyDirectAttribution]])]),Object(i["createElementVNode"])("div",w,[Object(i["withDirectives"])(Object(i["createVNode"])(ve,{uicontrol:"radio",name:"clickIdAttribution","model-value":e.conversionExport.parameters.clickIdAttribution,"onUpdate:modelValue":t[6]||(t[6]=function(t){e.conversionExport.parameters.clickIdAttribution=t,e.setValueHasChanged()}),title:e.translate("AdvertisingConversionExport_ClickIdAttribution"),tabindex:25,options:e.clickIdAttributionOptions,"inline-help":e.translate("AdvertisingConversionExport_ClickIdAttributionDescription")},null,8,["model-value","title","options","inline-help"]),[[i["vShow"],!e.conversionExport.parameters.onlyDirectAttribution||"0"===e.conversionExport.parameters.onlyDirectAttribution]])]),Object(i["createElementVNode"])("div",_,[Object(i["withDirectives"])(Object(i["createVNode"])(ve,{uicontrol:"checkbox",name:"externalAttributedConversion","model-value":e.conversionExport.parameters.externalAttributedConversion,"onUpdate:modelValue":t[7]||(t[7]=function(t){e.conversionExport.parameters.externalAttributedConversion=t,e.setValueHasChanged()}),title:"External attributed conversion",tabindex:26,"inline-help":e.translate("AdvertisingConversionExport_ExternalAttributedConversionHelp")},null,8,["model-value","inline-help"]),[[i["vShow"],"GoogleAds"===e.conversionExport.type]])]),Object(i["createElementVNode"])("div",T,[Object(i["withDirectives"])(Object(i["createVNode"])(ve,{uicontrol:"select",name:"attributionModel","model-value":e.conversionExport.parameters.attributionModel,"onUpdate:modelValue":t[8]||(t[8]=function(t){e.conversionExport.parameters.attributionModel=t,e.setValueHasChanged()}),title:"Attribution Model",options:e.attributionModelOptions,tabindex:27,"inline-help":e.translate("AdvertisingConversionExport_AttributionModelHelp")},null,8,["model-value","options","inline-help"]),[[i["vShow"],"GoogleAds"===e.conversionExport.type&&e.conversionExport.parameters.externalAttributedConversion&&"0"!==e.conversionExport.parameters.externalAttributedConversion]])]),Object(i["createElementVNode"])("div",D,[Object(i["withDirectives"])(Object(i["createVNode"])(ve,{uicontrol:"number",name:"attributedCredit","model-value":e.conversionExport.parameters.attributedCredit,"onUpdate:modelValue":t[9]||(t[9]=function(t){e.conversionExport.parameters.attributedCredit=t,e.setValueHasChanged()}),title:"Attributed Credit",tabindex:28,min:0,max:1,"inline-help":e.translate("AdvertisingConversionExport_AttributedCreditHelp")},null,8,["model-value","inline-help"]),[[i["vShow"],"GoogleAds"===e.conversionExport.type&&e.conversionExport.parameters.externalAttributedConversion&&"0"!==e.conversionExport.parameters.externalAttributedConversion]])]),Object(i["createElementVNode"])("div",M,[Object(i["createElementVNode"])("div",U,[Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_VisitorsToExport")),1)])]),Object(i["createElementVNode"])("div",G,[Object(i["createElementVNode"])("div",B,[Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("AdvertisingConversionExport_VisitorsToExportHelp"))},null,8,L)])])]),Object(i["createElementVNode"])("div",H,[Object(i["createVNode"])(ve,{uicontrol:"number",name:"daysToExport","model-value":e.conversionExport.parameters.daysToExport,"onUpdate:modelValue":t[10]||(t[10]=function(t){e.conversionExport.parameters.daysToExport=t,e.setValueHasChanged()}),title:e.translate("AdvertisingConversionExport_DaysToExport"),min:1,max:100,"default-value":7,tabindex:35,"inline-help":e.translate("AdvertisingConversionExport_DaysToExportHelp")},null,8,["model-value","title","inline-help"])]),Object(i["createElementVNode"])("div",I,[Object(i["createElementVNode"])("div",P,[Object(i["createElementVNode"])("label",{innerHTML:e.$sanitize(e.translate("AdvertisingConversionExport_AdditionalSegment"))},null,8,q),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(me,{tabindex:"36","model-value":e.conversionExport.parameters.segment,"onUpdate:modelValue":t[11]||(t[11]=function(t){e.conversionExport.parameters.segment=t,e.setValueHasChanged()}),"visit-segments-only":!0},null,8,["model-value"])])])]),Object(i["createElementVNode"])("div",R,[Object(i["createElementVNode"])("div",F,[Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_ConversionsToExport")),1)])]),Object(i["createElementVNode"])("div",$,[Object(i["createElementVNode"])("div",W,[Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("AdvertisingConversionExport_ConversionsToExportHelp"))},null,8,z)])])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",Y,[X,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[i["vShow"],e.isLoadingGoals]]),e.goals.length||e.isLoadingGoals?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(be,{key:2,severity:"warning"},{default:Object(i["withCtx"])((function(){return[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_NoGoalsConfigured")),1)]})),_:1})),e.goals.length&&!e.isLoadingGoals?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",K,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.conversionExport.parameters.goals,(function(o,n){var r,a;return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:Object(i["normalizeClass"])("exportGoals ".concat(n," valign-wrapper")),key:n},[Object(i["createElementVNode"])("div",J,[Object(i["createElementVNode"])("div",Q,[Object(i["createElementVNode"])("div",{name:"exportGoalId".concat(n)},[Object(i["createVNode"])(ve,{uicontrol:"select","model-value":o.idgoal,"onUpdate:modelValue":function(t){o.idgoal=t,e.setValueHasChanged()},title:e.translate("General_Goal"),name:"exportGoalId".concat(n),"full-width":!0,options:e.goals,tabindex:37+4*n},null,8,["model-value","onUpdate:modelValue","title","name","options","tabindex"])],8,Z)]),Object(i["createElementVNode"])("div",ee,[Object(i["createElementVNode"])("div",{name:"exportGoalName".concat(n)},[Object(i["createVNode"])(ve,{uicontrol:"text","model-value":o.name,"onUpdate:modelValue":function(t){o.name=t,e.setValueHasChanged()},title:e.translate("AdvertisingConversionExport_GoalAlias"),name:"exportGoalName".concat(n),"full-width":!0,maxlength:50,tabindex:38+4*n},null,8,["model-value","onUpdate:modelValue","title","name","tabindex"])],8,te)]),Object(i["createElementVNode"])("div",oe,[Object(i["createElementVNode"])("div",ne,[Object(i["createElementVNode"])("div",{name:"exportGoalRevenue".concat(n),class:Object(i["normalizeClass"])("col s12 ".concat("custom"===o.revenue?"m6":"m12"))},[Object(i["createVNode"])(ve,{uicontrol:"select","model-value":o.revenue,"onUpdate:modelValue":function(t){o.revenue=t,e.setValueHasChanged()},title:e.translate("General_ColumnRevenue"),name:"exportGoalRevenue".concat(n),class:Object(i["normalizeClass"])({custom:"custom"===o.revenue}),"full-width":!0,options:e.revenueOptions,tabindex:39+4*n},null,8,["model-value","onUpdate:modelValue","title","name","class","options","tabindex"])],10,re),Object(i["createElementVNode"])("div",{name:"exportGoalRevenueCustom".concat(n),class:"col s12 m6"},["custom"===o.revenue?(Object(i["openBlock"])(),Object(i["createBlock"])(ve,{key:0,uicontrol:"number","model-value":o.revenueValue,"onUpdate:modelValue":function(t){o.revenueValue=t,e.setValueHasChanged()},title:e.translate("General_Value"),name:"exportGoalRevenueCustom".concat(n),"full-width":!0,tabindex:40+4*n},null,8,["model-value","onUpdate:modelValue","title","name","tabindex"])):Object(i["createCommentVNode"])("",!0)],8,ie)])])]),Object(i["createElementVNode"])("div",null,[Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{class:"icon-plus",title:e.translate("General_Add"),onClick:t[12]||(t[12]=function(t){return e.addExportGoal()})},null,8,ae),[[i["vShow"],(null===(r=e.conversionExport.parameters)||void 0===r?void 0:r.goals.length)<e.goals.length]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{class:"icon-minus",title:e.translate("General_Remove"),onClick:function(t){return e.removeExportGoal(n)}},null,8,se),[[i["vShow"],(null===(a=e.conversionExport.parameters)||void 0===a?void 0:a.goals.length)>1]])])],2)})),128))])):Object(i["createCommentVNode"])("",!0),e.showNoteMessage?(Object(i["openBlock"])(),Object(i["createBlock"])(be,{key:4,severity:"info"},{default:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("strong",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_ExportNote"))+": ",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.noteMessage),1)]})),_:1})):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(xe,{class:"createButton",tabindex:"100",onConfirm:t[13]||(t[13]=function(t){return e.edit?e.updateExport():e.createExport()}),disabled:e.isUpdating||!e.isDirty||!e.goals.length,saving:e.isUpdating,value:e.createButtonText},null,8,["disabled","saving","value"]),Object(i["createElementVNode"])("div",le,[Object(i["createElementVNode"])("a",{onClick:t[14]||(t[14]=function(t){return e.cancel()})},Object(i["toDisplayString"])(e.translate("General_Cancel")),1)])])],32),Object(i["createElementVNode"])("div",ce,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_RegenerateAccessTokenConfirm")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,de),Object(i["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,pe)],512)]})),_:1},8,["content-title"])}var ve=o("19dc"),me=o("a5a2"),be=o("f06f");function xe(e,t){return he(e)||fe(e,t)||je(e,t)||Ee()}function Ee(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fe(e,t){var o=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done);a=!0)if(i.push(n.value),t&&i.length===t)break}catch(l){s=!0,r=l}finally{try{a||null==o["return"]||o["return"]()}finally{if(s)throw r}}return i}}function he(e){if(Array.isArray(e))return e}function ge(e){return Ce(e)||ye(e)||je(e)||Oe()}function Oe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function je(e,t){if(e){if("string"===typeof e)return Ne(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Ne(e,t):void 0}}function ye(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ce(e){if(Array.isArray(e))return Ne(e)}function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function Ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ve(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ke(e,t,o){return t&&Ve(e.prototype,t),o&&Ve(e,o),e}function Se(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */var we=function(){function e(){var t=this;Ae(this,e),Se(this,"privateState",Object(i["reactive"])({exports:[],sites:[],goals:[],isLoading:!1,isLoadingGoals:!1,isUpdating:!1})),Se(this,"state",Object(i["computed"])((function(){return Object(i["readonly"])(t.privateState)}))),Se(this,"exports",Object(i["computed"])((function(){return t.state.value.exports}))),Se(this,"isEcommerceSite",Object(i["computed"])((function(){var e=t.state.value.sites.find((function(e){return parseInt(e.idsite,10)===parseInt(ve["Matomo"].idSite,10)})),o=null===e||void 0===e?void 0:e.ecommerce;return 1===o||"1"===o}))),Se(this,"goals",Object(i["computed"])((function(){var e=[];return t.isEcommerceSite.value&&e.push({key:"0",value:Object(ve["translate"])("General_EcommerceOrders")}),Object(i["readonly"])([].concat(e,ge(t.state.value.goals)))}))),Se(this,"fetchPromise",null),Se(this,"fetchSitePromise",null)}return ke(e,[{key:"reload",value:function(){return this.privateState.exports=[],this.fetchPromise=null,this.fetchExports()}},{key:"fetchExports",value:function(){var e=this;return this.fetchPromise||(this.fetchPromise=ve["AjaxHelper"].fetch({method:"AdvertisingConversionExport.getConversionExports",idSite:ve["Matomo"].idSite,filter_limit:"-1"})),this.privateState.isLoading=!0,this.privateState.exports=[],Promise.all([this.fetchPromise,this.fetchSites(),this.fetchGoals()]).then((function(t){var o=xe(t,1),n=o[0];return e.privateState.exports=n,e.exports.value})).finally((function(){e.privateState.isLoading=!1}))}},{key:"fetchGoals",value:function(){var e=this;return this.state.value.goals.length?Promise.resolve(this.state.value.goals):(this.privateState.isLoadingGoals=!0,ve["AjaxHelper"].fetch({module:"API",method:"Goals.getGoals",idSite:ve["Matomo"].idSite,filter_limit:"-1"}).then((function(t){return e.privateState.goals=Object.values(t).map((function(e){return{key:"".concat(e.idgoal),value:e.name}})),e.goals.value})).finally((function(){e.privateState.isLoadingGoals=!1})))}},{key:"fetchSites",value:function(){var e=this;return this.state.value.sites.length?Promise.resolve(this.state.value.sites):(this.fetchSitePromise||(this.fetchSitePromise=ve["AjaxHelper"].fetch({module:"API",method:"SitesManager.getSitesWithAtLeastViewAccess",filter_limit:"-1"})),this.fetchSitePromise.then((function(t){return e.privateState.sites=t||[],e.state.value.sites})))}},{key:"findExport",value:function(e){var t=this,o=this.state.value.exports.find((function(t){return parseInt("".concat(t.idexport),10)===e}));return o?Promise.resolve(o):(this.privateState.isLoading=!0,Promise.all([ve["AjaxHelper"].fetch({idExport:e,method:"AdvertisingConversionExport.getConversionExport"}),this.fetchSites()]).then((function(e){var t=xe(e,1),o=t[0];return Object(i["readonly"])(o)})).finally((function(){t.privateState.isLoading=!1})))}},{key:"deleteExport",value:function(e){var t=this;return this.privateState.isUpdating=!0,this.privateState.exports=[],ve["AjaxHelper"].fetch({idExport:e,method:"AdvertisingConversionExport.deleteConversionExport"},{withTokenInUrl:!0}).then((function(){return{type:"success"}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){t.privateState.isUpdating=!1}))}},{key:"regenerateAccessToken",value:function(e){var t=this;return this.privateState.isUpdating=!0,this.privateState.exports=[],ve["AjaxHelper"].fetch({idExport:e,method:"AdvertisingConversionExport.regenerateAccessToken"},{withTokenInUrl:!0}).finally((function(){t.privateState.isUpdating=!1}))}},{key:"createExport",value:function(e,t){var o,n,r,i,a,s=this;this.privateState.isUpdating=!0;var l=[!0,"true",1,"1"].includes(null!==(o=null===(n=e.parameters)||void 0===n?void 0:n.onlyDirectAttribution)&&void 0!==o&&o)?1:0,c=[!0,"true",1,"1"].includes(null!==(r=null===(i=e.parameters)||void 0===i?void 0:i.externalAttributedConversion)&&void 0!==r&&r)?1:0;return ve["AjaxHelper"].post({},{idExport:e.idexport,name:e.name.trim(),type:e.type,description:e.description.trim(),method:t,parameters:Object.assign(Object.assign({},e.parameters||{}),{},{onlyDirectAttribution:l,externalAttributedConversion:c,goals:((null===(a=e.parameters)||void 0===a?void 0:a.goals)||[]).filter((function(e){return""!==e.idgoal&&e.idgoal>=0}))})},{withTokenInUrl:!0}).then((function(e){return{type:"success",response:e}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){s.privateState.isUpdating=!1}))}},{key:"updateExport",value:function(e,t){var o,n,r,i,a,s=this;this.privateState.isUpdating=!0;var l=[!0,"true",1,"1"].includes(null!==(o=null===(n=e.parameters)||void 0===n?void 0:n.onlyDirectAttribution)&&void 0!==o&&o)?1:0,c=[!0,"true",1,"1"].includes(null!==(r=null===(i=e.parameters)||void 0===i?void 0:i.externalAttributedConversion)&&void 0!==r&&r)?1:0;return ve["AjaxHelper"].post({},{idExport:e.idexport,name:e.name.trim(),type:e.type,description:e.description.trim(),method:t,parameters:Object.assign(Object.assign({},e.parameters||{}),{},{onlyDirectAttribution:l,externalAttributedConversion:c,goals:((null===(a=e.parameters)||void 0===a?void 0:a.goals)||[]).filter((function(e){return""!==e.idgoal&&e.idgoal>=0}))})},{withTokenInUrl:!0}).then((function(e){return{type:"success",response:e}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){s.privateState.isUpdating=!1}))}}]),e}(),_e=new we;function Te(e){return Ge(e)||Ue(e)||Me(e)||De()}function De(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Me(e,t){if(e){if("string"===typeof e)return Be(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Be(e,t):void 0}}function Ue(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ge(e){if(Array.isArray(e))return Be(e)}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var Le=0,He="dataDriven",Ie=1,Pe="conversionexportmanagement",qe={goal:Object(ve["translate"])("AdvertisingConversionExport_UseGoalRevenue"),custom:Object(ve["translate"])("AdvertisingConversionExport_UseCustomRevenue"),null:Object(ve["translate"])("AdvertisingConversionExport_UseEmptyRevenue")},Re={first:Object(ve["translate"])("AdvertisingConversionExport_FirstClickId"),last:Object(ve["translate"])("AdvertisingConversionExport_LastClickId"),all:Object(ve["translate"])("AdvertisingConversionExport_AllClickIds")},Fe=Object(i["defineComponent"])({directives:{CopyToClipboard:ve["CopyToClipboard"]},props:{idExport:Number,exportTypes:{type:Object,required:!0},alreadyCreatedExportTypes:{type:Object,required:!0},clickIdProviders:{type:Object,required:!0},attributionModels:{type:Object,required:!0}},components:{ContentBlock:ve["ContentBlock"],Field:me["Field"],SegmentGenerator:be["SegmentGenerator"],Alert:ve["Alert"],SaveButton:me["SaveButton"]},data:function(){return{isDirty:!1,conversionExport:{},showNoteMessage:!1,noteMessage:"test",initialTokenValue:""}},created:function(){_e.fetchExports(),this.init()},watch:{idExport:function(e){null!==e&&this.init()}},methods:{removeAnyNotification:function(){ve["NotificationsStore"].remove(Pe),ve["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){this.removeAnyNotification();var o=ve["NotificationsStore"].show({message:e,context:t,id:Pe,type:"transient"});setTimeout((function(){ve["NotificationsStore"].scrollToNotification(o)}),100)},showErrorFieldNotProvidedNotification:function(e){var t=Object(ve["translate"])("AdvertisingConversionExport_ErrorXNotProvided",[e]);this.showNotification(t,"error")},init:function(){var e=this,t=this.idExport;this.conversionExport={parameters:{}},ve["Matomo"].helper.lazyScrollToContent(),this.edit&&t?_e.findExport(t).then((function(t){if("".concat(null===t||void 0===t?void 0:t.idsite)!=="".concat(ve["Matomo"].idSite))return setTimeout((function(){e.showNotification(Object(ve["translate"])("AdvertisingConversionExport_UnableToLoadExport"),"error")}),200),void e.cancel();if(e.conversionExport=Object(ve["clone"])(t),e.conversionExport.parameters){var o,n,r,i=e.conversionExport.parameters;i.externalAttributedConversion=null!==(o=i.externalAttributedConversion)&&void 0!==o?o:Le,i.attributionModel=null!==(n=i.attributionModel)&&void 0!==n?n:He,i.attributedCredit=null!==(r=i.attributedCredit)&&void 0!==r?r:Ie}e.initialTokenValue&&(e.conversionExport.access_token=e.initialTokenValue),_e.fetchGoals().then((function(){e.isDirty=!1,e.addInitialExportGoal()}))})):this.create&&(this.conversionExport={idsite:ve["Matomo"].idSite,name:"",type:Object.keys(this.exportTypeOptions)[0],description:"",access_token:"",parameters:{goals:[],daysToExport:7,segment:"",onlyDirectAttribution:1,daysToLookBack:30,clickIdAttribution:"last",externalAttributedConversion:Le,attributionModel:He,attributedCredit:Ie}},this.isDirty=!1,_e.fetchGoals().then((function(){e.addInitialExportGoal()})),this.showNote())},cancel:function(){var e=Object.assign({},ve["MatomoUrl"].hashParsed.value);delete e.idExport,ve["MatomoUrl"].updateHash(e)},addInitialExportGoal:function(){var e,t;this.conversionExport&&(null!==(e=this.conversionExport.parameters)&&void 0!==e&&null!==(t=e.goals)&&void 0!==t&&t.length||this.addExportGoal())},addExportGoal:function(){var e;this.conversionExport&&(this.conversionExport.parameters||(this.conversionExport.parameters={}),null!==(e=this.conversionExport.parameters.goals)&&void 0!==e&&e.length||(this.conversionExport.parameters.goals=[]),this.conversionExport.parameters.goals=[].concat(Te(this.conversionExport.parameters.goals),[{idgoal:"",name:"",revenue:"goal"}]),this.isDirty=!0)},removeExportGoal:function(e){var t,o,n;null!==(t=this.conversionExport)&&void 0!==t&&null!==(o=t.parameters)&&void 0!==o&&null!==(n=o.goals)&&void 0!==n&&n.length&&e>-1&&(this.conversionExport.parameters.goals.splice(e,1),this.isDirty=!0)},regenerateAccessToken:function(){var e=this,t=this.idExport;t&&ve["Matomo"].helper.modalConfirm(this.$refs.confirmRegenerateAccessToken,{yes:function(){_e.regenerateAccessToken(t).then((function(t){e.conversionExport.access_token=t.value,t.value&&e.showNotification(Object(ve["translate"])("AdvertisingConversionExport_ExportUpdatedWithExportURLMessage"),"success")}))}})},createExport:function(){var e=this,t="AdvertisingConversionExport.addConversionExport";this.removeAnyNotification(),this.checkRequiredFieldsAreSet()&&_e.createExport(this.conversionExport,t).then((function(t){e.isDirty=!1,console.log(t,"response");var o=t.response.idExport,n=t.response.accessToken;n&&(e.initialTokenValue=n),_e.reload().then((function(){ve["Matomo"].helper.isReportingPage()&&ve["Matomo"].postEvent("updateReportingMenu"),ve["MatomoUrl"].updateHash(Object.assign(Object.assign({},ve["MatomoUrl"].hashParsed.value),{},{idExport:o})),setTimeout((function(){e.showNotification(Object(ve["translate"])("AdvertisingConversionExport_ExportCreatedWithExportURLMessage"),t.type)}),200)}))}))},setValueHasChanged:function(){var e,t,o;if(this.isDirty=!0,null!==(e=this.conversionExport)&&void 0!==e&&null!==(t=e.parameters)&&void 0!==t&&null!==(o=t.goals)&&void 0!==o&&o.length){var n=[];this.conversionExport.parameters.goals.forEach((function(e){n.indexOf(e.idgoal)>=0&&(e.idgoal=null),(e.idgoal||0===e.idgoal)&&n.push(e.idgoal)}))}},showNote:function(){var e,t,o;this.showNoteMessage=!1,this.noteMessage="",null===(e=this.conversionExport)||void 0===e||!e.type||null!==(t=this.alreadyCreatedExportTypes)&&void 0!==t&&t[this.conversionExport.type]||null===(o=this.clickIdProviders)||void 0===o||!o[this.conversionExport.type]||(this.showNoteMessage=!0,this.noteMessage=Object(ve["translate"])("AdvertisingConversionExport_ExportNoteMessage",this.clickIdProviders[this.conversionExport.type].clickId,this.clickIdProviders[this.conversionExport.type].name))},updateExport:function(){var e=this;if(this.removeAnyNotification(),this.checkRequiredFieldsAreSet()){var t="AdvertisingConversionExport.updateConversionExport";_e.updateExport(this.conversionExport,t).then((function(t){"error"!==t.type&&(e.isDirty=!1,e.conversionExport={parameters:{}},_e.reload().then((function(){e.init()})),e.showNotification(Object(ve["translate"])("AdvertisingConversionExport_ExportUpdated"),t.type))}))}},checkRequiredFieldsAreSet:function(){var e,t;if(!this.conversionExport.name){var o=Object(ve["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(o),!1}if(null===(e=this.conversionExport.parameters)||void 0===e||null===(t=e.goals)||void 0===t||!t.length){var n=Object(ve["translate"])("AdvertisingConversionExport_PleaseConfigureGoals");return this.showNotification(n,"error"),!1}var r=this.conversionExport.parameters.goals.some((function(e){return""!==e.idgoal&&e.idgoal>=0}));if(!r){var i=Object(ve["translate"])("AdvertisingConversionExport_PleaseConfigureGoals");return this.showNotification(i,"error"),!1}if(!this.conversionExport.parameters.daysToExport||"NaN"===this.conversionExport.parameters.daysToExport||this.conversionExport.parameters.daysToExport<1){var a=Object(ve["translate"])("AdvertisingConversionExport_PleaseConfigureDaysToExport");return this.showNotification(a,"error"),!1}return!0},showDownloadLink:function(){var e=ve["MatomoUrl"].stringify({module:"AdvertisingConversionExport",action:"generateConversionExport",accessToken:"********"===this.conversionExport.access_token?"":this.conversionExport.access_token});return"".concat(window.location.origin).concat(window.location.pathname,"?").concat(e).concat("********"===this.conversionExport.access_token?"&accessToken={YOUR_EXPORT_ACCESS_TOKEN}":"")}},computed:{revenueOptions:function(){return qe},clickIdAttributionOptions:function(){return Re},exportTypeOptions:function(){var e={};return Object.values(this.exportTypes).forEach((function(t){e[t.id]=t.name})),e},exportTypeDescription:function(){return Object.values(this.exportTypes).map((function(e){return"<br/><br/><strong>".concat(e.name,"</strong><br />").concat(e.description)})).join("")},attributionModelOptions:function(){var e={};return Object.values(this.attributionModels).forEach((function(t){e[t.id]=t.translatedName})),e},create:function(){return!this.idExport},edit:function(){return!this.create},editTitle:function(){return this.create?"AdvertisingConversionExport_CreateNewExport":"AdvertisingConversionExport_EditExport"},contentTitle:function(){return Object(ve["translate"])(this.editTitle,this.conversionExport.name?'"'.concat(this.conversionExport.name,'"'):"")},isLoading:function(){return _e.state.value.isLoading},isUpdating:function(){return _e.state.value.isUpdating},isLoadingGoals:function(){return _e.state.value.isLoadingGoals},goals:function(){return _e.goals.value},conversionExportHelp:function(){var e=Object(ve["translate"])("AdvertisingConversionExport_ExportTypeHelp");return"".concat(e).concat(this.exportTypeDescription)},accessTokenInlineHelp:function(){var e=Object(ve["translate"])("AdvertisingConversionExport_AccessTokenHelp"),t=Object(ve["translate"])("AdvertisingConversionExport_DoNotShare");return"".concat(e,"<br />").concat(t)},directAttributionHelp:function(){var e=Object(ve["translate"])("AdvertisingConversionExport_DirectAttributionOnlyDescription"),t=Object(ve["translate"])("AdvertisingConversionExport_DirectAttributionOnlyNote");return"".concat(e,"<br /><br />").concat(t)},createButtonText:function(){return this.edit?Object(ve["translate"])("CoreUpdater_UpdateTitle"):Object(ve["translate"])("AdvertisingConversionExport_CreateNewExport")}}});Fe.render=ue;var $e=Fe,We={class:"index"},ze={class:"name"},Ye={class:"type"},Xe={key:0,class:"description"},Ke={class:"goals"},Je=["title"],Qe={class:"action"},Ze={colspan:"6"},et={class:"loadingPiwik"},tt=Object(i["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),ot={colspan:"6"},nt=["id"],rt={class:"index"},it={class:"name"},at={class:"type"},st=["title"],lt=["title"],ct={class:"goals"},dt=["innerHTML"],pt=Object(i["createElementVNode"])("br",null,null,-1),ut={key:2,class:"requested"},vt={key:3,class:"requested"},mt={class:"action"},bt=["title","onClick"],xt=["title","onClick"],Et=["title","onClick"],ft={class:"tableActionBar"},ht=Object(i["createElementVNode"])("span",{class:"icon-add"},null,-1),gt={class:"ui-confirm",id:"confirmDeleteExport",ref:"confirmDeleteExport"},Ot=["value"],jt=["value"];function yt(e,t,o,n,r,a){var s=Object(i["resolveComponent"])("ContentBlock"),l=Object(i["resolveDirective"])("content-table");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createVNode"])(s,{"content-title":e.translate("AdvertisingConversionExport_ManageExports"),feature:e.translate("AdvertisingConversionExport_ManageExports")},{default:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_ManageExportsIntroduction")),1),Object(i["withDirectives"])(Object(i["createElementVNode"])("table",null,[Object(i["createElementVNode"])("thead",null,[Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("th",We,Object(i["toDisplayString"])(e.translate("General_Id")),1),Object(i["createElementVNode"])("th",ze,Object(i["toDisplayString"])(e.translate("General_Name")),1),Object(i["createElementVNode"])("th",Ye,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_ExportType")),1),e.atLeastOneExportWithDescription?(Object(i["openBlock"])(),Object(i["createElementBlock"])("th",Xe,Object(i["toDisplayString"])(e.translate("General_Description")),1)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("th",Ke,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_IncludedConversions")),1),Object(i["createElementVNode"])("th",{class:"requested",title:e.translate("AdvertisingConversionExport_LastRequestedInfo")},Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_LastRequested")),9,Je),Object(i["createElementVNode"])("th",Qe,Object(i["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(i["createElementVNode"])("tbody",null,[Object(i["withDirectives"])(Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("td",Ze,[Object(i["createElementVNode"])("span",et,[tt,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[i["vShow"],e.isLoading||e.isUpdating]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("td",ot,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_NoExportsFound")),1)],512),[[i["vShow"],!e.isLoading&&0===e.exports.length]]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.sortedExports,(function(t){var o;return Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",{id:"export".concat(t.idexport),class:"exports",key:t.idexport},[Object(i["createElementVNode"])("td",rt,Object(i["toDisplayString"])(t.idexport),1),Object(i["createElementVNode"])("td",it,Object(i["toDisplayString"])(t.name),1),Object(i["createElementVNode"])("td",at,Object(i["toDisplayString"])(e.exportTypes[t.type].name),1),e.atLeastOneExportWithDescription&&t.description.trim().length>63?(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",{key:0,class:"description",title:t.description},Object(i["toDisplayString"])(t.description.trim().substring(0,60))+"...",9,st)):Object(i["createCommentVNode"])("",!0),e.atLeastOneExportWithDescription&&t.description.trim().length<=63?(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",{key:1,class:"description",title:t.description},Object(i["toDisplayString"])(t.description.trim()),9,lt)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("td",ct,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])((null===(o=t.parameters)||void 0===o?void 0:o.goals)||[],(function(t){var o;return Object(i["openBlock"])(),Object(i["createElementBlock"])("span",{key:t.idgoal},[Object(i["createTextVNode"])(Object(i["toDisplayString"])((null===(o=e.goals.find((function(e){return e.key==="".concat(t.idgoal)})))||void 0===o?void 0:o.value)||e.translate("General_Unknown"))+" ",1),Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.getDisplayGoalName(t))},null,8,dt),pt])})),128))]),t.ts_requested?(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",ut,Object(i["toDisplayString"])(t.ts_requested_pretty),1)):Object(i["createCommentVNode"])("",!0),t.ts_requested?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",vt,Object(i["toDisplayString"])(e.translate("General_Never")),1)),Object(i["createElementVNode"])("td",mt,[Object(i["createElementVNode"])("a",{class:"table-action icon-download",title:e.translate("AdvertisingConversionExport_DownloadExport"),onClick:function(o){return e.openExport(t.idexport,t.idsite)}},null,8,bt),Object(i["createElementVNode"])("a",{class:"table-action icon-edit",title:e.translate("AdvertisingConversionExport_EditExport"),onClick:function(o){return e.editExport(t.idexport)}},null,8,xt),Object(i["createElementVNode"])("a",{class:"table-action icon-delete",title:e.translate("AdvertisingConversionExport_DeleteExport"),onClick:function(o){return e.deleteExport(t)}},null,8,Et)])],8,nt)})),128))])],512),[[l]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",ft,[Object(i["createElementVNode"])("a",{class:"createNewExport",onClick:t[0]||(t[0]=function(t){return e.createExport()})},[ht,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_CreateNewExport")),1)])],512),[[i["vShow"],e.hasWriteAccess]])]})),_:1},8,["content-title","feature"]),Object(i["createElementVNode"])("div",gt,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("AdvertisingConversionExport_DeleteExportConfirm")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Ot),Object(i["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,jt)],512)])}function Ct(e){return kt(e)||Vt(e)||At(e)||Nt()}function Nt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function At(e,t){if(e){if("string"===typeof e)return St(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?St(e,t):void 0}}function Vt(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function kt(e){if(Array.isArray(e))return St(e)}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var wt=Object(i["defineComponent"])({props:{exportTypes:{type:Object,required:!0},alreadyCreatedExportTypes:{type:Object,required:!0},clickIdProviders:{type:Object,required:!0},hasWriteAccess:Boolean},components:{ContentBlock:ve["ContentBlock"]},directives:{ContentTable:ve["ContentTable"]},data:function(){return{exportLink:""}},created:function(){_e.fetchExports()},methods:{getDisplayGoalName:function(e){return e.name?"(&#x279C;&nbsp;".concat(ve["Matomo"].helper.htmlEntities(e.name),")"):""},getDownloadLink:function(e,t){var o=ve["MatomoUrl"].stringify({module:"AdvertisingConversionExport",action:"downloadConversionExport",idExport:e,idSite:t});return"".concat(window.location.origin).concat(window.location.pathname,"?").concat(o)},createExport:function(){this.editExport(0)},editExport:function(e){ve["MatomoUrl"].updateHash(Object.assign(Object.assign({},ve["MatomoUrl"].hashParsed.value),{},{idExport:e}))},openExport:function(e,t){window.open(this.getDownloadLink(e,t))},deleteExport:function(e){ve["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteExport,{yes:function(){_e.deleteExport(parseInt(e.idexport,10)).then((function(){_e.reload()}))}})}},computed:{atLeastOneExportWithDescription:function(){return _e.exports.value.filter((function(e){return!!e.description})).length},isLoading:function(){return _e.state.value.isLoading},isUpdating:function(){return _e.state.value.isUpdating},exports:function(){return _e.exports.value},sortedExports:function(){var e=Ct(this.exports);return e.sort((function(e,t){return parseInt("".concat(e.idexport),10)-parseInt("".concat(t.idexport),10)})),e},goals:function(){return _e.goals.value||[]}}});wt.render=yt;var _t=wt,Tt={class:"manageConversionExport"},Dt={key:0},Mt={key:1};function Ut(e,t,o,n,r,a){var s=Object(i["resolveComponent"])("ConversionExportList"),l=Object(i["resolveComponent"])("ConversionExportEdit");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Tt,[e.editMode?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Dt,[Object(i["createVNode"])(s,{"export-types":e.exportTypes,"already-created-export-types":e.alreadyCreatedExportTypes,"click-id-providers":e.clickIdProviders,"attribution-models":e.attributionModels,"has-write-access":e.hasWriteAccess},null,8,["export-types","already-created-export-types","click-id-providers","attribution-models","has-write-access"])])),e.editMode?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Mt,[Object(i["createVNode"])(l,{"id-export":e.idExport,"export-types":e.exportTypes,"already-created-export-types":e.alreadyCreatedExportTypes,"click-id-providers":e.clickIdProviders,"attribution-models":e.attributionModels},null,8,["id-export","export-types","already-created-export-types","click-id-providers","attribution-models"])])):Object(i["createCommentVNode"])("",!0)])}var Gt=Object(i["defineComponent"])({props:{exportTypes:{type:Object,required:!0},alreadyCreatedExportTypes:{type:Object,required:!0},clickIdProviders:{type:Object,required:!0},attributionModels:{type:Object,required:!0},hasWriteAccess:Boolean},components:{ConversionExportEdit:$e,ConversionExportList:_t},data:function(){return{editMode:!1,idExport:null}},created:function(){var e=this;Object(i["watch"])((function(){return ve["MatomoUrl"].hashParsed.value.idExport}),(function(t){e.initState(t)})),this.initState(ve["MatomoUrl"].hashParsed.value.idExport)},methods:{removeAnyNotification:function(){ve["NotificationsStore"].remove("conversionexportmanagement")},initState:function(e){if(e){if("0"===e){var t={isAllowed:!0};if(ve["Matomo"].postEvent("AdvertisingConversionExport.initAddExport",t),t&&!t.isAllowed)return this.editMode=!1,void(this.idExport=null)}this.editMode=!0,this.idExport=parseInt(e,10)}else this.editMode=!1,this.idExport=null;this.removeAnyNotification()}}});Gt.render=Ut;var Bt=Gt;
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */}})}));
//# sourceMappingURL=AdvertisingConversionExport.umd.min.js.map