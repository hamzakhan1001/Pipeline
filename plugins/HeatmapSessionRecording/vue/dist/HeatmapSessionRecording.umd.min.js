(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["HeatmapSessionRecording"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["HeatmapSessionRecording"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,a){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="plugins/HeatmapSessionRecording/vue/dist/",a(a.s="fae3")}({"19dc":function(t,a){t.exports=e},"246e":function(e,t,a){var n,i;(function(r,o,s){e.exports?e.exports=s():(n=s,i="function"===typeof n?n.call(t,a,t,e):n,void 0===i||(e.exports=i))})(0,0,(function(){var e={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},t=function(){var t=function(e){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=e["xField"]||e.defaultXField,this._yField=e["yField"]||e.defaultYField,this._valueField=e["valueField"]||e.defaultValueField,e["radius"]&&(this._cfgRadius=e["radius"])},a=e.defaultRadius;return t.prototype={_organiseData:function(e,t){var n=e[this._xField],i=e[this._yField],r=this._radi,o=this._data,s=this._max,l=this._min,c=e[this._valueField]||1,d=e.radius||this._cfgRadius||a;o[n]||(o[n]=[],r[n]=[]),o[n][i]?o[n][i]+=c:(o[n][i]=c,r[n][i]=d);var u=o[n][i];return u>s?(t?this.setDataMax(u):this._max=u,!1):u<l?(t?this.setDataMin(u):this._min=u,!1):{x:n,y:i,value:c,radius:d,min:l,max:s}},_unOrganizeData:function(){var e=[],t=this._data,a=this._radi;for(var n in t)for(var i in t[n])e.push({x:n,y:i,radius:a[n][i],value:t[n][i]});return{min:this._min,max:this._max,data:e}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0){var e=arguments[0],t=e.length;while(t--)this.addData.call(this,e[t])}else{var a=this._organiseData(arguments[0],!0);a&&(0===this._data.length&&(this._min=this._max=a.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[a]}))}return this},setData:function(e){var t=e.data,a=t.length;this._data=[],this._radi=[];for(var n=0;n<a;n++)this._organiseData(t[n],!1);return this._max=e.max,this._min=e.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(e){return this._max=e,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(e){return this._min=e,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(e){this._coordinator=e},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},t}(),a=function(){var e=function(e){var t=e.gradient||e.defaultGradient,a=document.createElement("canvas"),n=a.getContext("2d");a.width=256,a.height=1;var i=n.createLinearGradient(0,0,256,1);for(var r in t)i.addColorStop(r,t[r]);return n.fillStyle=i,n.fillRect(0,0,256,1),n.getImageData(0,0,256,1).data},t=function(e,t){var a=document.createElement("canvas"),n=a.getContext("2d"),i=e,r=e;if(a.width=a.height=2*e,1==t)n.beginPath(),n.arc(i,r,e,0,2*Math.PI,!1),n.fillStyle="rgba(0,0,0,1)",n.fill();else{var o=n.createRadialGradient(i,r,e*t,i,r,e);o.addColorStop(0,"rgba(0,0,0,1)"),o.addColorStop(1,"rgba(0,0,0,0)"),n.fillStyle=o,n.fillRect(0,0,2*e,2*e)}return a},a=function(e){var t=[],a=e.min,n=e.max,i=e.radi,r=(e=e.data,Object.keys(e)),o=r.length;while(o--){var s=r[o],l=Object.keys(e[s]),c=l.length;while(c--){var d=l[c],u=e[s][d],m=i[s][d];t.push({x:s,y:d,value:u,radius:m})}}return{min:a,max:n,data:t}};function n(t){var a=t.container,n=this.shadowCanvas=document.createElement("canvas"),i=this.canvas=t.canvas||document.createElement("canvas"),r=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(t.container)||{});i.className="heatmap-canvas",this._width=i.width=n.width=t.width||+r.width.replace(/px/,""),this._height=i.height=n.height=t.height||+r.height.replace(/px/,""),this.shadowCtx=n.getContext("2d"),this.ctx=i.getContext("2d"),i.style.cssText=n.style.cssText="position:absolute;left:0;top:0;",a.style.position="relative",a.appendChild(i),this._palette=e(t),this._templates={},this._setStyles(t)}return n.prototype={renderPartial:function(e){e.data.length>0&&(this._drawAlpha(e),this._colorize())},renderAll:function(e){this._clear(),e.data.length>0&&(this._drawAlpha(a(e)),this._colorize())},_updateGradient:function(t){this._palette=e(t)},updateConfig:function(e){e["gradient"]&&this._updateGradient(e),this._setStyles(e)},setDimensions:function(e,t){this._width=e,this._height=t,this.canvas.width=this.shadowCanvas.width=e,this.canvas.height=this.shadowCanvas.height=t},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(e){this._blur=0==e.blur?0:e.blur||e.defaultBlur,e.backgroundColor&&(this.canvas.style.backgroundColor=e.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=e.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=e.height||this._height,this._opacity=255*(e.opacity||0),this._maxOpacity=255*(e.maxOpacity||e.defaultMaxOpacity),this._minOpacity=255*(e.minOpacity||e.defaultMinOpacity),this._useGradientOpacity=!!e.useGradientOpacity},_drawAlpha:function(e){var a=this._min=e.min,n=this._max=e.max,i=(e=e.data||[],e.length),r=1-this._blur;while(i--){var o,s=e[i],l=s.x,c=s.y,d=s.radius,u=Math.min(s.value,n),m=l-d,p=c-d,h=this.shadowCtx;this._templates[d]?o=this._templates[d]:this._templates[d]=o=t(d,r);var g=(u-a)/(n-a);h.globalAlpha=g<.01?.01:g,h.drawImage(o,m,p),m<this._renderBoundaries[0]&&(this._renderBoundaries[0]=m),p<this._renderBoundaries[1]&&(this._renderBoundaries[1]=p),m+2*d>this._renderBoundaries[2]&&(this._renderBoundaries[2]=m+2*d),p+2*d>this._renderBoundaries[3]&&(this._renderBoundaries[3]=p+2*d)}},_colorize:function(){var e=this._renderBoundaries[0],t=this._renderBoundaries[1],a=this._renderBoundaries[2]-e,n=this._renderBoundaries[3]-t,i=this._width,r=this._height,o=this._opacity,s=this._maxOpacity,l=this._minOpacity,c=this._useGradientOpacity;e<0&&(e=0),t<0&&(t=0),e+a>i&&(a=i-e),t+n>r&&(n=r-t);for(var d=this.shadowCtx.getImageData(e,t,a,n),u=d.data,m=u.length,p=this._palette,h=3;h<m;h+=4){var g,f=u[h],b=4*f;if(b)g=o>0?o:f<s?f<l?l:f:s,u[h-3]=p[b],u[h-2]=p[b+1],u[h-1]=p[b+2],u[h]=c?p[b+3]:g}d.data=u,this.ctx.putImageData(d,e,t),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(e){var t,a=this.shadowCtx,n=a.getImageData(e.x,e.y,1,1),i=n.data[3],r=this._max,o=this._min;return t=Math.abs(r-o)*(i/255)>>0,t},getDataURL:function(){return this.canvas.toDataURL()}},n}(),n=function(){var t=!1;return"canvas2d"===e["defaultRenderer"]&&(t=a),t}(),i={merge:function(){for(var e={},t=arguments.length,a=0;a<t;a++){var n=arguments[a];for(var i in n)e[i]=n[i]}return e}},r=function(){var a=function(){function e(){this.cStore={}}return e.prototype={on:function(e,t,a){var n=this.cStore;n[e]||(n[e]=[]),n[e].push((function(e){return t.call(a,e)}))},emit:function(e,t){var a=this.cStore;if(a[e])for(var n=a[e].length,i=0;i<n;i++){var r=a[e][i];r(t)}}},e}(),r=function(e){var t=e._renderer,a=e._coordinator,n=e._store;a.on("renderpartial",t.renderPartial,t),a.on("renderall",t.renderAll,t),a.on("extremachange",(function(t){e._config.onExtremaChange&&e._config.onExtremaChange({min:t.min,max:t.max,gradient:e._config["gradient"]||e._config["defaultGradient"]})})),n.setCoordinator(a)};function o(){var o=this._config=i.merge(e,arguments[0]||{});if(this._coordinator=new a,o["plugin"]){var s=o["plugin"];if(!e.plugins[s])throw new Error("Plugin '"+s+"' not found. Maybe it was not registered.");var l=e.plugins[s];this._renderer=new l.renderer(o),this._store=new l.store(o)}else this._renderer=new n(o),this._store=new t(o);r(this)}return o.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(e){return this._config=i.merge(this._config,e),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(e){return this._store.getValueAt?this._store.getValueAt(e):this._renderer.getValueAt?this._renderer.getValueAt(e):null}},o}(),o={create:function(e){return new r(e)},register:function(t,a){e.plugins[t]=a}};return o}))},"8bbf":function(e,a){e.exports=t},a5a2:function(e,t){e.exports=a},fae3:function(e,t,a){"use strict";if(a.r(t),a.d(t,"HeatmapVis",(function(){return le})),a.d(t,"SessionRecordingVis",(function(){return St})),a.d(t,"HsrTargetTest",(function(){return kt})),a.d(t,"HsrUrlTarget",(function(){return Gt})),a.d(t,"HeatmapEdit",(function(){return ka})),a.d(t,"HeatmapList",(function(){return On})),a.d(t,"HeatmapManage",(function(){return Cn})),a.d(t,"SessionRecordingEdit",(function(){return li})),a.d(t,"SessionRecordingList",(function(){return Ki})),a.d(t,"SessionRecordingManage",(function(){return tr})),a.d(t,"ListOfPageviews",(function(){return dr})),a.d(t,"HeatmapVisPage",(function(){return Or})),a.d(t,"MatomoJsNotWritableAlert",(function(){return wn})),"undefined"!==typeof window){var n=window.document.currentScript,i=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(a.p=i[1])}var r=a("8bbf");function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var s={class:"heatmapVis"},l=["innerHTML"],c={class:"heatmapSelection"},d={style:{display:"inline","margin-right":"13.5px"}},u=["onClick"],m={style:{display:"inline","margin-left":"3rem","margin-right":"13.5px"}},p=["title","onClick"],h=["src","alt"],g=Object(r["createTextVNode"])(),f={class:"numSamples"},b={class:"legendOuter"},v={class:"legend-area"},y=Object(r["createElementVNode"])("span",{class:"min"},"0",-1),O=["src"],j=Object(r["createElementVNode"])("span",{class:"max"},"0",-1),S={class:"customIframeWidth"},_=["textContent"],H={class:"iframeRecordingContainer",ref:"iframeRecordingContainer"},V={class:"heatmapWrapper"},N={id:"heatmapContainer",ref:"heatmapContainer"},E=Object(r["createElementVNode"])("div",{class:"loadingUnderlay"},null,-1),w={class:"valign-wrapper loadingInner"},R={class:"loadingContent"},k=["title"],x=["src","width"],C={style:{"margin-top":"2rem"}},D={class:"ui-confirm",id:"confirmDeleteHeatmapScreenshot",ref:"confirmDeleteHeatmapScreenshot"},P=["value"],M=["value"];function T(e,t,a,n,i,T){var A=Object(r["resolveComponent"])("Field"),B=Object(r["resolveComponent"])("SaveButton");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",s,[e.actualNumSamples.nb_samples_device_all?(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",{key:0,innerHTML:e.$sanitize(e.recordedSamplesSince)},null,8,l)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("div",c,[Object(r["createElementVNode"])("h4",d,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_Action")),1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.heatmapTypes,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{class:Object(r["normalizeClass"])(["btn-flat",o({visActive:t.key===e.heatmapType},"heatmapType".concat(t.key),!0)]),onClick:function(a){return e.changeHeatmapType(t.key)},key:t.key},Object(r["toDisplayString"])(t.name),11,u)})),128)),Object(r["createElementVNode"])("h4",m,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_DeviceType")),1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.deviceTypesWithSamples,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{class:Object(r["normalizeClass"])(["btn-flat",o({visActive:t.key===e.deviceType},"deviceType".concat(t.key),!0)]),title:t.tooltip,onClick:function(a){return e.changeDeviceType(t.key)},key:t.key},[Object(r["createElementVNode"])("img",{height:"15",src:t.logo,alt:"".concat(e.translate("DevicesDetection_Device")," ").concat(t.name)},null,8,h),g,Object(r["createElementVNode"])("span",f,Object(r["toDisplayString"])(t.numSamples),1)],10,p)})),128)),Object(r["createElementVNode"])("div",b,[Object(r["createElementVNode"])("h4",null,Object(r["toDisplayString"])(e.translate("Installation_Legend")),1),Object(r["createElementVNode"])("div",v,[y,Object(r["createElementVNode"])("img",{class:"gradient",alt:"gradient",src:e.gradientImgData},null,8,O),j])]),Object(r["createElementVNode"])("div",S,[Object(r["createElementVNode"])("span",{style:{"margin-left":"2.5rem","margin-right":"13.5px"},textContent:Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_Width"))},null,8,_),Object(r["createVNode"])(A,{uicontrol:"select",name:"iframewidth","model-value":e.customIframeWidth,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.customIframeWidth=t,e.changeIframeWidth(e.customIframeWidth,!0)}),options:e.iframeWidthOptions},null,8,["model-value","options"])])]),Object(r["createElementVNode"])("div",H,[Object(r["createElementVNode"])("div",V,[Object(r["createElementVNode"])("div",N,null,512)]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"hsrLoadingOuter",style:Object(r["normalizeStyle"])([{height:"400px"},{width:e.iframeWidth+"px"}])},[E,Object(r["createElementVNode"])("div",w,[Object(r["createElementVNode"])("div",R,Object(r["toDisplayString"])(e.translate("General_Loading")),1)])],4),[[r["vShow"],e.isLoading]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"aboveFoldLine",title:e.translate("HeatmapSessionRecording_AvgAboveFoldDescription"),style:Object(r["normalizeStyle"])({width:e.iframeWidth+"px",top:e.avgFold+"px"})},[Object(r["createElementVNode"])("div",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_AvgAboveFoldTitle",e.avgFold)),1)],12,k),[[r["vShow"],e.avgFold]]),e.embedUrl?(Object(r["openBlock"])(),Object(r["createElementBlock"])("iframe",{key:0,id:"recordingPlayer",ref:"recordingPlayer",sandbox:"allow-scripts allow-same-origin",referrerpolicy:"no-referrer",onLoad:t[1]||(t[1]=function(t){return e.onLoaded()}),height:"400",src:e.embedUrl,width:e.iframeWidth},null,40,x)):Object(r["createCommentVNode"])("",!0)],512),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",C,[Object(r["createVNode"])(B,{style:{display:"block !important"},loading:e.isLoading,onClick:t[2]||(t[2]=function(t){return e.deleteScreenshot()}),value:e.translate("HeatmapSessionRecording_DeleteScreenshot")},null,8,["loading","value"])],512),[[r["vShow"],e.showDeleteScreenshot]]),Object(r["createElementVNode"])("div",D,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_DeleteHeatmapScreenshotConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,P),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,M)],512)])}var A=a("246e"),B=a.n(A),U=a("19dc"),I=a("a5a2");
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */
function F(e){return e&&e.contentWindow?e.contentWindow:e&&e.contentDocument&&e.contentDocument.defaultView?e.contentDocument.defaultView:void 0}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */function L(e,t){var a=null;return function(n,i){return a&&(a.abort(),a=null),a=new AbortController,U["AjaxHelper"].post(Object.assign(Object.assign({},n),{},{method:e}),i,Object.assign(Object.assign({},t),{},{abortController:a})).finally((function(){a=null}))}}function W(e,t){return J(e)||$(e,t)||z(e,t)||q()}function q(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function z(e,t){if(e){if("string"===typeof e)return G(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?G(e,t):void 0}}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function $(e,t){var a=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,r=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done);o=!0)if(r.push(n.value),t&&r.length===t)break}catch(l){s=!0,i=l}finally{try{o||null==a["return"]||a["return"]()}finally{if(s)throw i}}return r}}function J(e){if(Array.isArray(e))return e}var X=window,Y=X.$,K=1,Q=2,Z=3,ee=32e3,te=String(window.navigator.userAgent).toLowerCase();function ae(e,t,a){var n=Y(e);n.css("height","400px");var i=a.getIframeHeight();n.css("height","".concat(i,"px")),Y(t).css("height","".concat(i,"px")).css("width","".concat(n.width(),"px")).empty();for(var r=Math.ceil(i/ee),o=1;o<=r;o+=1){var s=ee;o===r&&(s=i%ee),Y(t).append('<div id="heatmap'.concat(o,'" class="heatmapTile"></div>')),Y(t).find("#heatmap".concat(o)).css({height:"".concat(s,"px")})}return r}function ne(e,t,a,n){var i=Y(t);i.css("height","400px");var r=a.getIframeHeight();i.css("height","".concat(r,"px"));var o=1e3,s=r/o,l=n.reduce((function(e,t){return e+parseInt(t.value,10)}),0),c=[],d=0,u=null,m=100,p=0;function h(e,t,a,n,i){return n+(e-t)/(a-t)*(i-n)}function g(e,t,a){if(t===a||!t&&!a)return[255,255,0];var n=h(e,t,a,0,255),i=(a-t)/5;return n>204?[255,h(e,a-i,a,255,0),0]:n>153?[h(e,a-2*i,a-i,0,255),255,0]:n>102?[0,255,h(e,a-3*i,a-2*i,255,0)]:n>51?[0,h(e,a-4*i,a-3*i,0,255),255]:[h(e,t,a-4*i,255,0),0,255]}if(n.forEach((function(e){var t=parseInt(e.value,10),a=parseInt(e.label,10),n=Math.round(a*s);u&&u.position===n?d+=t:(0!==l&&(m=(l-d)/l*100),d+=t,u={percentageValue:10*parseFloat(m.toFixed(1)),position:p,percent:m.toFixed(1)},c.push(u)),p=n})),c.length){var f=c.some((function(e){return 0===e.position}));f||c.unshift({percent:"100.0",percentageValue:1e3,position:0})}else c.push({percent:"0",percentageValue:0,position:0});var b=0,v=1e3;c&&c.length&&c[0]&&(b=c[c.length-1].percentageValue);for(var y=i.width(),O=null,j=0;j<c.length;j+=1){var S=c[j];O=c[j+1]?c[j+1]:{position:r};var _=S.position,H=O.position-S.position;0===H&&(H=1);var V="".concat(S.percent," percent reached this point"),N=g(S.percentageValue,b,v),E="rgb(".concat(N.join(","),")");Y(e).append('<div class="scrollHeatmapLeaf" title="'.concat(V,'" style="width: ').concat(y,"px;height:")+" ".concat(H,"px;left: 0;top: ").concat(_,"px; background-color: ").concat(E,';"></div>'))}Y(".scrollHeatmapLeaf",e).tooltip({track:!0,items:"*",tooltipClass:"heatmapTooltip",show:!1,hide:!1}),Y(".legend-area .min").text("".concat((b/10).toFixed(1),"%")),Y(".legend-area .max").text("".concat((v/10).toFixed(1),"%"))}function ie(e,t,a,n){var i=ae(e,t,a),r=document.createElement("canvas");r.width=100,r.height=10;var o=document.querySelector(".legend-area .min"),s=document.querySelector(".legend-area .max"),l=document.querySelector(".legend-area .gradient"),c=r.getContext("2d"),d={};function u(e){if(o.innerHTML="".concat(e.min),s.innerHTML="".concat(e.max),e.gradient&&e.gradient!==d){d=e.gradient;var t=c.createLinearGradient(0,0,100,1);Object.keys(d).forEach((function(e){t.addColorStop(parseFloat(e),d[e])})),c.fillStyle=t,c.fillRect(0,0,100,10),l.src=r.toDataURL()}}for(var m=[],p=function(e){var t={min:n.min,max:n.max,data:[]},a={container:document.getElementById("heatmap".concat(e)),radius:10,maxOpacity:.5,minOpacity:0,blur:.75};if(1===e&&(a.onExtremaChange=u),n&&n.data&&n.data.length>=2e4?a.radius=8:n&&n.data&&n.data.length>=2e3&&(a.radius=9),1===i)t.data=n.data;else{var r=(e-1)*ee,o=r+ee-1;n.data.forEach((function(e){if(e.y>=r&&e.y<=o){var a=Object.assign(Object.assign({},e),{},{y:e.y-r});t.data.push(a)}}))}var s=B.a.create(a);s.setData(t),m.push(s)},h=1;h<=i;h+=1)p(h);return m}te.match(/(iPod|iPhone|iPad|Android|IEMobile|Windows Phone)/i)?ee=2e3:(te.indexOf("msie ")>0||te.indexOf("trident/")>0||te.indexOf("edge")>0)&&(ee=8e3);var re=Object(r["defineComponent"])({props:{idSiteHsr:{type:Number,required:!0},deviceTypes:{type:Array,required:!0},heatmapTypes:{type:Array,required:!0},breakpointMobile:{type:Number,required:!0},breakpointTablet:{type:Number,required:!0},offsetAccuracy:{type:Number,required:!0},heatmapPeriod:{type:String,required:!0},heatmapDate:{type:String,required:!0},url:{type:String,required:!0},isActive:Boolean,numSamples:{type:Object,required:!0},excludedElements:{type:String,required:!0},createdDate:{type:String,required:!0},desktopPreviewSize:{type:Number,required:!0},iframeResolutionsValues:{type:Object,required:!0}},components:{Field:I["Field"],SaveButton:I["SaveButton"]},data:function(){return{isLoading:!1,iframeWidth:this.desktopPreviewSize,customIframeWidth:this.desktopPreviewSize,avgFold:0,heatmapType:this.heatmapTypes[0].key,deviceType:this.deviceTypes[0].key,iframeResolutions:this.iframeResolutionsValues,actualNumSamples:this.numSamples}},setup:function(e){var t=null,a=new Promise((function(e){t=e})),n=null,i=function(t){return n||(n=F(t).recordingFrame,n.excludeElements(e.excludedElements),n.addClass("html","piwikHeatmap"),n.addClass("html","matomoHeatmap"),n.addWorkaroundForSharepointHeatmaps()),n},o=Object(r["ref"])(null),s=function(e,t,a,n){o.value=ie(e,t,a,n)};return{iframeLoadedPromise:a,onLoaded:t,getRecordedHeatmap:L("HeatmapSessionRecording.getRecordedHeatmap"),getRecordedHeatmapMetadata:L("HeatmapSessionRecording.getRecordedHeatmapMetadata"),getRecordingIframe:i,heatmapInstances:o,renderHeatmap:s}},created:function(){-1===this.iframeResolutions.indexOf(this.breakpointMobile)&&this.iframeResolutions.push(this.breakpointMobile),-1===this.iframeResolutions.indexOf(this.breakpointTablet)&&this.iframeResolutions.push(this.breakpointTablet),this.iframeResolutions=this.iframeResolutions.sort((function(e,t){return e-t})),this.fetchHeatmap(),U["Matomo"].postEvent("hidePeriodSelector")},beforeUnmount:function(){this.removeScrollHeatmap()},methods:{removeScrollHeatmap:function(){var e=this.$refs.iframeRecordingContainer;Y(e).find(".scrollHeatmapLeaf").remove()},deleteScreenshot:function(){var e=this;U["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteHeatmapScreenshot,{yes:function(){e.isLoading=!0,U["AjaxHelper"].fetch({method:"HeatmapSessionRecording.deleteHeatmapScreenshot",idSiteHsr:e.idSiteHsr}).then((function(){e.isLoading=!1,window.location.reload()}))}})},fetchHeatmap:function(){var e=this;if(this.removeScrollHeatmap(),this.heatmapInstances){var t=this.heatmapInstances;t.forEach((function(e){e.setData({max:1,min:0,data:[]})}))}this.isLoading=!0,this.avgFold=0;var a=U["MatomoUrl"].parsed.value.segment?decodeURIComponent(U["MatomoUrl"].parsed.value.segment):void 0,n={idSiteHsr:this.idSiteHsr,heatmapType:this.heatmapType,deviceType:this.deviceType,period:this.heatmapPeriod,date:this.heatmapDate,filter_limit:-1,segment:a},i=this.getRecordedHeatmap(n),r=this.getRecordedHeatmapMetadata(n);Promise.all([i,r,this.iframeLoadedPromise]).then((function(t){var a=e.$refs.recordingPlayer,n=e.getRecordingIframe(a);ae(e.$refs.recordingPlayer,e.$refs.heatmapContainer,n),e.removeScrollHeatmap();var i=t[0],r=t[1];if(Array.isArray(r)&&r[0]){var o=W(r,1);e.actualNumSamples=o[0]}else e.actualNumSamples=r;if(e.isLoading=!1,e.isScrollHeatmapType)ne(e.$refs.iframeRecordingContainer,a,n,i);else{for(var s,l={min:0,max:0,data:[]},c=0;c<i.length;c+=1){var d=i[c];if(d.selector){var u=n.getCoordinatesInFrame(d.selector,d.offset_x,d.offset_y,e.offsetAccuracy,!0);u&&(u.value=d.value,l.data.push(u))}}if(2===e.heatmapType){var m=0;l.data.forEach((function(e){null!==e&&void 0!==e&&e.value&&parseInt(e.value,10)>1&&(m+=1)})),m/l.data.length>=.1&&l.data.length>120?l.max=2:l.max=1}else{var p=10,h={};if(l.data.forEach((function(e){if(e&&e.value){var t=parseInt(e.value,10);t>l.max&&(l.max=t),t>p&&(t=p);var a="".concat(t);a in h?h[a]+=1:h[a]=0}})),l.max>p){for(var g=0,f=p;f>1;f-=1){var b="".concat(f);if(b in h&&(g+=h[b]),g/l.data.length>=.2){l.max=f;break}}if(l.max>p){l.max=5;for(var v=5;v>0;v-=1){var y="".concat(v);if(y in h){l.max=v;break}}}}}if(e.renderHeatmap(e.$refs.recordingPlayer,e.$refs.heatmapContainer,n,l),null!==(s=e.actualNumSamples)&&void 0!==s&&s["avg_fold_device_".concat(e.deviceType)]){var O=e.actualNumSamples["avg_fold_device_".concat(e.deviceType)],j=n.getIframeHeight();j&&(e.avgFold=parseInt("".concat(O/100*j),10))}}})).finally((function(){e.isLoading=!1}))},changeDeviceType:function(e){this.deviceType=e,this.deviceType===K?this.changeIframeWidth(this.desktopPreviewSize,!1):this.deviceType===Q?this.changeIframeWidth(this.breakpointTablet||960,!1):this.deviceType===Z&&this.changeIframeWidth(this.breakpointMobile||600,!1)},changeIframeWidth:function(e,t){this.iframeWidth=e,this.customIframeWidth=this.iframeWidth,this.fetchHeatmap(),t&&U["Matomo"].helper.lazyScrollToContent()},changeHeatmapType:function(e){this.heatmapType=e,this.fetchHeatmap()}},computed:{isScrollHeatmapType:function(){return 3===this.heatmapType},tokenAuth:function(){return U["MatomoUrl"].parsed.value.token_auth},embedUrl:function(){return"?".concat(U["MatomoUrl"].stringify({module:"HeatmapSessionRecording",action:"embedPage",idSite:U["Matomo"].idSite,idSiteHsr:this.idSiteHsr,token_auth:this.tokenAuth||void 0}))},iframeWidthOptions:function(){return this.iframeResolutions.map((function(e){return{key:e,value:"".concat(e,"px")}}))},recordedSamplesSince:function(){return Object(U["translate"])("HeatmapSessionRecording_HeatmapXRecordedSamplesSince",'<span class="deviceAllCountSamples">'.concat(this.actualNumSamples.nb_samples_device_all,"</span>"),this.createdDate)},deviceTypesWithSamples:function(){var e=this;return this.deviceTypes.map((function(t){var a;a=e.actualNumSamples["nb_samples_device_".concat(t.key)]?e.actualNumSamples["nb_samples_device_".concat(t.key)]:0;var n=Object(U["translate"])("HeatmapSessionRecording_XSamples","".concat(t.name," - ").concat(a));return Object.assign(Object.assign({},t),{},{numSamples:a,tooltip:n})}))},hasWriteAccess:function(){return!(null===U["Matomo"]||void 0===U["Matomo"]||!U["Matomo"].heatmapWriteAccess)},showDeleteScreenshot:function(){return this.isActive&&this.hasWriteAccess},gradientImgData:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAKCAYAAABCHPt+AAAAnklEQVRYR+2WQQqDQBAES5wB/f8/Y05RcMWwSu6JIT0Dm4WlH1DUdHew7/z6WYFhhnGRpnlhAEaQpi/ADbh/np0MiBhGhW+2ymFU+DZfg1EhaoB4jCFuMYYcQKZrXwPEVvm5Og0pcYakBvI35G1jNIZ4jCHexxjSpz9ZFUjAynLbpOvqteaODkm9sloz5JF+ZTVmSAWSu9Qb65AvgDwBQoLgVDlWfAQAAAAASUVORK5CYII="}}});re.render=T;var oe,se,le=re,ce={class:"sessionRecordingPlayer"},de={class:"controls"},ue={class:"playerActions"},me=["title"],pe=["title"],he=["title"],ge=["title"],fe=["title"],be=["title"],ve=["title"],ye=["title"],Oe={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},je=Object(r["createElementVNode"])("path",{d:"M480 576.5v-321h-64.5v129h-63v-129h-64.5v192h127.5v129h64.5zM607.5 127.999c34.5 0\n              64.5 30 64.5 64.5v447c0 34.5-30 64.5-64.5 64.5h-447c-34.5\n              0-64.5-30-64.5-64.5v-447c0-34.5 30-64.5 64.5-64.5h447z"},null,-1),Se=[je],_e={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},He=Object(r["createElementVNode"])("path",{d:"M448.5 576.5v-321h-129v64.5h64.5v256.5h64.5zM607.5 127.999c34.5 0 64.5 30 64.5\n              64.5v447c0 34.5-30 64.5-64.5 64.5h-447c-34.5 0-64.5-30-64.5-64.5v-447c0-34.5\n              30-64.5 64.5-64.5h447z"},null,-1),Ve=[He],Ne={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},Ee=Object(r["createElementVNode"])("path",{d:"M480 384.5v-64.5c0-36-30-64.5-64.5-64.5h-127.5v64.5h127.5v64.5h-63c-34.5 0-64.5\n              27-64.5 63v129h192v-64.5h-127.5v-64.5h63c34.5 0 64.5-27 64.5-63zM607.5 127.999c34.5\n              0 64.5 30 64.5 64.5v447c0 34.5-30 64.5-64.5 64.5h-447c-34.5\n              0-64.5-30-64.5-64.5v-447c0-34.5 30-64.5 64.5-64.5h447z"},null,-1),we=[Ee],Re={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},ke=Object(r["createElementVNode"])("path",{d:"M480 320v-64.5h-127.5c-34.5 0-64.5 28.5-64.5 64.5v192c0 36 30 64.5 64.5\n              64.5h63c34.5 0 64.5-28.5 64.5-64.5v-64.5c0-36-30-63-64.5-63h-63v-64.5h127.5zM607.5\n              127.999c34.5 0 64.5 30 64.5 64.5v447c0 34.5-30 64.5-64.5 64.5h-447c-34.5\n              0-64.5-30-64.5-64.5v-447c0-34.5 30-64.5 64.5-64.5h447zM352.5 512v-64.5h63v64.5h-63z"},null,-1),xe=[ke],Ce=["title"],De=Object(r["createElementVNode"])("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},[Object(r["createElementVNode"])("path",{d:"M223.5 415.5h111l-64.5-63h-46.5v63zM72 72l624 624-42 40.5-88.5-90c-51 36-114\n              57-181.5 57-177 0-319.5-142.5-319.5-319.5 0-67.5 21-130.5 57-181.5l-90-88.5zM544.5\n              352.5h-111l-231-231c51-36 114-57 181.5-57 177 0 319.5 142.5 319.5 319.5 0 67.5-21\n              130.5-57 181.5l-148.5-150h46.5v-63z"})],-1),Pe=[De],Me=["title"],Te=Object(r["createElementVNode"])("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 768 768"},[Object(r["createElementVNode"])("path",{d:"M544.5 609v-129h63v192h-384v96l-127.5-127.5 127.5-127.5v96h321zM223.5\n              288v129h-63v-192h384v-96l127.5 127.5-127.5 127.5v-96h-321z"})],-1),Ae=[Te],Be={class:"duration"},Ue={class:"playerHelp"},Ie=Object(r["createElementVNode"])("span",{class:"clickEvent"},null,-1),Fe=Object(r["createElementVNode"])("span",{class:"moveEvent"},null,-1),Le=Object(r["createElementVNode"])("span",{class:"scrollEvent"},null,-1),We=Object(r["createElementVNode"])("span",{class:"resizeEvent"},null,-1),qe=Object(r["createElementVNode"])("span",{class:"formChange"},null,-1),ze=Object(r["createElementVNode"])("span",{class:"mutationEvent"},null,-1),Ge=Object(r["createElementVNode"])("br",{style:{clear:"right"}},null,-1),$e=["title"],Je=Object(r["createElementVNode"])("br",null,null,-1),Xe=Object(r["createElementVNode"])("div",{class:"loadingUnderlay"},null,-1),Ye={class:"valign-wrapper loadingInner"},Ke={class:"loadingContent"},Qe=["src","width","height"];function Ze(e,t,a,n,i,o){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ce,[Object(r["createElementVNode"])("div",de,[Object(r["createElementVNode"])("span",ue,[Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"playerAction icon-skip-previous",title:e.skipPreviousButtonTitle,onClick:t[0]||(t[0]=function(t){return e.loadNewRecording(e.previousRecordingId)})},null,8,me),[[r["vShow"],e.previousRecordingId]]),Object(r["createElementVNode"])("span",{class:"playerAction icon-fast-rewind",title:e.translate("HeatmapSessionRecording_PlayerRewindFast",10,"J"),onClick:t[1]||(t[1]=function(t){return e.jumpRelative(10,!1)})},null,8,pe),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"playerAction icon-play",title:e.translate("HeatmapSessionRecording_PlayerPlay","K"),onClick:t[2]||(t[2]=function(t){return e.play()})},null,8,he),[[r["vShow"],!e.isPlaying&&!e.isFinished]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"playerAction icon-replay",title:e.translate("HeatmapSessionRecording_PlayerReplay","K"),onClick:t[3]||(t[3]=function(t){return e.replay()})},null,8,ge),[[r["vShow"],!e.isPlaying&&e.isFinished]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"playerAction icon-pause",title:e.translate("HeatmapSessionRecording_PlayerPause","K"),onClick:t[4]||(t[4]=function(t){return e.pause()})},null,8,fe),[[r["vShow"],e.isPlaying]]),Object(r["createElementVNode"])("span",{class:"playerAction icon-fast-forward",title:e.translate("HeatmapSessionRecording_PlayerForwardFast",10,"L"),onClick:t[5]||(t[5]=function(t){return e.jumpRelative(10,!0)})},null,8,be),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"playerAction icon-skip-next",title:e.translate("HeatmapSessionRecording_PlayerPageViewNext",e.nextRecordingInfo,"N"),onClick:t[6]||(t[6]=function(t){return e.loadNewRecording(e.nextRecordingId)})},null,8,ve),[[r["vShow"],e.nextRecordingId]]),Object(r["createElementVNode"])("span",{class:"changeReplaySpeed",title:e.translate("HeatmapSessionRecording_ChangeReplaySpeed","S"),onClick:t[7]||(t[7]=function(t){return e.increaseReplaySpeed()})},[Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("svg",Oe,Se,512)),[[r["vShow"],4===e.actualReplaySpeed]]),Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("svg",_e,Ve,512)),[[r["vShow"],1===e.actualReplaySpeed]]),Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("svg",Ne,we,512)),[[r["vShow"],2===e.actualReplaySpeed]]),Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("svg",Re,xe,512)),[[r["vShow"],6===e.actualReplaySpeed]])],8,ye),Object(r["createElementVNode"])("span",{class:Object(r["normalizeClass"])(["toggleSkipPause",{active:e.actualSkipPausesEnabled}]),title:e.translate("HeatmapSessionRecording_ClickToSkipPauses",e.skipPausesEnabledText,"B"),onClick:t[8]||(t[8]=function(t){return e.toggleSkipPauses()})},Pe,10,Ce),Object(r["createElementVNode"])("span",{class:Object(r["normalizeClass"])(["toggleAutoPlay",{active:e.actualAutoPlayEnabled}]),title:e.translate("HeatmapSessionRecording_AutoPlayNextPageview",e.autoplayEnabledText,"A"),onClick:t[9]||(t[9]=function(t){return e.toggleAutoPlay()})},Ae,10,Me),Object(r["createElementVNode"])("span",Be,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_PlayerDurationXofY",e.positionPretty,e.durationPretty)),1)]),Object(r["createElementVNode"])("div",Ue,[Object(r["createElementVNode"])("ul",null,[Object(r["createElementVNode"])("li",null,[Ie,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityClick")),1)]),Object(r["createElementVNode"])("li",null,[Fe,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityMove")),1)]),Object(r["createElementVNode"])("li",null,[Le,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityScroll")),1)]),Object(r["createElementVNode"])("li",null,[We,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityResize")),1)]),Object(r["createElementVNode"])("li",null,[qe,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityFormChange")),1)]),Object(r["createElementVNode"])("li",null,[ze,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityPageChange")),1)])])]),Ge]),Object(r["createElementVNode"])("div",{class:"timelineOuter",onClick:t[10]||(t[10]=function(t){return e.seekEvent(t)}),style:Object(r["normalizeStyle"])({width:"".concat(e.replayWidth,"px")})},[Object(r["createElementVNode"])("div",{class:"timelineInner",style:Object(r["normalizeStyle"])({width:"".concat(e.progress,"%")})},null,4),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.clues,(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{title:e.title,class:Object(r["normalizeClass"])(e.type),style:Object(r["normalizeStyle"])({left:"".concat(e.left,"%")}),key:t},null,14,$e)})),128))],4),Je,Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"hsrLoadingOuter",style:Object(r["normalizeStyle"])({width:"".concat(e.replayWidth,"px"),height:"".concat(e.replayHeight,"px")})},[Xe,Object(r["createElementVNode"])("div",Ye,[Object(r["createElementVNode"])("div",Ke,Object(r["toDisplayString"])(e.translate("General_Loading")),1)])],4),[[r["vShow"],e.isLoading]]),Object(r["createElementVNode"])("div",{class:"replayContainerOuter",onClick:t[12]||(t[12]=function(t){return e.togglePlay()}),style:Object(r["normalizeStyle"])({height:"".concat(e.replayHeight,"px"),width:"".concat(e.replayWidth,"px")})},[Object(r["createElementVNode"])("div",{class:"replayContainerInner",style:Object(r["normalizeStyle"])([{"transform-origin":"0 0"},{transform:"scale(".concat(e.replayScale,")"),"margin-left":"".concat(e.replayMarginLeft,"px")}])},[e.embedUrl?(Object(r["openBlock"])(),Object(r["createElementBlock"])("iframe",{key:0,id:"recordingPlayer",ref:"recordingPlayer",onLoad:t[11]||(t[11]=function(t){return e.onLoaded()}),scrolling:"no",sandbox:"allow-scripts allow-same-origin",referrerpolicy:"no-referrer",src:e.embedUrl,width:e.recording.viewport_w_px,height:e.recording.viewport_h_px},null,40,Qe)):Object(r["createCommentVNode"])("",!0)],4)],4)])}function et(e){return et="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},et(e)}function tt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var at=20,nt=1,it=2,rt=3,ot=4,st=5,lt=6,ct=9,dt=10,ut=12,mt=(oe={},tt(oe,it,"clickEvent"),tt(oe,nt,"moveEvent"),tt(oe,rt,"scrollEvent"),tt(oe,ut,"scrollEvent"),tt(oe,ot,"resizeEvent"),tt(oe,ct,"formChange"),tt(oe,dt,"formChange"),tt(oe,st,"mutationEvent"),tt(oe,lt,"mutationEvent"),oe),pt=(se={},tt(se,it,Object(U["translate"])("HeatmapSessionRecording_ActivityClick")),tt(se,nt,Object(U["translate"])("HeatmapSessionRecording_ActivityMove")),tt(se,rt,Object(U["translate"])("HeatmapSessionRecording_ActivityScroll")),tt(se,ut,Object(U["translate"])("HeatmapSessionRecording_ActivityScroll")),tt(se,ot,Object(U["translate"])("HeatmapSessionRecording_ActivityResize")),tt(se,ct,Object(U["translate"])("HeatmapSessionRecording_ActivityFormChange")),tt(se,dt,Object(U["translate"])("HeatmapSessionRecording_ActivityFormChange")),tt(se,st,Object(U["translate"])("HeatmapSessionRecording_ActivityPageChange")),tt(se,lt,Object(U["translate"])("HeatmapSessionRecording_ActivityPageChange")),se),ht='\n<div class="mousePointer" style="width: 16px;height: 16px;position: absolute;z-index: 99999999;">\n    <svg enable-background="new 0 0 24 24" fill="black" stroke="white" version="1.0"\n        viewBox="0 0 24 24" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"\n        xmlns:xlink="http://www.w3.org/1999/xlink">\n        <path d="M7,2l12,11.2l-5.8,0.5l3.3,7.3l-2.2,1l-3.2-7.4L7,18.5V2"/>\n    </svg>\n</div>\n',gt=window,ft=gt.$,bt=gt.Mousetrap;function vt(e){return"number"===typeof e?e:parseInt(e,10)}function yt(e){if(null!==e&&void 0!==e&&e.event_type)return vt(e.event_type)}function Ot(e){var t=Math.floor(e/1e3),a=Math.floor(t/60),n=t%60;return a<10&&(a="0".concat(a)),n<10&&(n="0".concat(n)),"".concat(a,":").concat(n)}var jt=Object(r["defineComponent"])({props:{offsetAccuracy:{type:Number,required:!0},scrollAccuracy:{type:Number,required:!0},autoPlayEnabled:Boolean,skipPausesEnabled:Boolean,replaySpeed:{type:Number,default:1}},data:function(){return{isPlaying:!1,progress:0,isFinished:!1,isLoading:!0,seekTimeout:null,lastFramePainted:0,recording:JSON.parse(JSON.stringify(window.sessionRecordingData)),positionPretty:"00:00",previousRecordingId:null,previousRecordingInfo:null,nextRecordingId:null,nextRecordingInfo:null,frame:0,hasFoundPrevious:!1,hasFoundNext:!1,videoPlayerInterval:null,lastCanvasCoordinates:!1,actualAutoPlayEnabled:!!this.autoPlayEnabled,replayWidth:0,replayHeight:0,replayScale:0,replayMarginLeft:0,seek:function(e){return e},actualSkipPausesEnabled:!!this.skipPausesEnabled,actualReplaySpeed:this.replaySpeed}},setup:function(){var e=Object(r["ref"])(!1),t=null,a=new Promise((function(a){t=a,e.value=!0})),n=function(){setTimeout((function(){t("loaded")}),500)};return{iframeLoadedPromise:a,onLoaded:n,iframeLoaded:e}},created:function(){var e=this;this.recording.duration=vt(this.recording.duration),this.recording.pageviews.forEach((function(t){t&&t.idloghsr&&("".concat(t.idloghsr)==="".concat(e.recording.idLogHsr)?e.hasFoundPrevious=!0:e.hasFoundPrevious?e.hasFoundNext||(e.hasFoundNext=!0,e.nextRecordingId=t.idloghsr,e.nextRecordingInfo=[t.label,t.server_time_pretty,t.time_on_page_pretty].join(" - ")):(e.previousRecordingId=t.idloghsr,e.previousRecordingInfo=[t.label,t.server_time_pretty,t.time_on_page_pretty].join(" - ")))}))},mounted:function(){var e=this;bt.bind(["space","k"],(function(){e.togglePlay()})),bt.bind("0",(function(){e.isFinished&&e.replay()})),bt.bind("p",(function(){e.loadNewRecording(e.previousRecordingId)})),bt.bind("n",(function(){e.loadNewRecording(e.nextRecordingId)})),bt.bind("s",(function(){e.increaseReplaySpeed()})),bt.bind("a",(function(){e.toggleAutoPlay()})),bt.bind("b",(function(){e.toggleSkipPauses()})),bt.bind("left",(function(){var t=5,a=!1;e.jumpRelative(t,a)})),bt.bind("right",(function(){var t=5,a=!0;e.jumpRelative(t,a)})),bt.bind("j",(function(){var t=10,a=!1;e.jumpRelative(t,a)})),bt.bind("l",(function(){var t=10,a=!0;e.jumpRelative(t,a)})),this.initViewport(),ft(window).on("resize",(function(){return e.initViewport()})),this.iframeLoadedPromise.then((function(){e.initPlayer()})),window.addEventListener("beforeunload",(function(){e.isPlaying=!1,e.videoPlayerInterval&&(clearInterval(e.videoPlayerInterval),e.videoPlayerInterval=null)}))},methods:{initPlayer:function(){var e=this,t=this.$refs.recordingPlayer,a=F(t).recordingFrame;if(a&&a.isSupportedBrowser()){a.addClass("html","piwikSessionRecording"),a.addClass("html","matomoSessionRecording");var n=null,i=function(t,i){n&&n.css({left:"".concat(t.x-8,"px"),top:"".concat(t.y-8,"px")}),e.lastCanvasCoordinates&&(a.drawLine(e.lastCanvasCoordinates.x,e.lastCanvasCoordinates.y,t.x,t.y,i),e.lastCanvasCoordinates=t)},r=function(t,r){if(e.lastCanvasCoordinates&&n){var o=a.getScrollTop(),s=a.getScrollLeft();a.scrollTo(t,r);var l=r-o,c=t-s,d=c+e.lastCanvasCoordinates.x,u=l+e.lastCanvasCoordinates.y;d<=0&&(d=0),u<=0&&(u=0),i({x:d,y:u},"blue")}else a.scrollTo(t,r)},o=function(e,t,a){null!==e&&void 0!==e&&e.scrollTo?e.scrollTo(t,a):(e.scrollLeft=t,e.scrollTop=a)},s=null,l=function(t){var n=e.isPlaying;e.isPlaying=!1;var i=yt(t),l=null;if(i===nt)t.selector&&(l=a.getCoordinatesInFrame(t.selector,t.x,t.y,e.offsetAccuracy,!1),l&&s(l));else if(i===it)t.selector&&(l=a.getCoordinatesInFrame(t.selector,t.x,t.y,e.offsetAccuracy,!1),l&&(s(l),a.drawCircle(l.x,l.y,"#ff9407")));else if(i===lt)t.text&&a.applyMutation(t.text);else if(i===rt){var c=a.getIframeHeight(),d=a.getIframeWidth(),u=parseInt("".concat(c/e.scrollAccuracy*vt(t.y)),10),m=parseInt("".concat(d/e.scrollAccuracy*vt(t.x)),10);r(m,u)}else if(i===ut){if(t.selector){var p=a.findElement(t.selector);if(p&&p.length&&p[0]){var h=Math.max(p[0].scrollHeight,p[0].offsetHeight,p.height(),0),g=Math.max(p[0].scrollWidth,p[0].offsetWidth,p.width(),0);if(h&&g){var f=parseInt("".concat(h/e.scrollAccuracy*vt(t.y)),10),b=parseInt("".concat(g/e.scrollAccuracy*vt(t.x)),10);o(p[0],b,f)}}}}else if(i===ot)e.setViewportResolution(t.x,t.y);else if(i===ct){if(t.selector){var v=a.findElement(t.selector);if(v.length){var y=v.attr("type");y&&"file"==="".concat(y).toLowerCase()||v.val(t.text).change()}}}else if(i===dt&&t.selector){var O=a.findElement(t.selector);O.is("input")?O.prop("checked",1===t.text||"1"===t.text):O.is("select")&&O.val(t.text).change()}e.isPlaying=n};s=function(t){var r=function(){var t=a.getIframeWidth(),n=a.getIframeHeight();a.makeSvg(t,n);for(var i=function(t){if(!e.timeFrameBuckets[t])return{v:void 0};e.timeFrameBuckets[t].forEach((function(a){var n=yt(a);n!==nt&&n!==rt&&n!==ut&&n!==it||(e.lastFramePainted=t,l(a))}))},r=0;r<=e.frame;r+=at){var o=i(r);if("object"===et(o))return o.v}},o=a.getIframeWindow();if(!e.lastCanvasCoordinates){var s=a.getIframeHeight(),c=a.getIframeWidth();return a.appendContent(ht),n=a.findElement(".mousePointer"),a.makeSvg(c,s),o.removeEventListener("resize",r,!1),o.addEventListener("resize",r,!1),e.lastCanvasCoordinates=t,void n.css({left:"".concat(t.x-8,"px"),top:"".concat(t.y-8,"px")})}var d=a.getScrollTop(),u=a.getScrollLeft();(t.y>d+vt(e.recording.viewport_h_px)||t.y<d)&&a.scrollTo(u,t.y-10),d=a.getScrollTop(),(t.x>u+vt(e.recording.viewport_w_px)||t.x<u)&&a.scrollTo(t.x-10,d),i(t,"#ff9407")},this.seek=function(t){if(e.iframeLoaded){e.isLoading=!0;var n=e.frame,i=function(t){for(var a=function(t){(e.timeFrameBuckets[t]||[]).forEach((function(a){e.lastFramePainted=t,l(a)}))},n=t;n<=e.frame;n+=at)a(n)};e.isFinished=!1,e.frame=t-t%at,e.progress=parseFloat(parseFloat("".concat(e.frame/vt(e.recording.duration)*100)).toFixed(2)),e.positionPretty=Ot(e.frame),n>e.frame?(n=0,e.lastCanvasCoordinates=!1,e.initialMutation&&a.initialMutation(e.initialMutation.text),a.scrollTo(0,0),e.setViewportResolution(window.sessionRecordingData.viewport_w_px,window.sessionRecordingData.viewport_h_px),e.seekTimeout&&(clearTimeout(e.seekTimeout),e.seekTimeout=null),function(t){e.seekTimeout=setTimeout((function(){i(t),e.isLoading=!1}),1050)}(n)):(e.seekTimeout&&(clearTimeout(e.seekTimeout),e.seekTimeout=null),i(n),e.isLoading=!1)}},this.isLoading=!1,this.isPlaying=!0;var c=0,d=function(){if(e.isPlaying&&!e.isLoading){c+=1;var t=vt(e.recording.duration);if(e.frame>=t?(e.isPlaying=!1,e.progress=100,e.isFinished=!0,e.positionPretty=e.durationPretty,e.actualAutoPlayEnabled&&e.nextRecordingId&&e.loadNewRecording(e.nextRecordingId)):(e.progress=parseFloat(parseFloat("".concat(e.frame/t*100)).toFixed(2)),20===c&&(c=0,e.positionPretty=Ot(e.frame))),(e.timeFrameBuckets[e.frame]||[]).forEach((function(t){e.lastFramePainted=e.frame,l(t)})),e.actualSkipPausesEnabled&&e.frame-e.lastFramePainted>1800){var a=Object.keys(e.timeFrameBuckets).map((function(e){return parseInt(e,10)}));a=a.sort((function(e,t){return e-t}));var n=a.find((function(t){return t>e.frame})),i=!!n;if(n){var r=n-e.frame>1e3;r&&(e.frame=n-20*at)}if(!i){var o=t-e.frame>1e3;o&&(e.frame=t-20*at)}}e.frame+=at}};this.videoPlayerInterval=setInterval((function(){for(var t=1;t<=e.actualReplaySpeed;t+=1)d()}),at)}},initViewport:function(){this.replayHeight=ft(window).height()-48-ft(".sessionRecording .sessionRecordingHead").outerHeight(!0)-ft(".sessionRecordingPlayer .controls").outerHeight(!0),this.replayWidth=ft(window).width()-48;var e=vt(this.recording.viewport_w_px),t=vt(this.recording.viewport_h_px),a=400;this.replayWidth<a&&e>a&&(this.replayWidth=a);var n=400;this.replayHeight<n&&t>n&&(this.replayHeight=n);var i=1,r=1;e>this.replayWidth&&(i=parseFloat(parseFloat("".concat(this.replayWidth/e)).toFixed(4))),t>this.replayHeight&&(r=parseFloat(parseFloat("".concat(this.replayHeight/t)).toFixed(4))),this.replayScale=Math.min(i,r),this.replayMarginLeft=(this.replayWidth-this.replayScale*e)/2},setViewportResolution:function(e,t){this.recording.viewport_w_px=parseInt("".concat(e),10),this.recording.viewport_h_px=parseInt("".concat(t),10),ft(".recordingWidth").text(e),ft(".recordingHeight").text(t),this.initViewport()},increaseReplaySpeed:function(){1===this.actualReplaySpeed?this.actualReplaySpeed=2:2===this.actualReplaySpeed?this.actualReplaySpeed=4:4===this.actualReplaySpeed?this.actualReplaySpeed=6:this.actualReplaySpeed=1,this.updateSettings()},updateSettings:function(){U["AjaxHelper"].fetch({module:"HeatmapSessionRecording",action:"saveSessionRecordingSettings",autoplay:this.actualAutoPlayEnabled?1:0,skippauses:this.actualSkipPausesEnabled?1:0,replayspeed:this.actualReplaySpeed},{format:"html"})},toggleAutoPlay:function(){this.actualAutoPlayEnabled=!this.actualAutoPlayEnabled,this.updateSettings()},toggleSkipPauses:function(){this.actualSkipPausesEnabled=!this.actualSkipPausesEnabled,this.updateSettings()},loadNewRecording:function(e){e&&(this.isPlaying=!1,U["MatomoUrl"].updateUrl(Object.assign(Object.assign({},U["MatomoUrl"].urlParsed.value),{},{idLogHsr:parseInt("".concat(e),10),updated:U["MatomoUrl"].urlParsed.value.updated?parseInt(U["MatomoUrl"].urlParsed.value.updated,10)+1:1})))},jumpRelative:function(e,t){var a,n=1e3*e;t?(a=this.frame+n,a>this.recording.duration&&(a=vt(this.recording.duration)-at)):(a=this.frame-n,a<0&&(a=0)),this.seek(a)},replay:function(){this.isFinished=!1,this.lastFramePainted=0,this.seek(0),this.play()},pause:function(){this.isPlaying=!1},togglePlay:function(){this.isFinished?this.replay():this.isPlaying?this.pause():this.play()},seekEvent:function(e){var t=ft(e.currentTarget).offset(),a=e.pageX-t.left,n=this.replayWidth,i=a/n,r=vt(this.recording.duration)*i;this.seek(r)},play:function(){this.isPlaying=!0}},computed:{durationPretty:function(){return Ot(vt(this.recording.duration))},embedUrl:function(){return"?".concat(U["MatomoUrl"].stringify({module:"HeatmapSessionRecording",action:"embedPage",idSite:this.recording.idSite,idLogHsr:this.recording.idLogHsr,idSiteHsr:this.recording.idSiteHsr,token_auth:U["MatomoUrl"].urlParsed.value.token_auth||void 0}))},skipPreviousButtonTitle:function(){return Object(U["translate"])("HeatmapSessionRecording_PlayerPageViewPrevious",this.previousRecordingInfo||"","P")},skipPausesEnabledText:function(){return this.actualSkipPausesEnabled?Object(U["translate"])("HeatmapSessionRecording_disable"):Object(U["translate"])("HeatmapSessionRecording_enable")},autoplayEnabledText:function(){return this.actualAutoPlayEnabled?Object(U["translate"])("HeatmapSessionRecording_disable"):Object(U["translate"])("HeatmapSessionRecording_enable")},recordingEvents:function(){return this.recording?this.recording.events.map((function(e){var t=yt(e),a=e.text;return t!==st&&t!==lt||"string"!==typeof a||(a=JSON.parse(a)),Object.assign(Object.assign({},e),{},{text:a})})):[]},initialMutation:function(){var e=this.recordingEvents.find((function(e){var t=yt(e),a=t===st||t===lt,n=a&&(t===st||!e.time_since_load||"0"===e.time_since_load);return n}));return e},timeFrameBuckets:function(){var e=this,t={};return this.recordingEvents.forEach((function(a){if(a!==e.initialMutation){var n=Math.round(vt(a.time_since_load)/at)*at;t[n]=t[n]||[],t[n].push(a)}})),t},clues:function(){var e=this,t=[];return this.recordingEvents.forEach((function(a){if(a!==e.initialMutation){var n=yt(a),i=mt[n]||"",r=pt[n]||"";if(i){if((0===a.time_since_load||"0"===a.time_since_load)&&"moveEvent"===i)return;t.push({left:parseFloat("".concat(vt(a.time_since_load)/vt(e.recording.duration)*100)).toFixed(2),type:i,title:r})}}})),t}}});jt.render=Ze;var St=jt,_t={class:"form-group hsrTargetTest"},Ht={class:"loadingPiwik loadingMatchingSteps"},Vt=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif",alt:""},null,-1),Nt=Object(r["createElementVNode"])("div",{id:"hsrTargetValidationError"},null,-1);function Et(e,t,a,n,i,o){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",_t,[Object(r["createElementVNode"])("label",null,[Object(r["createElementVNode"])("strong",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestTitle"))+":",1),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestLabel")),1)]),Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"text",id:"urltargettest",placeholder:"http://www.example.com/","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.url=t}),class:Object(r["normalizeClass"])({invalid:e.url&&!e.matches&&e.isValid})},null,2),[[r["vModelText"],e.url]]),Object(r["createElementVNode"])("div",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"testInfo"},Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestErrorInvalidUrl")),513),[[r["vShow"],e.url&&!e.isValid]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"testInfo matches"},Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestUrlMatches")),513),[[r["vShow"],e.url&&e.matches&&e.isValid]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"testInfo notMatches"},Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestUrlNotMatches")),513),[[r["vShow"],e.url&&!e.matches&&e.isValid]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",Ht,[Vt,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)],512),[[r["vShow"],e.isLoadingTestMatchPage]])]),Nt])}function wt(e){return e.indexOf("://")>3}var Rt=Object(r["defineComponent"])({props:{includedTargets:Array},data:function(){return{url:"",matches:!1,isLoadingTestMatchPage:!1}},watch:{isValid:function(e){e||(this.matches=!1)},includedTargets:function(){this.runTest()},url:function(){this.runTest()}},setup:function(){return{testUrlMatchPages:L("HeatmapSessionRecording.testUrlMatchPages",{errorElement:"#hsrTargetValidationError"})}},created:function(){this.runTest=Object(U["debounce"])(this.runTest,200)},methods:{checkIsMatchingUrl:function(){var e=this;if(this.isValid){var t=this.targetUrl,a=this.filteredIncludedTargets;null!==a&&void 0!==a&&a.length&&(this.isLoadingTestMatchPage=!0,this.testUrlMatchPages({url:t},{matchPageRules:a}).then((function(t){var a;null!==(a=e.filteredIncludedTargets)&&void 0!==a&&a.length&&(null===t||void 0===t?void 0:t.url)===e.targetUrl&&(e.matches=t.matches)})).finally((function(){e.isLoadingTestMatchPage=!1})))}},runTest:function(){this.isValid&&this.checkIsMatchingUrl()}},computed:{targetUrl:function(){return(this.url||"").trim()},isValid:function(){return this.targetUrl&&wt(this.targetUrl)},filteredIncludedTargets:function(){if(this.includedTargets)return this.includedTargets.filter((function(e){return(null===e||void 0===e?void 0:e.value)||"any"===(null===e||void 0===e?void 0:e.type)})).map((function(e){return Object.assign(Object.assign({},e),{},{value:e.value?e.value.trim():""})}))}}});Rt.render=Et;var kt=Rt,xt={style:{width:"100%"}},Ct={name:"targetAttribute"},Dt={name:"targetType"},Pt={name:"targetValue"},Mt={name:"targetValue2"},Tt=["title"],At=["title"];function Bt(e,t,a,n,i,o){var s=Object(r["resolveComponent"])("Field");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:Object(r["normalizeClass"])(["form-group hsrUrltarget valign-wrapper",{disabled:e.disableIfNoValue&&!e.modelValue.value}])},[Object(r["createElementVNode"])("div",xt,[Object(r["createElementVNode"])("div",Ct,[Object(r["createVNode"])(s,{uicontrol:"select",name:"targetAttribute","model-value":e.modelValue.attribute,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},{attribute:t}))}),title:e.translate("HeatmapSessionRecording_Rule"),options:e.targetAttributes,"full-width":!0},null,8,["model-value","title","options"])]),Object(r["createElementVNode"])("div",Dt,[Object(r["createVNode"])(s,{uicontrol:"select",name:"targetType","model-value":e.pattern_type,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.onTypeChange(t)}),options:e.targetOptions[e.modelValue.attribute],"full-width":!0},null,8,["model-value","options"])]),Object(r["createElementVNode"])("div",Pt,[Object(r["withDirectives"])(Object(r["createVNode"])(s,{uicontrol:"text",name:"targetValue",placeholder:"eg. ".concat(e.targetExamples[e.modelValue.attribute]),"model-value":e.modelValue.value,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},{value:t.trim()}))}),maxlength:500,"full-width":!0},null,8,["placeholder","model-value"]),[[r["vShow"],"any"!==e.pattern_type]])]),Object(r["createElementVNode"])("div",Mt,[Object(r["withDirectives"])(Object(r["createVNode"])(s,{uicontrol:"text",name:"targetValue2","model-value":e.modelValue.value2,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},{value2:t.trim()}))}),maxlength:500,"full-width":!0,placeholder:e.translate("HeatmapSessionRecording_UrlParameterValueToMatchPlaceholder")},null,8,["model-value","placeholder"]),[[r["vShow"],"urlparam"===e.modelValue.attribute&&e.pattern_type&&"exists"!==e.pattern_type&&"not_exists"!==e.pattern_type]])])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"icon-plus valign",title:e.translate("General_Add"),onClick:t[4]||(t[4]=function(t){return e.$emit("addUrl")})},null,8,Tt),[[r["vShow"],e.showAddUrl]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"icon-minus valign",title:e.translate("General_Remove"),onClick:t[5]||(t[5]=function(t){return e.$emit("removeUrl")})},null,8,At),[[r["vShow"],e.canBeRemoved]])],2)}function Ut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function It(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ft(e,t,a){return t&&It(e.prototype,t),a&&It(e,a),e}function Lt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */var Wt=function(){function e(){var t=this;Ut(this,e),Lt(this,"privateState",Object(r["reactive"])({rules:[]})),Lt(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(t.privateState)}))),Lt(this,"rules",Object(r["computed"])((function(){return t.state.value.rules}))),Lt(this,"initPromise",null)}return Ft(e,[{key:"init",value:function(){var e=this;return this.initPromise||(this.initPromise=U["AjaxHelper"].fetch({method:"HeatmapSessionRecording.getAvailableTargetPageRules",filter_limit:"-1"}).then((function(t){return e.privateState.rules=t,e.rules.value}))),this.initPromise}}]),e}(),qt=new Wt,zt=Object(r["defineComponent"])({props:{modelValue:{type:Object,required:!0},canBeRemoved:Boolean,disableIfNoValue:Boolean,allowAny:Boolean,showAddUrl:Boolean},components:{Field:I["Field"]},emits:["addUrl","removeUrl","update:modelValue"],created:function(){qt.init()},watch:{modelValue:function(e){var t=this;if(e.attribute){var a=this.targetOptions[e.attribute],n=a.find((function(e){return e.key===t.pattern_type}));!n&&a[0]&&this.onTypeChange(a[0].key)}}},computed:{pattern_type:function(){var e=this.modelValue.type;return this.modelValue.inverted&&"0"!==this.modelValue.inverted&&(e="not_".concat(this.modelValue.type)),e},targetAttributes:function(){return qt.rules.value.map((function(e){return{key:e.value,value:e.name}}))},targetOptions:function(){var e=this,t={};return qt.rules.value.forEach((function(a){t[a.value]=[],e.allowAny&&"url"===a.value&&t[a.value].push({value:Object(U["translate"])("HeatmapSessionRecording_TargetTypeIsAny"),key:"any"}),a.types.forEach((function(e){t[a.value].push({value:e.name,key:e.value}),t[a.value].push({value:Object(U["translate"])("HeatmapSessionRecording_TargetTypeIsNot",e.name),key:"not_".concat(e.value)})}))})),t},targetExamples:function(){var e={};return qt.rules.value.forEach((function(t){e[t.value]=t.example})),e}},methods:{onTypeChange:function(e){var t=0,a=e;0===e.indexOf("not_")&&(a=e.substring("not_".length),t=1),this.$emit("update:modelValue",Object.assign(Object.assign({},this.modelValue),{},{type:a,inverted:t}))}}});zt.render=Bt;var Gt=zt,$t={class:"loadingPiwik"},Jt=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Xt={class:"loadingPiwik"},Yt=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Kt={name:"name"},Qt={name:"sampleLimit"},Zt={class:"form-group row"},ea={class:"col s12"},ta={class:"col s12 m6",style:{"padding-left":"0"}},aa=Object(r["createElementVNode"])("hr",null,null,-1),na={class:"col s12 m6"},ia={class:"form-help"},ra={class:"inline-help"},oa={name:"sampleRate"},sa={name:"excludedElements"},la={name:"screenshotUrl"},ca={name:"breakpointMobile"},da={name:"breakpointTablet"},ua={name:"trackManually"},ma=["innerHTML"],pa={class:"entityCancel"};function ha(e,t,a,n,i,o){var s=Object(r["resolveComponent"])("Field"),l=Object(r["resolveComponent"])("HsrUrlTarget"),c=Object(r["resolveComponent"])("HsrTargetTest"),d=Object(r["resolveComponent"])("SaveButton"),u=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createBlock"])(u,{class:"editHsr","content-title":e.contentTitle},{default:Object(r["withCtx"])((function(){return[Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",$t,[Jt,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[r["vShow"],e.isLoading]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",Xt,[Yt,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_UpdatingData")),1)])],512),[[r["vShow"],e.isUpdating]]),Object(r["createElementVNode"])("form",{onSubmit:t[12]||(t[12]=function(t){return e.edit?e.updateHsr():e.createHsr()})},[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",Kt,[Object(r["createVNode"])(s,{uicontrol:"text",name:"name","model-value":e.siteHsr.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.siteHsr.name=t,e.setValueHasChanged()}),title:e.translate("General_Name"),maxlength:50,placeholder:e.translate("HeatmapSessionRecording_FieldNamePlaceholder"),"inline-help":e.translate("HeatmapSessionRecording_HeatmapNameHelp")},null,8,["model-value","title","placeholder","inline-help"])]),Object(r["createElementVNode"])("div",Qt,[Object(r["createVNode"])(s,{uicontrol:"select",name:"sampleLimit","model-value":e.siteHsr.sample_limit,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.siteHsr.sample_limit=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_HeatmapSampleLimit"),options:e.sampleLimits,"inline-help":e.translate("HeatmapSessionRecording_HeatmapSampleLimitHelp")},null,8,["model-value","title","options","inline-help"])]),Object(r["createElementVNode"])("div",Zt,[Object(r["createElementVNode"])("div",ea,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPage"))+":",1)]),Object(r["createElementVNode"])("div",ta,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.siteHsr.match_page_rules,(function(a,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:Object(r["normalizeClass"])("matchPageRules ".concat(n," multiple")),key:n},[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{"model-value":a,"onUpdate:modelValue":function(t){return e.setMatchPageRule(t,n)},onAddUrl:t[2]||(t[2]=function(t){return e.addMatchPageRule()}),onRemoveUrl:function(t){return e.removeMatchPageRule(n)},onAnyChange:t[3]||(t[3]=function(t){return e.setValueHasChanged()}),"allow-any":!1,"disable-if-no-value":n>0,"can-be-removed":n>0,"show-add-url":!0},null,8,["model-value","onUpdate:modelValue","onRemoveUrl","disable-if-no-value","can-be-removed"])]),aa],2)})),128))]),Object(r["createElementVNode"])("div",na,[Object(r["createElementVNode"])("div",ia,[Object(r["createElementVNode"])("span",ra,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_FieldIncludedTargetsHelp"))+" ",1),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{"included-targets":e.siteHsr.match_page_rules},null,8,["included-targets"])])])])])]),Object(r["createElementVNode"])("div",oa,[Object(r["createVNode"])(s,{uicontrol:"select",name:"sampleRate","model-value":e.siteHsr.sample_rate,"onUpdate:modelValue":t[4]||(t[4]=function(t){e.siteHsr.sample_rate=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_SampleRate"),options:e.sampleRates,introduction:e.translate("HeatmapSessionRecording_AdvancedOptions"),"inline-help":e.translate("HeatmapSessionRecording_HeatmapSampleRateHelp")},null,8,["model-value","title","options","introduction","inline-help"])]),Object(r["createElementVNode"])("div",sa,[Object(r["createVNode"])(s,{uicontrol:"text",name:"excludedElements","model-value":e.siteHsr.excluded_elements,"onUpdate:modelValue":t[5]||(t[5]=function(t){e.siteHsr.excluded_elements=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_ExcludedElements"),maxlength:1e3,"inline-help":e.translate("HeatmapSessionRecording_ExcludedElementsHelp")},null,8,["model-value","title","inline-help"])]),Object(r["createElementVNode"])("div",la,[Object(r["createVNode"])(s,{uicontrol:"text",name:"screenshotUrl","model-value":e.siteHsr.screenshot_url,"onUpdate:modelValue":t[6]||(t[6]=function(t){e.siteHsr.screenshot_url=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_ScreenshotUrl"),maxlength:300,disabled:!!e.siteHsr.page_treemirror,"inline-help":e.translate("HeatmapSessionRecording_ScreenshotUrlHelp")},null,8,["model-value","title","disabled","inline-help"])]),Object(r["createElementVNode"])("div",ca,[Object(r["createVNode"])(s,{uicontrol:"text",name:"breakpointMobile","model-value":e.siteHsr.breakpoint_mobile,"onUpdate:modelValue":t[7]||(t[7]=function(t){e.siteHsr.breakpoint_mobile=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_BreakpointX",e.translate("General_Mobile")),maxlength:4,"inline-help":e.breakpointMobileInlineHelp},null,8,["model-value","title","inline-help"])]),Object(r["createElementVNode"])("div",da,[Object(r["createVNode"])(s,{uicontrol:"text",name:"breakpointTablet","model-value":e.siteHsr.breakpoint_tablet,"onUpdate:modelValue":t[8]||(t[8]=function(t){e.siteHsr.breakpoint_tablet=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_BreakpointX",e.translate("DevicesDetection_Tablet")),maxlength:4,"inline-help":e.breakpointGeneralHelp},null,8,["model-value","title","inline-help"])]),Object(r["createElementVNode"])("div",ua,[Object(r["createVNode"])(s,{uicontrol:"checkbox",name:"capture_manually",title:e.translate("HeatmapSessionRecording_CaptureDomTitle"),"inline-help":e.captureDomInlineHelp,"model-value":e.siteHsr.capture_manually,"onUpdate:modelValue":t[9]||(t[9]=function(t){e.siteHsr.capture_manually=t,e.setValueHasChanged()})},null,8,["title","inline-help","model-value"])]),Object(r["createElementVNode"])("p",{innerHTML:e.$sanitize(e.personalInformationNote)},null,8,ma),Object(r["createVNode"])(d,{class:"createButton",onConfirm:t[10]||(t[10]=function(t){return e.edit?e.updateHsr():e.createHsr()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.saveButtonText},null,8,["disabled","saving","value"]),Object(r["createElementVNode"])("div",pa,[Object(r["createElementVNode"])("a",{onClick:t[11]||(t[11]=function(t){return e.cancel()})},Object(r["toDisplayString"])(e.translate("General_Cancel")),1)])])],32)]})),_:1},8,["content-title"])}function ga(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fa(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ba(e,t,a){return t&&fa(e.prototype,t),a&&fa(e,a),e}function va(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */var ya=function(){function e(t){var a=this;ga(this,e),va(this,"context",void 0),va(this,"privateState",Object(r["reactive"])({allHsrs:[],isLoading:!1,isUpdating:!1,filterStatus:""})),va(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(a.privateState)}))),va(this,"hsrs",Object(r["computed"])((function(){return a.privateState.filterStatus?a.state.value.allHsrs.filter((function(e){return e.status===a.privateState.filterStatus})):a.state.value.allHsrs}))),va(this,"hsrsCloned",Object(r["computed"])((function(){return Object(U["clone"])(a.hsrs.value)}))),va(this,"statusOptions",Object(r["readonly"])([{key:"",value:Object(U["translate"])("General_All")},{key:"active",value:Object(U["translate"])("HeatmapSessionRecording_StatusActive")},{key:"ended",value:Object(U["translate"])("HeatmapSessionRecording_StatusEnded")},{key:"paused",value:Object(U["translate"])("HeatmapSessionRecording_StatusPaused")}])),va(this,"fetchPromises",{}),this.context=t}return ba(e,[{key:"setFilterStatus",value:function(e){this.privateState.filterStatus=e}},{key:"reload",value:function(){return this.privateState.allHsrs=[],this.fetchPromises={},this.fetchHsrs()}},{key:"filterRules",value:function(e){return e.filter((function(e){return!!e&&(e.value||"any"===e.type)}))}},{key:"getApiMethodInContext",value:function(e){return"".concat(e).concat(this.context)}},{key:"fetchHsrs",value:function(){var e=this,t="HeatmapSessionRecording.getHeatmaps";"SessionRecording"===this.context&&(t="HeatmapSessionRecording.getSessionRecordings");var a={method:t,filter_limit:"-1"};return this.fetchPromises[t]||(this.fetchPromises[t]=U["AjaxHelper"].fetch(a)),this.privateState.isLoading=!0,this.privateState.allHsrs=[],this.fetchPromises[t].then((function(t){return e.privateState.allHsrs=t,e.state.value.allHsrs})).finally((function(){e.privateState.isLoading=!1}))}},{key:"findHsr",value:function(e){var t=this,a=this.state.value.allHsrs.find((function(t){return t.idsitehsr===e}));return a?Promise.resolve(a):(this.privateState.isLoading=!0,U["AjaxHelper"].fetch({idSiteHsr:e,method:this.getApiMethodInContext("HeatmapSessionRecording.get"),filter_limit:"-1"}).finally((function(){t.privateState.isLoading=!1})))}},{key:"deleteHsr",value:function(e){var t=this;return this.privateState.isUpdating=!0,this.privateState.allHsrs=[],U["AjaxHelper"].fetch({idSiteHsr:e,method:this.getApiMethodInContext("HeatmapSessionRecording.delete")},{withTokenInUrl:!0}).then((function(){return{type:"success"}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){t.privateState.isUpdating=!1}))}},{key:"completeHsr",value:function(e){var t=this;return this.privateState.isUpdating=!0,this.privateState.allHsrs=[],U["AjaxHelper"].fetch({idSiteHsr:e,method:this.getApiMethodInContext("HeatmapSessionRecording.end")},{withTokenInUrl:!0}).then((function(){return{type:"success"}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){t.privateState.isUpdating=!1}))}},{key:"createOrUpdateHsr",value:function(e,t){var a=this,n={idSiteHsr:e.idsitehsr,sampleLimit:e.sample_limit,sampleRate:e.sample_rate,excludedElements:e.excluded_elements?e.excluded_elements.trim():void 0,screenshotUrl:e.screenshot_url?e.screenshot_url.trim():void 0,breakpointMobile:e.breakpoint_mobile,breakpointTablet:e.breakpoint_tablet,minSessionTime:e.min_session_time,requiresActivity:e.requires_activity?1:0,captureKeystrokes:e.capture_keystrokes?1:0,captureDomManually:e.capture_manually?1:0,method:t,name:e.name.trim()},i={matchPageRules:this.filterRules(e.match_page_rules)};return this.privateState.isUpdating=!0,U["AjaxHelper"].post(n,i,{withTokenInUrl:!0}).then((function(e){return{type:"success",response:e}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){a.privateState.isUpdating=!1}))}}]),e}(),Oa=new ya("Heatmap"),ja=new ya("SessionRecording");function Sa(e){return Na(e)||Va(e)||Ha(e)||_a()}function _a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ha(e,t){if(e){if("string"===typeof e)return Ea(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Ea(e,t):void 0}}function Va(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Na(e){if(Array.isArray(e))return Ea(e)}function Ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var wa="hsrmanagement",Ra=Object(r["defineComponent"])({props:{idSiteHsr:Number,breakpointMobile:Number,breakpointTablet:Number},components:{ContentBlock:U["ContentBlock"],Field:I["Field"],HsrUrlTarget:Gt,HsrTargetTest:kt,SaveButton:I["SaveButton"]},data:function(){return{isDirty:!1,showAdvancedView:!1,siteHsr:{}}},created:function(){this.init()},watch:{idSiteHsr:function(e){null!==e&&this.init()}},methods:{removeAnyHsrNotification:function(){U["NotificationsStore"].remove(wa),U["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var a=U["NotificationsStore"].show({message:e,context:t,id:wa,type:"transient"});setTimeout((function(){U["NotificationsStore"].scrollToNotification(a)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(U["translate"])("HeatmapSessionRecording_ErrorXNotProvided",[e]);this.showNotification(t,"error")},init:function(){var e=this,t=this.idSiteHsr;if(this.siteHsr={},this.showAdvancedView=!1,U["Matomo"].helper.lazyScrollToContent(),this.edit&&t)Oa.findHsr(t).then((function(t){t&&(e.siteHsr=Object(U["clone"])(t),e.siteHsr.sample_rate="".concat(e.siteHsr.sample_rate),e.addInitialMatchPageRule(),e.isDirty=!1)}));else if(this.create){this.siteHsr={idSite:U["Matomo"].idSite,name:"",sample_rate:"10.0",sample_limit:1e3,breakpoint_mobile:this.breakpointMobile,breakpoint_tablet:this.breakpointTablet,capture_manually:0},this.isDirty=!1;var a=U["MatomoUrl"].hashParsed.value;if(a.name&&(this.siteHsr.name=a.name,this.isDirty=!0),a.matchPageRules)try{this.siteHsr.match_page_rules=JSON.parse(a.matchPageRules),this.isDirty=!0}catch(n){console.log("warning: could not parse matchPageRules query param, expected JSON")}else this.addInitialMatchPageRule()}},addInitialMatchPageRule:function(){var e;this.siteHsr&&(null!==(e=this.siteHsr.match_page_rules)&&void 0!==e&&e.length||this.addMatchPageRule())},addMatchPageRule:function(){var e;this.siteHsr&&(null!==(e=this.siteHsr.match_page_rules)&&void 0!==e&&e.length||(this.siteHsr.match_page_rules=[]),this.siteHsr.match_page_rules.push({attribute:"url",type:"equals_simple",value:"",inverted:0}),this.isDirty=!0)},removeMatchPageRule:function(e){this.siteHsr&&e>-1&&(this.siteHsr.match_page_rules=Sa(this.siteHsr.match_page_rules),this.siteHsr.match_page_rules.splice(e,1),this.isDirty=!0)},cancel:function(){var e=Object.assign({},U["MatomoUrl"].hashParsed.value);delete e.idSiteHsr,U["MatomoUrl"].updateHash(e)},createHsr:function(){var e=this;this.removeAnyHsrNotification(),this.checkRequiredFieldsAreSet()&&Oa.createOrUpdateHsr(this.siteHsr,"HeatmapSessionRecording.addHeatmap").then((function(t){if(t&&"error"!==t.type&&t.response){e.isDirty=!1;var a=t.response.value;Oa.reload().then((function(){U["Matomo"].helper.isReportingPage()&&U["Matomo"].postEvent("updateReportingMenu"),U["MatomoUrl"].updateHash(Object.assign(Object.assign({},U["MatomoUrl"].hashParsed.value),{},{idSiteHsr:a})),setTimeout((function(){e.showNotification(Object(U["translate"])("HeatmapSessionRecording_HeatmapCreated"),t.type)}),200)}))}}))},setValueHasChanged:function(){this.isDirty=!0},updateHsr:function(){var e=this;this.removeAnyHsrNotification(),this.checkRequiredFieldsAreSet()&&Oa.createOrUpdateHsr(this.siteHsr,"HeatmapSessionRecording.updateHeatmap").then((function(t){"error"!==t.type&&(e.isDirty=!1,e.siteHsr={},Oa.reload().then((function(){e.init()})),e.showNotification(Object(U["translate"])("HeatmapSessionRecording_HeatmapUpdated"),t.type))}))},checkRequiredFieldsAreSet:function(){var e;if(!this.siteHsr.name){var t=Object(U["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(t),!1}if(null===(e=this.siteHsr.match_page_rules)||void 0===e||!e.length||!Oa.filterRules(this.siteHsr.match_page_rules).length){var a=Object(U["translate"])("HeatmapSessionRecording_ErrorPageRuleRequired");return this.showNotification(a,"error"),!1}return!0},setMatchPageRule:function(e,t){this.siteHsr.match_page_rules=Sa(this.siteHsr.match_page_rules),this.siteHsr.match_page_rules[t]=e}},computed:{sampleLimits:function(){return[1e3,2e3,5e3].map((function(e){return{key:"".concat(e),value:e}}))},sampleRates:function(){var e=[.1,.5,1,2,3,4,5,6,8,10,15,20,30,40,50,60,70,80,90,100];return e.map((function(e){return{key:e.toFixed(1),value:"".concat(e,"%")}}))},create:function(){return!this.idSiteHsr},edit:function(){return!this.create},editTitle:function(){var e=this.create?"HeatmapSessionRecording_CreateNewHeatmap":"HeatmapSessionRecording_EditHeatmapX";return e},contentTitle:function(){return Object(U["translate"])(this.editTitle,this.siteHsr.name?'"'.concat(this.siteHsr.name,'"'):"")},isLoading:function(){return Oa.state.value.isLoading},isUpdating:function(){return Oa.state.value.isUpdating},breakpointMobileInlineHelp:function(){var e=Object(U["translate"])("HeatmapSessionRecording_BreakpointGeneralHelp"),t=Object(U["translate"])("HeatmapSessionRecording_BreakpointGeneralHelpManage");return"".concat(e," ").concat(t)},breakpointGeneralHelp:function(){var e=Object(U["translate"])("HeatmapSessionRecording_BreakpointGeneralHelp"),t=Object(U["translate"])("HeatmapSessionRecording_BreakpointGeneralHelpManage");return"".concat(e," ").concat(t)},captureDomInlineHelp:function(){var e=this.idSiteHsr?this.idSiteHsr:"{idHeatmap}",t="<br><br><strong>_paq.push(['HeatmapSessionRecording::captureInitialDom', ".concat(e,"])</strong>");return Object(U["translate"])("HeatmapSessionRecording_CaptureDomInlineHelp",t,"<br><br><strong>","</strong>")},personalInformationNote:function(){var e="https://developer.matomo.org/guides/heatmap-session-recording/setup#masking-content-on-your-website";return Object(U["translate"])("HeatmapSessionRecording_PersonalInformationNote",Object(U["translate"])("HeatmapSessionRecording_Heatmap"),"<code>","</code>",'<a href="'.concat(e,'" target="_blank" rel="noreferrer noopener">'),"</a>")},saveButtonText:function(){return this.edit?Object(U["translate"])("CoreUpdater_UpdateTitle"):Object(U["translate"])("HeatmapSessionRecording_CreateNewHeatmap")}}});Ra.render=ha;var ka=Ra,xa={class:"heatmapList"},Ca={class:"filterStatus"},Da={class:"hsrSearchFilter",style:{"margin-left":"3.5px"}},Pa={class:"index"},Ma={class:"name"},Ta={class:"creationDate"},Aa={class:"sampleLimit"},Ba={class:"status"},Ua={class:"action"},Ia={colspan:"7"},Fa={class:"loadingPiwik"},La=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Wa={colspan:"7"},qa=["id"],za={class:"index"},Ga={class:"name"},$a={class:"creationDate"},Ja={class:"sampleLimit"},Xa={key:0,class:"status status-paused"},Ya=["title"],Ka={key:1,class:"status"},Qa={class:"action"},Za=["title","onClick"],en=["title","onClick"],tn=["title","href"],an=["title","onClick"],nn={class:"tableActionBar"},rn=Object(r["createElementVNode"])("span",{class:"icon-add"},null,-1),on={class:"ui-confirm",id:"confirmDeleteHeatmap",ref:"confirmDeleteHeatmap"},sn=["value"],ln=["value"],cn={class:"ui-confirm",id:"confirmEndHeatmap",ref:"confirmEndHeatmap"},dn=["value"],un=["value"];function mn(e,t,a,n,i,o){var s=Object(r["resolveComponent"])("Field"),l=Object(r["resolveComponent"])("ContentBlock"),c=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",xa,[Object(r["createVNode"])(l,{"content-title":e.translate("HeatmapSessionRecording_ManageHeatmaps")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_HeatmapUsageBenefits")),1),Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",Ca,[Object(r["createVNode"])(s,{uicontrol:"select",name:"filterStatus","model-value":e.filterStatus,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.setFilterStatus(t)}),title:e.translate("HeatmapSessionRecording_Filter"),"full-width":!0,options:e.statusOptions},null,8,["model-value","title","options"])]),Object(r["createElementVNode"])("div",Da,[Object(r["withDirectives"])(Object(r["createVNode"])(s,{uicontrol:"text",name:"hsrSearch",title:e.translate("General_Search"),modelValue:e.searchFilter,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.searchFilter=t}),"full-width":!0},null,8,["title","modelValue"]),[[r["vShow"],e.hsrs.length>0]])])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",Pa,Object(r["toDisplayString"])(e.translate("General_Id")),1),Object(r["createElementVNode"])("th",Ma,Object(r["toDisplayString"])(e.translate("General_Name")),1),Object(r["createElementVNode"])("th",Ta,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_CreationDate")),1),Object(r["createElementVNode"])("th",Aa,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_SampleLimit")),1),Object(r["createElementVNode"])("th",Ba,Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Status")),1),Object(r["createElementVNode"])("th",Ua,Object(r["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(r["createElementVNode"])("tbody",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Ia,[Object(r["createElementVNode"])("span",Fa,[La,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[r["vShow"],e.isLoading||e.isUpdating]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Wa,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_NoHeatmapsFound")),1)],512),[[r["vShow"],!e.isLoading&&0===e.hsrs.length]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedHsrs,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{id:"hsr".concat(t.idsitehsr),class:"hsrs",key:t.idsitehsr},[Object(r["createElementVNode"])("td",za,Object(r["toDisplayString"])(t.idsitehsr),1),Object(r["createElementVNode"])("td",Ga,Object(r["toDisplayString"])(t.name),1),Object(r["createElementVNode"])("td",$a,Object(r["toDisplayString"])(t.created_date_pretty),1),Object(r["createElementVNode"])("td",Ja,Object(r["toDisplayString"])(t.sample_limit),1),"paused"===t.status?(Object(r["openBlock"])(),Object(r["createElementBlock"])("td",Xa,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.ucfirst(t.status))+" ",1),Object(r["createElementVNode"])("span",{class:"icon icon-help",title:e.pauseReason},null,8,Ya)])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("td",Ka,Object(r["toDisplayString"])(e.ucfirst(t.status)),1)),Object(r["createElementVNode"])("td",Qa,[Object(r["createElementVNode"])("a",{class:"table-action icon-edit",title:e.translate("HeatmapSessionRecording_EditX",e.translate("HeatmapSessionRecording_Heatmap")),onClick:function(a){return e.editHsr(t.idsitehsr)}},null,8,Za),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{a:"",class:"table-action stopRecording icon-drop-crossed",title:e.translate("HeatmapSessionRecording_StopX",e.translate("HeatmapSessionRecording_Heatmap")),onClick:function(a){return e.completeHsr(t)}},null,8,en),[[r["vShow"],"ended"!==t.status]]),Object(r["createElementVNode"])("a",{target:"_blank",class:"table-action icon-show",title:e.translate("HeatmapSessionRecording_ViewReport"),href:e.getViewReportLink(t)},null,8,tn),Object(r["createElementVNode"])("a",{class:"table-action icon-delete",title:e.translate("HeatmapSessionRecording_DeleteX",e.translate("HeatmapSessionRecording_Heatmap")),onClick:function(a){return e.deleteHsr(t)}},null,8,an)])],8,qa)})),128))])],512),[[c]]),Object(r["createElementVNode"])("div",nn,[Object(r["createElementVNode"])("a",{class:"createNewHsr",value:"",onClick:t[2]||(t[2]=function(t){return e.createHsr()})},[rn,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_CreateNewHeatmap")),1)])])]})),_:1},8,["content-title"]),Object(r["createElementVNode"])("div",on,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_DeleteHeatmapConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,sn),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,ln)],512),Object(r["createElementVNode"])("div",cn,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_EndHeatmapConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,dn),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,un)],512)])}function pn(e){return bn(e)||fn(e)||gn(e)||hn()}function hn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function gn(e,t){if(e){if("string"===typeof e)return vn(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?vn(e,t):void 0}}function fn(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function bn(e){if(Array.isArray(e))return vn(e)}function vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var yn=Object(r["defineComponent"])({props:{pauseReason:String},components:{ContentBlock:U["ContentBlock"],Field:I["Field"]},directives:{ContentTable:U["ContentTable"]},data:function(){return{searchFilter:""}},created:function(){Oa.setFilterStatus(""),Oa.fetchHsrs()},methods:{createHsr:function(){this.editHsr(0)},editHsr:function(e){U["MatomoUrl"].updateHash(Object.assign(Object.assign({},U["MatomoUrl"].hashParsed.value),{},{idSiteHsr:e}))},deleteHsr:function(e){U["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteHeatmap,{yes:function(){Oa.deleteHsr(e.idsitehsr).then((function(){Oa.reload(),U["Matomo"].postEvent("updateReportingMenu")}))}})},completeHsr:function(e){U["Matomo"].helper.modalConfirm(this.$refs.confirmEndHeatmap,{yes:function(){Oa.completeHsr(e.idsitehsr).then((function(){Oa.reload()}))}})},setFilterStatus:function(e){Oa.setFilterStatus(e)},ucfirst:function(e){return"".concat(e[0].toUpperCase()).concat(e.substr(1))},getViewReportLink:function(e){return"?".concat(U["MatomoUrl"].stringify({module:"Widgetize",action:"iframe",moduleToWidgetize:"HeatmapSessionRecording",actionToWidgetize:"showHeatmap",idSiteHsr:e.idsitehsr,idSite:e.idsite,period:"day",date:"yesterday"}))}},computed:{filterStatus:function(){return Oa.state.value.filterStatus},statusOptions:function(){return Oa.statusOptions},hsrs:function(){return Oa.hsrs.value},isLoading:function(){return Oa.state.value.isLoading},isUpdating:function(){return Oa.state.value.isUpdating},sortedHsrs:function(){var e=this,t=pn(this.hsrs).filter((function(t){return Object.keys(t).some((function(a){var n=t;return"string"===typeof n[a]&&-1!==n[a].indexOf(e.searchFilter)}))}));return t.sort((function(e,t){return t.idsitehsr-e.idsitehsr})),t}}});yn.render=mn;var On=yn,jn={class:"manageHsr",ref:"root"},Sn={key:0},_n={key:1};function Hn(e,t,a,n,i,o){var s=Object(r["resolveComponent"])("MatomoJsNotWritableAlert"),l=Object(r["resolveComponent"])("HeatmapList"),c=Object(r["resolveComponent"])("HeatmapEdit");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[e.editMode?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])(s,{key:0,"is-matomo-js-writable":e.isMatomoJsWritable,"recording-type":e.translate("HeatmapSessionRecording_Heatmaps")},null,8,["is-matomo-js-writable","recording-type"])),Object(r["createElementVNode"])("div",jn,[e.editMode?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Sn,[Object(r["createVNode"])(l,{"pause-reason":e.pauseReason},null,8,["pause-reason"])])),e.editMode?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",_n,[Object(r["createVNode"])(c,{"breakpoint-mobile":e.breakpointMobile,"breakpoint-tablet":e.breakpointTablet,"id-site-hsr":e.idSiteHsr},null,8,["breakpoint-mobile","breakpoint-tablet","id-site-hsr"])])):Object(r["createCommentVNode"])("",!0)],512)],64)}var Vn=["innerHTML"];function Nn(e,t,a,n,i,o){return e.isMatomoJsWritable?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:0,class:"alert alert-warning",innerHTML:e.getJsNotWritableErrorMessage()},null,8,Vn))}var En=Object(r["defineComponent"])({props:{recordingType:{type:String,required:!0},isMatomoJsWritable:{type:Boolean,required:!0}},methods:{getJsNotWritableErrorMessage:function(){return Object(U["translate"])("HeatmapSessionRecording_MatomoJSNotWritableErrorMessage",this.recordingType,'<a href="https://developer.matomo.org/guides/heatmap-session-recording/setup#when-the-matomojs-in-your-piwik-directory-file-is-not-writable" target="_blank" rel="noreferrer noopener">',"</a>")}}});En.render=Nn;var wn=En,Rn=window,kn=Rn.$,xn=Object(r["defineComponent"])({props:{breakpointMobile:Number,breakpointTablet:Number,pauseReason:String,isMatomoJsWritable:{type:Boolean,required:!0}},data:function(){return{editMode:!1,idSiteHsr:null}},components:{MatomoJsNotWritableAlert:wn,HeatmapList:On,HeatmapEdit:ka},watch:{editMode:function(){kn(".ui-tooltip").remove()}},created:function(){var e=this;Object(r["watch"])((function(){return U["MatomoUrl"].hashParsed.value.idSiteHsr}),(function(t){e.initState(t)})),this.initState(U["MatomoUrl"].hashParsed.value.idSiteHsr)},methods:{removeAnyHsrNotification:function(){U["NotificationsStore"].remove("hsrmanagement")},initState:function(e){if(e){if("0"===e){var t={isAllowed:!0};if(U["Matomo"].postEvent("HeatmapSessionRecording.initAddHeatmap",t),t&&!t.isAllowed)return this.editMode=!1,void(this.idSiteHsr=null)}this.editMode=!0,this.idSiteHsr=parseInt(e,10)}else this.editMode=!1,this.idSiteHsr=null;this.removeAnyHsrNotification()}}});xn.render=Hn;var Cn=xn,Dn={class:"loadingPiwik"},Pn=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Mn={class:"loadingPiwik"},Tn=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),An={name:"name"},Bn={name:"sampleLimit"},Un={class:"form-group row"},In={class:"col s12"},Fn={class:"col s12 m6",style:{"padding-left":"0"}},Ln=Object(r["createElementVNode"])("hr",null,null,-1),Wn={class:"col s12 m6"},qn={class:"form-help"},zn={class:"inline-help"},Gn={name:"sampleRate"},$n={name:"minSessionTime"},Jn={name:"requiresActivity"},Xn={class:"inline-help-node"},Yn=["innerHTML"],Kn=["innerHTML"],Qn={class:"entityCancel"};function Zn(e,t,a,n,i,o){var s=Object(r["resolveComponent"])("Field"),l=Object(r["resolveComponent"])("HsrUrlTarget"),c=Object(r["resolveComponent"])("HsrTargetTest"),d=Object(r["resolveComponent"])("SaveButton"),u=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createBlock"])(u,{class:"editHsr","content-title":e.contentTitle},{default:Object(r["withCtx"])((function(){return[Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",Dn,[Pn,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[r["vShow"],e.isLoading]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",Mn,[Tn,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_UpdatingData")),1)])],512),[[r["vShow"],e.isUpdating]]),Object(r["createElementVNode"])("form",{onSubmit:t[10]||(t[10]=function(t){return e.edit?e.updateHsr():e.createHsr()})},[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",An,[Object(r["createVNode"])(s,{uicontrol:"text",name:"name","model-value":e.siteHsr.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.siteHsr.name=t,e.setValueHasChanged()}),title:e.translate("General_Name"),maxlength:50,placeholder:e.translate("HeatmapSessionRecording_FieldNamePlaceholder"),"inline-help":e.translate("HeatmapSessionRecording_SessionNameHelp")},null,8,["model-value","title","placeholder","inline-help"])]),Object(r["createElementVNode"])("div",Bn,[Object(r["createVNode"])(s,{uicontrol:"select",name:"sampleLimit","model-value":e.siteHsr.sample_limit,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.siteHsr.sample_limit=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_SessionSampleLimit"),options:e.sampleLimits,"inline-help":e.translate("HeatmapSessionRecording_SessionSampleLimitHelp")},null,8,["model-value","title","options","inline-help"])]),Object(r["createElementVNode"])("div",Un,[Object(r["createElementVNode"])("div",In,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPages"))+":",1)]),Object(r["createElementVNode"])("div",Fn,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.siteHsr.match_page_rules,(function(a,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:Object(r["normalizeClass"])("matchPageRules ".concat(n," multiple")),key:n},[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{"model-value":a,"onUpdate:modelValue":function(t){return e.setMatchPageRule(t,n)},onAddUrl:t[2]||(t[2]=function(t){return e.addMatchPageRule()}),onRemoveUrl:function(t){return e.removeMatchPageRule(n)},onAnyChange:t[3]||(t[3]=function(t){return e.setValueHasChanged()}),"allow-any":!0,"disable-if-no-value":n>0,"can-be-removed":n>0,"show-add-url":!0},null,8,["model-value","onUpdate:modelValue","onRemoveUrl","disable-if-no-value","can-be-removed"])]),Ln],2)})),128))]),Object(r["createElementVNode"])("div",Wn,[Object(r["createElementVNode"])("div",qn,[Object(r["createElementVNode"])("span",zn,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_FieldIncludedTargetsHelpSessions"))+" ",1),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{"included-targets":e.siteHsr.match_page_rules},null,8,["included-targets"])])])])])]),Object(r["createElementVNode"])("div",Gn,[Object(r["createVNode"])(s,{uicontrol:"select",name:"sampleRate","model-value":e.siteHsr.sample_rate,"onUpdate:modelValue":t[4]||(t[4]=function(t){e.siteHsr.sample_rate=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_SampleRate"),options:e.sampleRates,introduction:e.translate("HeatmapSessionRecording_AdvancedOptions"),"inline-help":e.translate("HeatmapSessionRecording_SessionSampleRateHelp")},null,8,["model-value","title","options","introduction","inline-help"])]),Object(r["createElementVNode"])("div",$n,[Object(r["createVNode"])(s,{uicontrol:"select",name:"minSessionTime","model-value":e.siteHsr.min_session_time,"onUpdate:modelValue":t[5]||(t[5]=function(t){e.siteHsr.min_session_time=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_MinSessionTime"),options:e.minSessionTimes,"inline-help":e.translate("HeatmapSessionRecording_MinSessionTimeHelp")},null,8,["model-value","title","options","inline-help"])]),Object(r["createElementVNode"])("div",Jn,[Object(r["createVNode"])(s,{uicontrol:"checkbox",name:"requiresActivity","model-value":e.siteHsr.requires_activity,"onUpdate:modelValue":t[6]||(t[6]=function(t){e.siteHsr.requires_activity=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_RequiresActivity"),"inline-help":e.translate("HeatmapSessionRecording_RequiresActivityHelp")},null,8,["model-value","title","inline-help"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(s,{uicontrol:"checkbox",name:"captureKeystrokes","model-value":e.siteHsr.capture_keystrokes,"onUpdate:modelValue":t[7]||(t[7]=function(t){e.siteHsr.capture_keystrokes=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_CaptureKeystrokes")},{"inline-help":Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",Xn,[Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.captureKeystrokesHelp)},null,8,Yn)])]})),_:1},8,["model-value","title"])]),Object(r["createElementVNode"])("p",{innerHTML:e.$sanitize(e.personalInformationNote)},null,8,Kn),Object(r["createVNode"])(d,{class:"createButton",onConfirm:t[8]||(t[8]=function(t){return e.edit?e.updateHsr():e.createHsr()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.saveButtonText},null,8,["disabled","saving","value"]),Object(r["createElementVNode"])("div",Qn,[Object(r["createElementVNode"])("a",{onClick:t[9]||(t[9]=function(t){return e.cancel()})},Object(r["toDisplayString"])(e.translate("General_Cancel")),1)])])],32)]})),_:1},8,["content-title"])}function ei(e){return ii(e)||ni(e)||ai(e)||ti()}function ti(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ai(e,t){if(e){if("string"===typeof e)return ri(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?ri(e,t):void 0}}function ni(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ii(e){if(Array.isArray(e))return ri(e)}function ri(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var oi="hsrmanagement",si=Object(r["defineComponent"])({props:{idSiteHsr:Number},components:{ContentBlock:U["ContentBlock"],Field:I["Field"],HsrUrlTarget:Gt,HsrTargetTest:kt,SaveButton:I["SaveButton"]},data:function(){return{isDirty:!1,showAdvancedView:!1,sampleLimits:[],siteHsr:{}}},created:function(){var e=this;U["AjaxHelper"].fetch({method:"HeatmapSessionRecording.getAvailableSessionRecordingSampleLimits"}).then((function(t){e.sampleLimits=(t||[]).map((function(e){return{key:"".concat(e),value:e}}))})),this.init()},watch:{idSiteHsr:function(e){null!==e&&this.init()}},methods:{removeAnyHsrNotification:function(){U["NotificationsStore"].remove(oi),U["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var a=U["NotificationsStore"].show({message:e,context:t,id:oi,type:"transient"});setTimeout((function(){U["NotificationsStore"].scrollToNotification(a)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(U["translate"])("HeatmapSessionRecording_ErrorXNotProvided",[e]);this.showNotification(t,"error")},init:function(){var e=this,t=this.idSiteHsr;this.siteHsr={},this.showAdvancedView=!1,U["Matomo"].helper.lazyScrollToContent(),this.edit&&t?ja.findHsr(t).then((function(t){t&&(e.siteHsr=Object(U["clone"])(t),e.siteHsr.sample_rate="".concat(e.siteHsr.sample_rate),e.addInitialMatchPageRule(),e.isDirty=!1)})):this.create&&(this.siteHsr={idSite:U["Matomo"].idSite,name:"",sample_rate:"10.0",sample_limit:250,min_session_time:0,requires_activity:!0,capture_keystrokes:!1},this.addInitialMatchPageRule(),this.isDirty=!1)},addInitialMatchPageRule:function(){var e;this.siteHsr&&(null!==(e=this.siteHsr.match_page_rules)&&void 0!==e&&e.length||(this.siteHsr.match_page_rules=[{attribute:"url",type:"any",value:"",inverted:0}]))},addMatchPageRule:function(){var e;this.siteHsr&&(null!==(e=this.siteHsr.match_page_rules)&&void 0!==e&&e.length||(this.siteHsr.match_page_rules=[]),this.siteHsr.match_page_rules.push({attribute:"url",type:"equals_simple",value:"",inverted:0}),this.isDirty=!0)},removeMatchPageRule:function(e){this.siteHsr&&e>-1&&(this.siteHsr.match_page_rules=ei(this.siteHsr.match_page_rules),this.siteHsr.match_page_rules.splice(e,1),this.isDirty=!0)},cancel:function(){var e=Object.assign({},U["MatomoUrl"].hashParsed.value);delete e.idSiteHsr,U["MatomoUrl"].updateHash(e)},createHsr:function(){var e=this;this.removeAnyHsrNotification(),this.checkRequiredFieldsAreSet()&&ja.createOrUpdateHsr(this.siteHsr,"HeatmapSessionRecording.addSessionRecording").then((function(t){if(t&&"error"!==t.type&&t.response){e.isDirty=!1;var a=t.response.value;ja.reload().then((function(){U["Matomo"].helper.isReportingPage()&&U["Matomo"].postEvent("updateReportingMenu"),U["MatomoUrl"].updateHash(Object.assign(Object.assign({},U["MatomoUrl"].hashParsed.value),{},{idSiteHsr:a})),setTimeout((function(){e.showNotification(Object(U["translate"])("HeatmapSessionRecording_SessionRecordingCreated"),t.type)}),200)}))}}))},setValueHasChanged:function(){this.isDirty=!0},updateHsr:function(){var e=this;this.removeAnyHsrNotification(),this.checkRequiredFieldsAreSet()&&ja.createOrUpdateHsr(this.siteHsr,"HeatmapSessionRecording.updateSessionRecording").then((function(t){"error"!==t.type&&(e.isDirty=!1,e.siteHsr={},ja.reload().then((function(){e.init()})),e.showNotification(Object(U["translate"])("HeatmapSessionRecording_SessionRecordingUpdated"),t.type))}))},checkRequiredFieldsAreSet:function(){var e;if(!this.siteHsr.name){var t=this.translate("General_Name");return this.showErrorFieldNotProvidedNotification(t),!1}if(null===(e=this.siteHsr.match_page_rules)||void 0===e||!e.length||!ja.filterRules(this.siteHsr.match_page_rules).length){var a=this.translate("HeatmapSessionRecording_ErrorPageRuleRequired");return this.showNotification(a,"error"),!1}return!0},setMatchPageRule:function(e,t){this.siteHsr.match_page_rules=ei(this.siteHsr.match_page_rules),this.siteHsr.match_page_rules[t]=e}},computed:{minSessionTimes:function(){return[0,5,10,15,20,30,45,60,90,120].map((function(e){return{key:"".concat(e),value:"".concat(e," seconds")}}))},sampleRates:function(){var e=[.1,.5,1,2,3,4,5,6,8,10,15,20,30,40,50,60,70,80,90,100];return e.map((function(e){return{key:"".concat(e.toFixed(1)),value:"".concat(e,"%")}}))},create:function(){return!this.idSiteHsr},edit:function(){return!this.create},editTitle:function(){var e=this.create?"HeatmapSessionRecording_CreateNewSessionRecording":"HeatmapSessionRecording_EditSessionRecordingX";return e},contentTitle:function(){return Object(U["translate"])(this.editTitle,this.siteHsr.name?'"'.concat(this.siteHsr.name,'"'):"")},isLoading:function(){return Oa.state.value.isLoading},isUpdating:function(){return Oa.state.value.isUpdating},captureKeystrokesHelp:function(){var e="https://developer.matomo.org/guides/heatmap-session-recording/setup#masking-keystrokes-in-form-fields";return Object(U["translate"])("HeatmapSessionRecording_CaptureKeystrokesHelp",'<a href="'.concat(e,'" target="_blank" rel="noopener noreferrer">'),"</a>")},personalInformationNote:function(){var e="https://developer.matomo.org/guides/heatmap-session-recording/setup#masking-content-on-your-website";return Object(U["translate"])("HeatmapSessionRecording_PersonalInformationNote",Object(U["translate"])("HeatmapSessionRecording_SessionRecording"),"<code>","</code>",'<a href="'.concat(e,'" target="_blank" rel="noreferrer noopener">'),"</a>")},saveButtonText:function(){return this.edit?Object(U["translate"])("CoreUpdater_UpdateTitle"):Object(U["translate"])("HeatmapSessionRecording_CreateNewSessionRecording")}}});si.render=Zn;var li=si,ci={class:"sessionRecordingList"},di={class:"filterStatus"},ui={class:"hsrSearchFilter",style:{"margin-left":"3.5px"}},mi={class:"index"},pi={class:"name"},hi={class:"creationDate"},gi={class:"sampleLimit"},fi={class:"status"},bi={class:"action"},vi={colspan:"7"},yi={class:"loadingPiwik"},Oi=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),ji={colspan:"7"},Si=["id"],_i={class:"index"},Hi={class:"name"},Vi={class:"creationDate"},Ni={class:"sampleLimit"},Ei={key:0,class:"status status-paused"},wi=["title"],Ri={key:1,class:"status"},ki={class:"action"},xi=["title","onClick"],Ci=["title","onClick"],Di=["title","href"],Pi=["title","onClick"],Mi={class:"tableActionBar"},Ti=Object(r["createElementVNode"])("span",{class:"icon-add"},null,-1),Ai={class:"ui-confirm",ref:"confirmDeleteSessionRecording"},Bi=["value"],Ui=["value"],Ii={class:"ui-confirm",ref:"confirmEndSessionRecording"},Fi=["value"],Li=["value"];function Wi(e,t,a,n,i,o){var s=Object(r["resolveComponent"])("Field"),l=Object(r["resolveComponent"])("ContentBlock"),c=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ci,[Object(r["createVNode"])(l,{"content-title":e.translate("HeatmapSessionRecording_ManageSessionRecordings")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_SessionRecordingsUsageBenefits")),1),Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",di,[Object(r["createVNode"])(s,{uicontrol:"select",name:"filterStatus","model-value":e.filterStatus,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.setFilterStatus(t)}),title:e.translate("HeatmapSessionRecording_Filter"),"full-width":!0,options:e.statusOptions},null,8,["model-value","title","options"])]),Object(r["createElementVNode"])("div",ui,[Object(r["withDirectives"])(Object(r["createVNode"])(s,{uicontrol:"text",name:"hsrSearch",title:e.translate("General_Search"),modelValue:e.searchFilter,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.searchFilter=t}),"full-width":!0},null,8,["title","modelValue"]),[[r["vShow"],e.hsrs.length>0]])])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",mi,Object(r["toDisplayString"])(e.translate("General_Id")),1),Object(r["createElementVNode"])("th",pi,Object(r["toDisplayString"])(e.translate("General_Name")),1),Object(r["createElementVNode"])("th",hi,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_CreationDate")),1),Object(r["createElementVNode"])("th",gi,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_SampleLimit")),1),Object(r["createElementVNode"])("th",fi,Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Status")),1),Object(r["createElementVNode"])("th",bi,Object(r["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(r["createElementVNode"])("tbody",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",vi,[Object(r["createElementVNode"])("span",yi,[Oi,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[r["vShow"],e.isLoading||e.isUpdating]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",ji,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_NoSessionRecordingsFound")),1)],512),[[r["vShow"],!e.isLoading&&0==e.hsrs.length]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedHsrs,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{id:"hsr".concat(t.idsitehsr),class:"hsrs",key:t.idsitehsr},[Object(r["createElementVNode"])("td",_i,Object(r["toDisplayString"])(t.idsitehsr),1),Object(r["createElementVNode"])("td",Hi,Object(r["toDisplayString"])(t.name),1),Object(r["createElementVNode"])("td",Vi,Object(r["toDisplayString"])(t.created_date_pretty),1),Object(r["createElementVNode"])("td",Ni,Object(r["toDisplayString"])(t.sample_limit),1),"paused"===t.status?(Object(r["openBlock"])(),Object(r["createElementBlock"])("td",Ei,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.ucfirst(t.status))+" ",1),Object(r["createElementVNode"])("span",{class:"icon icon-help",title:e.pauseReason},null,8,wi)])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("td",Ri,Object(r["toDisplayString"])(e.ucfirst(t.status)),1)),Object(r["createElementVNode"])("td",ki,[Object(r["createElementVNode"])("a",{class:"table-action icon-edit",title:e.translate("HeatmapSessionRecording_EditX",e.translate("HeatmapSessionRecording_SessionRecording")),onClick:function(a){return e.editHsr(t.idsitehsr)}},null,8,xi),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action stopRecording icon-drop-crossed",title:e.translate("HeatmapSessionRecording_StopX",e.translate("HeatmapSessionRecording_SessionRecording")),onClick:function(a){return e.completeHsr(t)}},null,8,Ci),[[r["vShow"],"ended"!==t.status]]),Object(r["createElementVNode"])("a",{class:"table-action icon-show",title:e.translate("HeatmapSessionRecording_ViewReport"),href:e.getViewReportLink(t),target:"_blank"},null,8,Di),Object(r["createElementVNode"])("a",{class:"table-action icon-delete",title:e.translate("HeatmapSessionRecording_DeleteX",e.translate("HeatmapSessionRecording_SessionRecording")),onClick:function(a){return e.deleteHsr(t)}},null,8,Pi)])],8,Si)})),128))])],512),[[c]]),Object(r["createElementVNode"])("div",Mi,[Object(r["createElementVNode"])("a",{class:"createNewHsr",value:"",onClick:t[2]||(t[2]=function(t){return e.createHsr()})},[Ti,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_CreateNewSessionRecording")),1)])])]})),_:1},8,["content-title"]),Object(r["createElementVNode"])("div",Ai,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_DeleteSessionRecordingConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Bi),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Ui)],512),Object(r["createElementVNode"])("div",Ii,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_EndSessionRecordingConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Fi),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Li)],512)])}function qi(e){return Ji(e)||$i(e)||Gi(e)||zi()}function zi(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Gi(e,t){if(e){if("string"===typeof e)return Xi(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Xi(e,t):void 0}}function $i(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ji(e){if(Array.isArray(e))return Xi(e)}function Xi(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Yi=Object(r["defineComponent"])({props:{pauseReason:String},components:{ContentBlock:U["ContentBlock"],Field:I["Field"]},directives:{ContentTable:U["ContentTable"]},data:function(){return{searchFilter:""}},created:function(){ja.setFilterStatus(""),ja.fetchHsrs()},methods:{createHsr:function(){this.editHsr(0)},editHsr:function(e){U["MatomoUrl"].updateHash(Object.assign(Object.assign({},U["MatomoUrl"].hashParsed.value),{},{idSiteHsr:e}))},deleteHsr:function(e){U["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteSessionRecording,{yes:function(){ja.deleteHsr(e.idsitehsr).then((function(){ja.reload(),U["Matomo"].postEvent("updateReportingMenu")}))}})},completeHsr:function(e){U["Matomo"].helper.modalConfirm(this.$refs.confirmEndSessionRecording,{yes:function(){ja.completeHsr(e.idsitehsr).then((function(){ja.reload()}))}})},setFilterStatus:function(e){ja.setFilterStatus(e)},ucfirst:function(e){return"".concat(e[0].toUpperCase()).concat(e.substr(1))},getViewReportLink:function(e){return"?".concat(U["MatomoUrl"].stringify({module:"CoreHome",action:"index",idSite:e.idsite,period:"day",date:"yesterday"}),"#?").concat(U["MatomoUrl"].stringify({category:"HeatmapSessionRecording_SessionRecordings",idSite:e.idsite,period:"day",date:"yesterday",subcategory:e.idsitehsr}))}},computed:{filterStatus:function(){return ja.state.value.filterStatus},statusOptions:function(){return ja.statusOptions},hsrs:function(){return ja.hsrs.value},isLoading:function(){return ja.state.value.isLoading},isUpdating:function(){return ja.state.value.isUpdating},sortedHsrs:function(){var e=this,t=qi(this.hsrs).filter((function(t){return Object.keys(t).some((function(a){var n=t;return"string"===typeof n[a]&&-1!==n[a].indexOf(e.searchFilter)}))}));return t.sort((function(e,t){return t.idsitehsr-e.idsitehsr})),t}}});Yi.render=Wi;var Ki=Yi,Qi={class:"manageHsr"};function Zi(e,t,a,n,i,o){var s=Object(r["resolveComponent"])("MatomoJsNotWritableAlert"),l=Object(r["resolveComponent"])("SessionRecordingList"),c=Object(r["resolveComponent"])("SessionRecordingEdit");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[e.editMode?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])(s,{key:0,"is-matomo-js-writable":e.isMatomoJsWritable,"recording-type":e.translate("HeatmapSessionRecording_SessionRecordings")},null,8,["is-matomo-js-writable","recording-type"])),Object(r["createElementVNode"])("div",Qi,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{"pause-reason":e.pauseReason},null,8,["pause-reason"])],512),[[r["vShow"],!e.editMode]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{"id-site-hsr":e.idSiteHsr},null,8,["id-site-hsr"])],512),[[r["vShow"],e.editMode]])])],64)}var er=Object(r["defineComponent"])({props:{pauseReason:String,isMatomoJsWritable:{type:Boolean,required:!0}},data:function(){return{editMode:!1,idSiteHsr:null}},components:{MatomoJsNotWritableAlert:wn,SessionRecordingEdit:li,SessionRecordingList:Ki},created:function(){var e=this;Object(r["watch"])((function(){return U["MatomoUrl"].hashParsed.value.idSiteHsr}),(function(t){e.initState(t)})),this.initState(U["MatomoUrl"].hashParsed.value.idSiteHsr)},methods:{removeAnyHsrNotification:function(){U["NotificationsStore"].remove("hsrmanagement")},initState:function(e){if(e){if("0"===e){var t={isAllowed:!0};if(U["Matomo"].postEvent("HeatmapSessionRecording.initAddSessionRecording",t),t&&!t.isAllowed)return this.editMode=!1,void(this.idSiteHsr=null)}this.editMode=!0,this.idSiteHsr=parseInt(e,10)}else this.editMode=!1,this.idSiteHsr=null;this.removeAnyHsrNotification()}}});er.render=Zi;var tr=er,ar={class:"ui-confirm",id:"listOfPageviews"},nr=Object(r["createElementVNode"])("br",null,null,-1),ir=Object(r["createElementVNode"])("br",null,null,-1),rr=["onClick"],or=["title"],sr=["value"];function lr(e,t,a,n,i,o){var s=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ar,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_PageviewsInVisit")),1),nr,ir,Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ColumnTime")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("General_TimeOnPage")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("Goals_URL")),1)])]),Object(r["createElementVNode"])("tbody",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.pageviews,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:t.idloghsr,class:Object(r["normalizeClass"])({inactive:t.idloghsr!==e.idLogHsr}),onClick:function(a){return e.onClickPageView(t)}},[Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.server_time_pretty),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.time_on_page_pretty),1),Object(r["createElementVNode"])("td",{title:t.label},Object(r["toDisplayString"])((t.label||"").substr(0,50)),9,or)],10,rr)})),128))])],512),[[s]]),Object(r["createElementVNode"])("input",{role:"close",type:"button",value:e.translate("General_Close")},null,8,sr)])}var cr=Object(r["defineComponent"])({props:{pageviews:{type:Array,required:!0},idLogHsr:{type:Number,required:!0}},directives:{ContentTable:U["ContentTable"]},methods:{onClickPageView:function(e){e.idloghsr!==this.idLogHsr&&U["MatomoUrl"].updateUrl(Object.assign(Object.assign({},U["MatomoUrl"].urlParsed.value),{},{idLogHsr:e.idloghsr}),U["MatomoUrl"].hashParsed.value.length?Object.assign(Object.assign({},U["MatomoUrl"].hashParsed.value),{},{idLogHsr:e.idloghsr}):void 0)}}});cr.render=lr;var dr=cr,ur={class:"heatmap-vis-title"},mr={key:0,class:"alert alert-info heatmap-country-alert"},pr={key:1},hr={key:2},gr={class:"alert alert-info"},fr={key:3},br={class:"alert alert-info"};function vr(e,t,a,n,i,o){var s,l=Object(r["resolveComponent"])("EnrichedHeadline"),c=Object(r["resolveComponent"])("MatomoJsNotWritableAlert"),d=Object(r["resolveComponent"])("HeatmapVis"),u=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createElementVNode"])("h2",ur,[Object(r["createVNode"])(l,{"edit-url":e.editUrl,"inline-help":e.inlineHelp},{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_HeatmapX",'"'.concat(e.heatmap.name,'"'))),1)]})),_:1},8,["edit-url","inline-help"])]),Object(r["createVNode"])(c,{"is-matomo-js-writable":e.isMatomoJsWritable,"recording-type":e.translate("HeatmapSessionRecording_Heatmaps")},null,8,["is-matomo-js-writable","recording-type"]),e.includedCountries?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",mr,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_HeatmapInfoTrackVisitsFromCountries",e.includedCountries)),1)):Object(r["createCommentVNode"])("",!0),e.heatmap.page_treemirror?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",pr,[Object(r["createVNode"])(d,{"created-date":e.createdDate,"excluded-elements":e.heatmap.excluded_elements,"num-samples":e.heatmapMetadata,url:e.heatmap.screenshot_url,"heatmap-date":e.heatmapDate,"heatmap-period":e.heatmapPeriod,"offset-accuracy":e.offsetAccuracy,"breakpoint-tablet":e.heatmap.breakpoint_tablet,"breakpoint-mobile":e.heatmap.breakpoint_mobile,"heatmap-types":e.heatmapTypes,"device-types":e.deviceTypes,"id-site-hsr":e.idSiteHsr,"is-active":e.isActive,"desktop-preview-size":e.desktopPreviewSize,"iframe-resolutions-values":e.iframeResolutions},null,8,["created-date","excluded-elements","num-samples","url","heatmap-date","heatmap-period","offset-accuracy","breakpoint-tablet","breakpoint-mobile","heatmap-types","device-types","id-site-hsr","is-active","desktop-preview-size","iframe-resolutions-values"])])):null!==(s=e.heatmapMetadata)&&void 0!==s&&s.nb_samples_device_all?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",fr,[Object(r["createVNode"])(u,null,{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",br,Object(r["toDisplayString"])(e.noHeatmapScreenshotRecordedYetText),1)]})),_:1})])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",hr,[Object(r["createVNode"])(u,null,{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",gr,Object(r["toDisplayString"])(e.translate(e.noDataMessageKey)),1)]})),_:1})]))])}var yr=Object(r["defineComponent"])({props:{idSiteHsr:{type:Number,required:!0},heatmap:{type:Object,required:!0},heatmapMetadata:{type:Object,required:!0},deviceTypes:{type:Array,required:!0},heatmapTypes:{type:Array,required:!0},offsetAccuracy:{type:Number,required:!0},heatmapPeriod:{type:String,required:!0},heatmapDate:{type:String,required:!0},isActive:Boolean,createdDate:{type:String,required:!0},editUrl:{type:String,required:!0},inlineHelp:{type:String,required:!0},includedCountries:{type:String,required:!0},desktopPreviewSize:{type:Number,required:!0},iframeResolutions:{type:Object,required:!0},noDataMessageKey:{type:String,required:!0},isMatomoJsWritable:{type:Boolean,required:!0}},components:{MatomoJsNotWritableAlert:wn,ContentBlock:U["ContentBlock"],HeatmapVis:le,EnrichedHeadline:U["EnrichedHeadline"]},computed:{noHeatmapScreenshotRecordedYetText:function(){return Object(U["translate"])("HeatmapSessionRecording_NoHeatmapScreenshotRecordedYet",this.heatmapMetadata.nb_samples_device_all,Object(U["translate"])("HeatmapSessionRecording_ScreenshotUrl"))}},created:function(){U["Matomo"].postEvent("hidePeriodSelector")}});yr.render=vr;var Or=yr;
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */}})}));
//# sourceMappingURL=HeatmapSessionRecording.umd.min.js.map